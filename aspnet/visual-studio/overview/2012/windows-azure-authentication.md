---
uid: visual-studio/overview/2012/windows-azure-authentication
title: Windows autenticação do Azure | Microsoft Docs
author: Rick-Anderson
description: Ferramentas do Microsoft ASP.NET para o Windows Azure Active Directory torna simples para habilitar a autenticação para aplicativos web hospedados no Windows Azure Web Sites...
ms.author: riande
ms.date: 02/20/2013
ms.assetid: a3cef801-a54b-4ebd-93c3-55764e2e14b1
msc.legacyurl: /visual-studio/overview/2012/windows-azure-authentication
msc.type: authoredcontent
ms.openlocfilehash: a45b0ad2b61c2b78f7f06e85fe5e92193d73041d
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57052703"
---
<a name="windows-azure-authentication"></a><span data-ttu-id="80c32-103">Autenticação do Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="80c32-103">Windows Azure Authentication</span></span>
====================
<span data-ttu-id="80c32-104">por [Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="80c32-104">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

> <span data-ttu-id="80c32-105">Ferramentas do Microsoft ASP.NET para Windows Azure Active Directory torna simples para habilitar a autenticação para aplicativos web hospedados no [Windows Azure Web Sites](https://www.windowsazure.com/home/features/web-sites/).</span><span class="sxs-lookup"><span data-stu-id="80c32-105">Microsoft ASP.NET tools for Windows Azure Active Directory makes it simple to enable authentication for web applications hosted on [Windows Azure Web Sites](https://www.windowsazure.com/home/features/web-sites/).</span></span> <span data-ttu-id="80c32-106">Você pode usar a autenticação do Windows Azure para autenticar usuários do Office 365 da sua organização, sincronizadas do Active Directory no local de contas corporativas ou os usuários criados no seu próprio domínio personalizado do Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="80c32-106">You can use Windows Azure Authentication to authenticate Office 365 users from your organization, corporate accounts synced from your on-premise Active Directory or users created in your own custom Windows Azure Active Directory domain.</span></span> <span data-ttu-id="80c32-107">Habilitar a autenticação do Windows Azure configura seu aplicativo para autenticar usuários usando uma única [Active Directory do Windows Azure](https://docs.microsoft.com/azure/active-directory/) locatário.</span><span class="sxs-lookup"><span data-stu-id="80c32-107">Enabling Windows Azure Authentication configures your application to authenticate users using a single [Windows Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) tenant.</span></span>
> 
> <span data-ttu-id="80c32-108">Não há suporte para a ferramenta de autenticação do Windows Azure do ASP.NET para funções web em um serviço de nuvem, mas planejamos fazê-lo em uma versão futura.</span><span class="sxs-lookup"><span data-stu-id="80c32-108">The ASP.NET Windows Azure Authentication tool is not supported for web roles in a cloud service but we plan to do so in a future release.</span></span> <span data-ttu-id="80c32-109">[Windows Identity Foundation](https://msdn.microsoft.com/library/hh291066(v=VS.110).aspx) (WIF) é compatível com funções da web do Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="80c32-109">[Windows Identity Foundation](https://msdn.microsoft.com/library/hh291066(v=VS.110).aspx) (WIF) is supported in Windows Azure web roles.</span></span>
> 
> <span data-ttu-id="80c32-110">Para obter detalhes sobre como configurar a sincronização entre o Active Directory local e seu locatário do Active Directory do Windows Azure, consulte [usar o AD FS 2.0 para implementar e gerenciar logon único](https://technet.microsoft.com/library/jj205462.aspx).</span><span class="sxs-lookup"><span data-stu-id="80c32-110">For details on how to setup synchronization between your on-premise Active Directory and your Windows Azure Active Directory tenant please see [Use AD FS 2.0 to implement and manage single sign-on](https://technet.microsoft.com/library/jj205462.aspx).</span></span>
> 
> <span data-ttu-id="80c32-111">Windows Azure Active Directory está disponível como um [livre de serviço de visualização](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span><span class="sxs-lookup"><span data-stu-id="80c32-111">Windows Azure Active Directory is currently available as a [free preview service](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span></span>


## <a name="requirements"></a><span data-ttu-id="80c32-112">Requisitos:</span><span class="sxs-lookup"><span data-stu-id="80c32-112">Requirements:</span></span>

- <span data-ttu-id="80c32-113">Visual Studio 2012 ou [Visual Studio Express 2012](https://www.microsoft.com/visualstudio/11/products/express)</span><span class="sxs-lookup"><span data-stu-id="80c32-113">Visual Studio 2012 or [Visual Studio Express 2012](https://www.microsoft.com/visualstudio/11/products/express)</span></span>
- <span data-ttu-id="80c32-114">[Extensões para Visual Studio 2012 de ferramentas da Web](https://go.microsoft.com/fwlink/?LinkID=282228&amp;clcid=0x409) ou [extensões de ferramentas da Web do Visual Studio Express 2012](https://go.microsoft.com/fwlink/?LinkID=282231&amp;clcid=0x409)</span><span class="sxs-lookup"><span data-stu-id="80c32-114">[Web Tools Extensions for Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282228&amp;clcid=0x409) or [Web Tools Extensions for Visual Studio Express 2012](https://go.microsoft.com/fwlink/?LinkID=282231&amp;clcid=0x409)</span></span>
- <span data-ttu-id="80c32-115">[Ferramentas do Microsoft ASP.NET para o Windows Active Directory do Azure – Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282306) ou [ferramentas do Microsoft ASP.NET para o Windows Azure Active Directory – Visual Studio Express 2012 para Web](https://go.microsoft.com/fwlink/?LinkId=282652)</span><span class="sxs-lookup"><span data-stu-id="80c32-115">[Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282306) or [Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio Express 2012 for Web](https://go.microsoft.com/fwlink/?LinkId=282652)</span></span>

## <a name="create-an-aspnet-web-application-with-visual-studio-2012"></a><span data-ttu-id="80c32-116">Criar um aplicativo Web ASP.NET com o Visual Studio 2012</span><span class="sxs-lookup"><span data-stu-id="80c32-116">Create an ASP.NET Web Application with Visual Studio 2012</span></span>

<span data-ttu-id="80c32-117">Você pode criar qualquer aplicativo da Web com o Visual Studio 2012, este tutorial usa o modelo de intranet do ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="80c32-117">You can create any Web Application with Visual Studio 2012, this tutorial uses the ASP.NET MVC intranet template.</span></span>

1. <span data-ttu-id="80c32-118">Crie um novo aplicativo ASP.NET MVC 4 Intranet e aceitar todos os padrões.</span><span class="sxs-lookup"><span data-stu-id="80c32-118">Create a new ASP.NET MVC 4 Intranet Application and accept all the defaults.</span></span> <span data-ttu-id="80c32-119">(Ele deve ser um **tra** net e não no **MOS** projeto net).</span><span class="sxs-lookup"><span data-stu-id="80c32-119">(It must be an In **tra** net and not In **ter** net project).</span></span>  
     ![](windows-azure-authentication/_static/image1.png)

## <a name="enable-window-azure-authentication-when-you-are-a-global-administrator-of-the-tenet"></a><span data-ttu-id="80c32-120">Habilitar a autenticação do Windows Azure (quando você for um Administrador Global da filosofia)</span><span class="sxs-lookup"><span data-stu-id="80c32-120">Enable Window Azure Authentication (When you are a Global Administrator of the Tenet)</span></span>

<span data-ttu-id="80c32-121">Se você não tiver um locatário existente do Windows Azure Active Directory (por exemplo, por meio de uma conta existente do Office 365) você pode criar um novo locatário inscrevendo-se para uma [nova conta do Windows Azure Active Directory](http://g.microsoftonline.com/0AX00en/5).</span><span class="sxs-lookup"><span data-stu-id="80c32-121">If you do not have an existing Windows Azure Active Directory tenant (For example, through an existing Office 365 account) you can create a new tenant by signing up for a [new Windows Azure Active Directory account](http://g.microsoftonline.com/0AX00en/5).</span></span>

1. <span data-ttu-id="80c32-122">No menu projeto, selecione **habilitar a autenticação do Windows Azure**:</span><span class="sxs-lookup"><span data-stu-id="80c32-122">From the Project menu select **Enable Windows Azure Authentication**:</span></span>  
  
   ![](windows-azure-authentication/_static/image2.png)

2. <span data-ttu-id="80c32-123">Digite o domínio para seu locatário do Active Directory do Windows Azure (por exemplo, contoso.onmicrosoft.com) e clique em **habilitar**:</span><span class="sxs-lookup"><span data-stu-id="80c32-123">Enter the domain for your Windows Azure Active Directory tenant (for example, contoso.onmicrosoft.com) and click **Enable**:</span></span>

![](windows-azure-authentication/_static/image3.png)

3. <span data-ttu-id="80c32-124">Na autenticação da Web caixa de diálogo de entrada como um administrador para seu locatário do Active Directory do Windows Azure:</span><span class="sxs-lookup"><span data-stu-id="80c32-124">In the Web Authentication dialog sign in as an administrator for your Windows Azure Active Directory tenant:</span></span>  
  
   ![](windows-azure-authentication/_static/image4.png)

![](windows-azure-authentication/_static/image5.png)

## <a name="enable-window-azure-by-a-non-administrator-of-the-tenet"></a><span data-ttu-id="80c32-125">Habilitar o Azure de janela por um não-administrador do princípio</span><span class="sxs-lookup"><span data-stu-id="80c32-125">Enable Window Azure by a non-administrator of the Tenet</span></span>

<span data-ttu-id="80c32-126">Se você não tiver privilégios de Administrador Global para seu locatário do Active Directory do Windows Azure, você pode desmarcar a caixa de seleção para o provisionamento de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="80c32-126">If you do not have Global Administrator privilege for your Windows Azure Active Directory tenant, you can uncheck the checkbox for provisioning the application.</span></span>

![](windows-azure-authentication/_static/image6.png)

<span data-ttu-id="80c32-127">A caixa de diálogo exibirá o **domínio**, **Id da entidade de aplicativo** e **URL de resposta** que são necessários para o provisionamento de aplicativo com um Azure Active Directory princípio.</span><span class="sxs-lookup"><span data-stu-id="80c32-127">The dialog will display the **Domain**, **Application Principal Id** and **Reply URL** which are required for provisioning the application with an Azure Active Directory tenet.</span></span> <span data-ttu-id="80c32-128">Você precisa fornecer essas informações para alguém que tem privilégios suficientes para provisionar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="80c32-128">You need to give this information to someone who has sufficient privilege to provision the application.</span></span> <span data-ttu-id="80c32-129">Ver[como implementar o logon único com o Azure Active Directory do Windows - aplicativo ASP.NET](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect) para obter detalhes sobre como usar o cmdlet para criar a entidade de serviço manualmente.</span><span class="sxs-lookup"><span data-stu-id="80c32-129">See[How to implement single sign-on with Windows Azure Active Directory - ASP.NET Application](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect) for details on how to use cmdlet to create the service principal manually.</span></span>  
<span data-ttu-id="80c32-130">Depois que o aplicativo foi configurado com êxito, você pode clicar em **continuar Atualizar Web. config com as configurações selecionadas**.</span><span class="sxs-lookup"><span data-stu-id="80c32-130">Once the application has been successfully provisioned, you can click on **Continue to update web.config with the selected settings**.</span></span> <span data-ttu-id="80c32-131">Se você quiser continuar a desenvolver o aplicativo enquanto aguarda para provisionamento acontecer, você pode clicar em **Fechar para memorizar as configurações no arquivo de projeto**.</span><span class="sxs-lookup"><span data-stu-id="80c32-131">If you want to continue developing the application while waiting for provisioning to happen, you can click **Close to remember the settings in project file**.</span></span> <span data-ttu-id="80c32-132">Na próxima vez que você invocar a habilitar a autenticação do Windows Azure e desmarque a caixa de seleção de provisionamento, você verá as mesmas configurações e você pode clicar em **Continue**, em seguida, clique em **aplicar essas configurações no Web. config**.</span><span class="sxs-lookup"><span data-stu-id="80c32-132">The next time you invoke Enable Windows Azure Authentication and uncheck the provisioning checkbox, you will see the same settings and you can click **Continue**, then click, **Apply these settings in web.config**.</span></span>

1. <span data-ttu-id="80c32-133">Aguarde enquanto seu aplicativo é configurado para autenticação do Windows Azure e provisionado com o Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="80c32-133">Wait while your application is configured for Windows Azure Authentication and provisioned with Windows Azure Active Directory.</span></span>
2. <span data-ttu-id="80c32-134">Depois que a autenticação do Windows Azure tiver sido habilitada para seu aplicativo, clique em **fechar:**</span><span class="sxs-lookup"><span data-stu-id="80c32-134">Once Windows Azure Authentication has been enabled for your application, click **Close:**</span></span> 

    ![](windows-azure-authentication/_static/image7.png)
3. <span data-ttu-id="80c32-135">Pressione F5 para executar seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="80c32-135">Hit F5 to run your application.</span></span> <span data-ttu-id="80c32-136">Você deve obter redirecionado automaticamente para a página de logon.</span><span class="sxs-lookup"><span data-stu-id="80c32-136">You should automatically get redirected to login page.</span></span> <span data-ttu-id="80c32-137">Usar as credenciais de usuário do princípio de diretório para fazer logon no aplicativo...</span><span class="sxs-lookup"><span data-stu-id="80c32-137">Use the directory tenet user credentials to login to the application..</span></span>  

    ![](windows-azure-authentication/_static/image1.jpg)
4. <span data-ttu-id="80c32-138">Porque seu aplicativo está usando um certificado de teste autoassinado, você receberá um aviso do navegador que o certificado não foi emitido por uma autoridade de certificação confiável.</span><span class="sxs-lookup"><span data-stu-id="80c32-138">Because your application is currently using a self-signed test certificate you will receive a warning from the browser that the certificate was not issued by a trusted certificate authority.</span></span>

    <span data-ttu-id="80c32-139">Esse aviso pode ser ignorado durante o desenvolvimento local, clicando em **continuar neste site:**</span><span class="sxs-lookup"><span data-stu-id="80c32-139">This warning can be safely ignored during local development by clicking **Continue to this website:**</span></span> 

    ![](windows-azure-authentication/_static/image8.png)
5. <span data-ttu-id="80c32-140">Você agora fizeram logon com êxito seu aplicativo usando a autenticação do Windows Azure!</span><span class="sxs-lookup"><span data-stu-id="80c32-140">You have now successfully logged in to your application using Windows Azure Authentication!</span></span>

    ![](windows-azure-authentication/_static/image2.jpg)

<span data-ttu-id="80c32-141">Autenticação de habilitação do Windows Azure faz as seguintes alterações ao seu aplicativo:</span><span class="sxs-lookup"><span data-stu-id="80c32-141">Enabling Windows Azure authentication makes the following changes to your application:</span></span>

- <span data-ttu-id="80c32-142">Uma falsificação de solicitação de anti-script entre sites ([CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))) classe ( *App\_Start\AntiXsrfConfig.cs* ) é adicionado ao seu projeto.</span><span class="sxs-lookup"><span data-stu-id="80c32-142">An Anti-Cross-Site Request Forgery ([CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))) class ( *App\_Start\AntiXsrfConfig.cs* ) is added to your project.</span></span>
- <span data-ttu-id="80c32-143">Os pacotes do NuGet `System.IdentityModel.Tokens.ValidatingIssuerNameRegistry` é adicionado ao seu projeto.</span><span class="sxs-lookup"><span data-stu-id="80c32-143">The NuGet packages `System.IdentityModel.Tokens.ValidatingIssuerNameRegistry` is added to your project.</span></span>
- <span data-ttu-id="80c32-144">Configurações do Windows Identity Foundation em seu aplicativo serão configuradas para aceitar tokens de segurança de seu locatário do Active Directory do Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="80c32-144">Windows Identity Foundation settings in your application will be configured to accept security tokens from your Windows Azure Active Directory tenant.</span></span> <span data-ttu-id="80c32-145">Clique na imagem abaixo para ver uma exibição expandida das alterações feitas para o *Web. config* arquivo.</span><span class="sxs-lookup"><span data-stu-id="80c32-145">Click on the image below to see an expanded view of the changes made to the *Web.config* file.</span></span>  
  
     ![](windows-azure-authentication/_static/image9.png)
- <span data-ttu-id="80c32-146">Uma entidade de serviço para seu aplicativo em seu locatário do Active Directory do Windows Azure será provisionado.</span><span class="sxs-lookup"><span data-stu-id="80c32-146">A service principal for your application in your Windows Azure Active Directory tenant will be provisioned.</span></span>
- <span data-ttu-id="80c32-147">O HTTPS será habilitado.</span><span class="sxs-lookup"><span data-stu-id="80c32-147">HTTPS is enabled.</span></span>

## <a name="deploy-the-application-to-windows-azure"></a><span data-ttu-id="80c32-148">Implantar o aplicativo no Windows Azure</span><span class="sxs-lookup"><span data-stu-id="80c32-148">Deploy the application to Windows Azure</span></span>

<span data-ttu-id="80c32-149">Para obter instruções completas, consulte [Implantando um aplicativo Web do ASP.NET a um Site do Windows Azure](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span><span class="sxs-lookup"><span data-stu-id="80c32-149">For complete instructions, see [Deploying an ASP.NET Web Application to a Windows Azure Web Site](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span></span>

<span data-ttu-id="80c32-150">Para publicar um aplicativo usando a autenticação do Windows Azure em um Site do Azure:</span><span class="sxs-lookup"><span data-stu-id="80c32-150">To publish an application using Windows Azure Authentication to an Azure Web Site:</span></span>

1. <span data-ttu-id="80c32-151">Clique com o botão direito em seu aplicativo e selecione **publicar:**</span><span class="sxs-lookup"><span data-stu-id="80c32-151">Right click on your application and select **Publish:**</span></span> 

    ![](windows-azure-authentication/_static/image3.jpg)
2. <span data-ttu-id="80c32-152">Na caixa de diálogo Publicar na Web, baixar e importar um perfil de publicação para seu Site da Web do Azure.</span><span class="sxs-lookup"><span data-stu-id="80c32-152">From the Publish Web dialog download and import a publishing profile for your Azure Web Site.</span></span>

    ![](windows-azure-authentication/_static/image4.jpg)
3. <span data-ttu-id="80c32-153">O **Conexão** guia mostra os **URL de destino** (a voltado para a URL pública para o seu aplicativo).</span><span class="sxs-lookup"><span data-stu-id="80c32-153">The **Connection** tab shows the **Destination URL** (the public facing URL for your application).</span></span> <span data-ttu-id="80c32-154">Clique em **validar Conexão** para testar sua conexão:</span><span class="sxs-lookup"><span data-stu-id="80c32-154">Click **Validate Connection** to test your connection:</span></span>

    ![](windows-azure-authentication/_static/image5.jpg)
4. <span data-ttu-id="80c32-155">Se você publicou para este Site da Web do Azure anteriormente considere verificar a **remover arquivos adicionais no destino** publica de configuração para garantir que seu aplicativo corretamente.</span><span class="sxs-lookup"><span data-stu-id="80c32-155">If you have published to this Azure Web Site previously consider checking the **Remove additional files at destination** setting to ensure your application publishes cleanly.</span></span> <span data-ttu-id="80c32-156">Observe que o **habilitar a autenticação do Windows Azure** caixa de seleção é slected.</span><span class="sxs-lookup"><span data-stu-id="80c32-156">Notice the **Enable Windows Azure Authentication** check box is slected.</span></span>  

    ![](windows-azure-authentication/_static/image10.png)
5. <span data-ttu-id="80c32-157">Opcional: Sobre o **versão prévia** guia, clique em **iniciar visualização** para ver os arquivos sejam implantados.</span><span class="sxs-lookup"><span data-stu-id="80c32-157">Optional: On the **Preview** tab click **Start Preview** to see the files deployed.</span></span>

    ![](windows-azure-authentication/_static/image6.jpg)
6. <span data-ttu-id="80c32-158">Clique em **publicar.**</span><span class="sxs-lookup"><span data-stu-id="80c32-158">Click **Publish.**</span></span>

    <span data-ttu-id="80c32-159">Você será solicitado a habilitar a autenticação do Windows Azure para o host de destino.</span><span class="sxs-lookup"><span data-stu-id="80c32-159">You will be prompted to enable Windows Azure Authentication for the target host.</span></span> <span data-ttu-id="80c32-160">Clique em **habilitar** para continuar:</span><span class="sxs-lookup"><span data-stu-id="80c32-160">Click **Enable** to continue:</span></span>

    ![](windows-azure-authentication/_static/image11.png)
7. <span data-ttu-id="80c32-161">Insira suas credenciais de administrador para seu locatário do Active Directory do Windows Azure:</span><span class="sxs-lookup"><span data-stu-id="80c32-161">Enter your administrator credentials for your Windows Azure Active Directory tenant:</span></span>

    ![](windows-azure-authentication/_static/image7.jpg)
8. <span data-ttu-id="80c32-162">Depois que seu aplicativo tiver sido publicado com êxito, um navegador abrirá o site publicado.</span><span class="sxs-lookup"><span data-stu-id="80c32-162">Once your application has been successfully published, a browser will open to the published web site.</span></span>

    > [!NOTE]
    > <span data-ttu-id="80c32-163">Ele pode levar até cinco minutos (normalmente deve menor) para o seu aplicativo seja totalmente provisionada com o Windows Azure Active Directory depois de habilitar a autenticação do Windows Azure para o host de destino.</span><span class="sxs-lookup"><span data-stu-id="80c32-163">It may take up to five minutes (typically must less) for your application to be fully provisioned with Windows Azure Active Directory after enabling Windows Azure Authentication for the target host.</span></span> <span data-ttu-id="80c32-164">Quando pela primeira vez você executa seu aplicativo se você receber o erro ACS50001: Terceira parte confiável com o nome '[Território]' não foi encontrado, em seguida, aguarde alguns minutos e tente executar o aplicativo novamente.</span><span class="sxs-lookup"><span data-stu-id="80c32-164">When you first run your application if you receive error ACS50001: Relying party with name ‘[realm]' was not found, then wait a few minutes and try running the application again.</span></span>
9. <span data-ttu-id="80c32-165">Quando solicitado, faça logon como um usuário em seu diretório:</span><span class="sxs-lookup"><span data-stu-id="80c32-165">When prompted, log in as a user in your directory:</span></span>

    ![](windows-azure-authentication/_static/image8.jpg)
10. <span data-ttu-id="80c32-166">Agora fazer logon com êxito no Azure usando a autenticação do Windows Azure do aplicativo hospedado.</span><span class="sxs-lookup"><span data-stu-id="80c32-166">You have now successfully logged into your Azure hosted application using Windows Azure Authentication.</span></span>  
  
     ![](windows-azure-authentication/_static/image9.jpg)

## <a name="known-issues"></a><span data-ttu-id="80c32-167">Problemas Conhecidos</span><span class="sxs-lookup"><span data-stu-id="80c32-167">Known Issues</span></span>

#### <a name="role-based-authorization-fails-when-using-windows-azure-authenticationopop"></a><span data-ttu-id="80c32-168">Autorização baseada em função falhar ao usar a autenticação do Windows Azure < o:p >< / o:p ></span><span class="sxs-lookup"><span data-stu-id="80c32-168">Role-based authorization fails when using Windows Azure Authentication<o:p></o:p></span></span>

<span data-ttu-id="80c32-169">Autenticação do Windows Azure atualmente não fornece a declaração de função necessários para que a autorização baseada em função pode ser executada.</span><span class="sxs-lookup"><span data-stu-id="80c32-169">Windows Azure Authentication does not currently provide the necessary role claim so that role-based authorization can be performed.</span></span> <span data-ttu-id="80c32-170">A função do usuário autenticado deve ser recuperada do Active Directory do Windows Azure. < o:p >< / o:p ></span><span class="sxs-lookup"><span data-stu-id="80c32-170">The role of the authenticated user must be manually retrieved from Windows Azure Active Directory.<o:p></o:p></span></span>

#### <a name="browsing-to-an-application-with-windows-azure-authentication-results-in-the-error-acs20016-the-domain-of-the-logged-in-user-livecom-does-not-match-any-allowed-domain-of-this-stsopop"></a><span data-ttu-id="80c32-171">Navegando para um aplicativo com autenticação do Windows Azure resulta no erro "ACS20016 o domínio do usuário conectado (live.com) não corresponde a nenhum permitidos domínio desse STS" < o:p >< / o:p ></span><span class="sxs-lookup"><span data-stu-id="80c32-171">Browsing to an application with Windows Azure Authentication results in the error "ACS20016 The domain of the logged in user (live.com) does not match any allowed domain of this STS"<o:p></o:p></span></span>

<span data-ttu-id="80c32-172">Se você já estiver conectado a uma Account da Microsoft (por exemplo, hotmail.com, live.com, outlook.com) e você tentar acessar um aplicativo que tenha habilitado a autenticação do Windows Azure você pode receber uma resposta de 400 erro porque o domínio da sua Account da Microsoft não é reconhecida pelo Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="80c32-172">If you are already logged in to a Microsoft Account (for example hotmail.com, live.com, outlook.com) and you attempt to access an application that has enabled Windows Azure Authentication you may get a 400 error response because the domain of your Microsoft Account is not recognized by Windows Azure Active Directory.</span></span> <span data-ttu-id="80c32-173">Para fazer logon no aplicativo, faça logoff do seu Account da Microsoft pela primeira vez. < o:p >< / o:p ></span><span class="sxs-lookup"><span data-stu-id="80c32-173">To log into the application, log out from your Microsoft Account first.<o:p></o:p></span></span>

#### <a name="logging-into-an-application-with-windows-azure-authentication-enabled-and-a-x509certificatevalidationmode-other-than-none-results-in-certificate-validation-errors-for-the-accountsaccesscontrolwindowsnet-certificateopop"></a><span data-ttu-id="80c32-174">Registro em log em um aplicativo com a autenticação do Windows Azure habilitado e um X509CertificateValidationMode diferente de None resulta em erros de validação de certificado para o certificado accounts.accesscontrol.windows.net < o:p >< / o:p ></span><span class="sxs-lookup"><span data-stu-id="80c32-174">Logging into an application with Windows Azure Authentication enabled and a X509CertificateValidationMode other than None results in certificate validation errors for the accounts.accesscontrol.windows.net certificate<o:p></o:p></span></span>

<span data-ttu-id="80c32-175">Validação de certificado não é necessária e deve ser deixada desabilitada.</span><span class="sxs-lookup"><span data-stu-id="80c32-175">Certificate validation is not required and should be left disabled.</span></span> <span data-ttu-id="80c32-176">A impressão digital do certificado do emissor é validada pelo WSFederationAuthenticationModule. < o:p >< / o:p ></span><span class="sxs-lookup"><span data-stu-id="80c32-176">The thumbprint of the issuer certificate is validated by the WSFederationAuthenticationModule.<o:p></o:p></span></span>

#### <a name="when-attempting-to-enable-windows-azure-authentication-the-web-authentication-dialog-shows-the-error-acs20016-the-domain-of-the-logged-in-user-contosoonmicrosoftcom-does-not-match-any-allowed-domain-of-this-stsopop"></a><span data-ttu-id="80c32-177">Ao tentar habilitar a autenticação do Windows Azure a caixa de diálogo de autenticação da Web mostra o erro "ACS20016: O domínio do usuário conectado (contoso.onmicrosoft.com) não corresponde a nenhum domínio permitido desse STS." < o:p >< / o:p ></span><span class="sxs-lookup"><span data-stu-id="80c32-177">When attempting to enable Windows Azure Authentication the Web Authentication dialog shows the error "ACS20016: The domain of the logged in user (contoso.onmicrosoft.com) does not match any allowed domain of this STS."<o:p></o:p></span></span>

<span data-ttu-id="80c32-178">Você poderá ver esse erro quando você anteriormente fizeram logon com êxito usando uma conta diferente do Active Directory do Windows Azure de dentro do mesmo processo do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="80c32-178">You may see this error when you have previously successfully logged in using a different Windows Azure Active Directory account from within the same Visual Studio process.</span></span> <span data-ttu-id="80c32-179">Faça logoff da conta especificada ou reinicie o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="80c32-179">Log out from the specified account or restart Visual Studio.</span></span> <span data-ttu-id="80c32-180">Se anteriormente você conectado e selecionado a opção "Manter-me conectado", talvez você precise limpar seus cookies do navegador. < o:p >< / o:p ></span><span class="sxs-lookup"><span data-stu-id="80c32-180">If you previously logged in and selected the option to "Keep me signed in" then you may need to clear your browser cookies.<o:p></o:p></span></span>

## <a name="acs20012-the-request-is-not-a-valid-ws-federation-protocol-message-opop"></a><span data-ttu-id="80c32-181">ACS20012: A solicitação não é uma mensagem de protocolo do WS-Federation válida < o:p >< / o:p ></span><span class="sxs-lookup"><span data-stu-id="80c32-181">ACS20012: The request is not a valid WS-Federation protocol message <o:p></o:p></span></span>

<span data-ttu-id="80c32-182">Isso pode acontecer se você já estiver conectado com alguns outros ID da Microsoft para um dos serviços do Azure.</span><span class="sxs-lookup"><span data-stu-id="80c32-182">This can happen if you are already logged in with some other Microsoft ID to one of the Azure services.</span></span> <span data-ttu-id="80c32-183">Janela do navegador privada de uso como InPrivate no Internet Explorer ou anônimo no Chrome ou limpar todos os cookies.</span><span class="sxs-lookup"><span data-stu-id="80c32-183">Use Private browser window like InPrivate in IE or Incognito in Chrome or clear all the cookies.</span></span> <span data-ttu-id="80c32-184"><o:p></o:p></span><span class="sxs-lookup"><span data-stu-id="80c32-184"><o:p></o:p></span></span>

## <a name="additional-resources"></a><span data-ttu-id="80c32-185">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="80c32-185">Additional Resources</span></span>

- <span data-ttu-id="80c32-186">[Ferramentas do Microsoft ASP.NET para o Windows Azure Active Directory – Visual Studio 2012](https://blogs.msdn.com/b/vbertocci/archive/2013/02/18/microsoft-asp-net-tools-for-windows-azure-active-directory-visual-studio-2012.aspx) – Vittorio Bertocci</span><span class="sxs-lookup"><span data-stu-id="80c32-186">[Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio 2012](https://blogs.msdn.com/b/vbertocci/archive/2013/02/18/microsoft-asp-net-tools-for-windows-azure-active-directory-visual-studio-2012.aspx) – Vittorio Bertocci</span></span>
- [<span data-ttu-id="80c32-187">Windows recursos do Azure: Identity</span><span class="sxs-lookup"><span data-stu-id="80c32-187">Windows Azure Features: Identity</span></span>](https://docs.microsoft.com/azure/active-directory/)
- [<span data-ttu-id="80c32-188">TechNet: Windows Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="80c32-188">TechNet: Windows Azure Active Directory</span></span>](https://technet.microsoft.com/library/hh967619.aspx)
- [<span data-ttu-id="80c32-189">Windows Azure Active Directory: Desenvolver aplicativos para sua organização</span><span class="sxs-lookup"><span data-stu-id="80c32-189">Windows Azure Active Directory: Develop Apps for your organization</span></span>](https://activedirectory.windowsazure.com/Develop/Single-Tenant.aspx)
- [<span data-ttu-id="80c32-190">Windows Azure Active Directory: Desenvolver aplicativos para várias organizações</span><span class="sxs-lookup"><span data-stu-id="80c32-190">Windows Azure Active Directory: Develop Apps for multiple organizations</span></span>](https://activedirectory.windowsazure.com/Develop/Multi-Tenant.aspx)
- [<span data-ttu-id="80c32-191">Como implementar o logon único com o Windows Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="80c32-191">How to implement single sign-on with Windows Azure Active Directory</span></span>](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect)
- <span data-ttu-id="80c32-192">[Logon único com o Windows Azure Active Directory: um mergulho profundo](https://blogs.msdn.com/b/vbertocci/archive/2012/07/05/single-sign-on-with-windows-azure-active-directory-a-deep-dive.aspx) – Vittorio Bertocci</span><span class="sxs-lookup"><span data-stu-id="80c32-192">[Single Sign-On with Windows Azure Active Directory: a Deep Dive](https://blogs.msdn.com/b/vbertocci/archive/2012/07/05/single-sign-on-with-windows-azure-active-directory-a-deep-dive.aspx) – Vittorio Bertocci</span></span>
- [<span data-ttu-id="80c32-193">Usar o AD FS 2.0 para implementar e gerenciar logon único</span><span class="sxs-lookup"><span data-stu-id="80c32-193">Use AD FS 2.0 to implement and manage single sign-on</span></span>](https://technet.microsoft.com/library/jj205462.aspx)
