---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/strategies-for-database-development-and-deployment-cs
title: Estratégias de desenvolvimento de banco de dados e de implantação (c#) | Microsoft Docs
author: rick-anderson
description: Ao implantar um aplicativo controlado por dados pela primeira vez você cegamente pode copiar o banco de dados no ambiente de desenvolvimento para o ambiente de produção. B...
ms.author: riande
ms.date: 04/23/2009
ms.assetid: 3e8b0627-3eb7-488e-807e-067cba7cec05
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/strategies-for-database-development-and-deployment-cs
msc.type: authoredcontent
ms.openlocfilehash: 4ea1713541c30623c0f7c8387318549dd36a125f
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/25/2019
ms.locfileid: "58423579"
---
<a name="strategies-for-database-development-and-deployment-c"></a><span data-ttu-id="ea858-104">Estratégias de desenvolvimento e implantação de banco de dados (C#)</span><span class="sxs-lookup"><span data-stu-id="ea858-104">Strategies for Database Development and Deployment (C#)</span></span>
====================
<span data-ttu-id="ea858-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ea858-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="ea858-106">Baixar PDF</span><span class="sxs-lookup"><span data-stu-id="ea858-106">Download PDF</span></span>](http://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial10_DBDevel_cs.pdf)

> <span data-ttu-id="ea858-107">Ao implantar um aplicativo controlado por dados pela primeira vez você cegamente pode copiar o banco de dados no ambiente de desenvolvimento para o ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-107">When deploying a data-driven application for the first time you can blindly copy the database in the development environment to the production environment.</span></span> <span data-ttu-id="ea858-108">Mas, executando um cego cópia nas próximas implantações substituirá todos os dados inseridos no banco de dados de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-108">But performing a blind copy in subsequent deployments will overwrite any data entered into the production database.</span></span> <span data-ttu-id="ea858-109">Em vez disso, implantar um banco de dados envolve a aplicação das alterações feitas no banco de dados de desenvolvimento, desde a última implantação no banco de dados de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-109">Instead, deploying a database involves applying the changes made to the development database since the last deployment onto the production database.</span></span> <span data-ttu-id="ea858-110">Este tutorial examina esses desafios e oferece várias estratégias para ajudá-lo com o chronicling e aplicando as alterações feitas no banco de dados desde a última implantação.</span><span class="sxs-lookup"><span data-stu-id="ea858-110">This tutorial examines these challenges and offers various strategies to assist with chronicling and applying the changes made to the database since the last deployment.</span></span>


## <a name="introduction"></a><span data-ttu-id="ea858-111">Introdução</span><span class="sxs-lookup"><span data-stu-id="ea858-111">Introduction</span></span>

<span data-ttu-id="ea858-112">Conforme discutido nos tutoriais anteriores, implantando um aplicativo ASP.NET envolve copiando o conteúdo pertinente do ambiente de desenvolvimento para o ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-112">As discussed in previous tutorials, deploying an ASP.NET application entails copying the pertinent content from the development environment to the production environment.</span></span> <span data-ttu-id="ea858-113">Implantação não é um evento único, mas em vez disso, algo que acontece sempre que uma nova versão do software é liberada ou quando bugs ou preocupações de segurança foram identificadas e resolvidas.</span><span class="sxs-lookup"><span data-stu-id="ea858-113">Deployment is not a one-time event, but rather something that happens every time a new version of the software is released or when bugs or security concerns have been identified and addressed.</span></span> <span data-ttu-id="ea858-114">Ao copiar as páginas do ASP.NET, imagens, arquivos JavaScript e outros esses arquivos ao ambiente de produção, que você não precisa se preocupar com como esses arquivos foram alterados desde a última implantação.</span><span class="sxs-lookup"><span data-stu-id="ea858-114">When copying ASP.NET pages, images, JavaScript files, and other such files to the production environment you do not need to concern yourself with how these file have been changed since the last deployment.</span></span> <span data-ttu-id="ea858-115">Cegamente você pode copiar o arquivo para a produção, substituindo o conteúdo existente.</span><span class="sxs-lookup"><span data-stu-id="ea858-115">You can blindly copy the file to production, overwriting the existing content.</span></span> <span data-ttu-id="ea858-116">Infelizmente, essa simplicidade não se estende para implantar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-116">Unfortunately, this simplicity does not extend to deploying the database.</span></span>

<span data-ttu-id="ea858-117">Ao implantar um aplicativo controlado por dados pela primeira vez você cegamente pode copiar o banco de dados no ambiente de desenvolvimento para o ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-117">When deploying a data-driven application for the first time you can blindly copy the database in the development environment to the production environment.</span></span> <span data-ttu-id="ea858-118">Mas, executando um cego cópia nas próximas implantações substituirá todos os dados inseridos no banco de dados de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-118">But performing a blind copy in subsequent deployments will overwrite any data entered into the production database.</span></span> <span data-ttu-id="ea858-119">Em vez disso, a implantação de um banco de dados envolve a aplicação de *alterações* feitas no banco de dados de desenvolvimento, desde a última implantação no banco de dados de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-119">Instead, deploying a database involves applying the *changes* made to the development database since the last deployment onto the production database.</span></span> <span data-ttu-id="ea858-120">Este tutorial examina esses desafios e oferece várias estratégias para ajudá-lo com o chronicling e aplicando as alterações feitas no banco de dados desde a última implantação.</span><span class="sxs-lookup"><span data-stu-id="ea858-120">This tutorial examines these challenges and offers various strategies to assist with chronicling and applying the changes made to the database since the last deployment.</span></span>

## <a name="the-challenges-of-deploying-a-database"></a><span data-ttu-id="ea858-121">Os desafios de implantação de um banco de dados</span><span class="sxs-lookup"><span data-stu-id="ea858-121">The Challenges of Deploying a Database</span></span>

<span data-ttu-id="ea858-122">Antes de um aplicativo orientado a dados foi implantado pela primeira vez, há apenas um banco de dados, ou seja, o banco de dados no ambiente de desenvolvimento, por isso, ao implantar um aplicativo controlado por dados pela primeira vez você cegamente pode copiar o banco de dados a ambiente de desenvolvimento para o ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-122">Before a data-driven application has been deployed for the first time, there is only one database, namely the database in the development environment, which is why when deploying a data-driven application for the first time you can blindly copy the database in the development environment to the production environment.</span></span> <span data-ttu-id="ea858-123">Mas quando o aplicativo tiver sido implantado há duas cópias do banco de dados: um no desenvolvimento e outro na produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-123">But once the application has been deployed there are two copies of the database: one in development and one in production.</span></span>

<span data-ttu-id="ea858-124">Entre as implantações de bancos de dados de desenvolvimento e produção podem se tornar fora de sincronia. Enquanto o esquema de s de banco de dados de produção permanecerá inalterado, o esquema de s de banco de dados de desenvolvimento pode alterar como os novos recursos são adicionados.</span><span class="sxs-lookup"><span data-stu-id="ea858-124">Between deployments the development and production databases can become out of sync. While the production database s schema remains unchanged, the development database s schema may change as new features are added.</span></span> <span data-ttu-id="ea858-125">Você pode adicionar ou remover colunas, tabelas, exibições ou procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="ea858-125">You might add or remove columns, tables, views, or stored procedures.</span></span> <span data-ttu-id="ea858-126">Também pode haver dados importantes que são adicionados ao banco de dados de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="ea858-126">There may also be important data that gets added to the development database.</span></span> <span data-ttu-id="ea858-127">Muitos aplicativos controlados por dados incluem tabelas de pesquisa, preenchidas com dados embutidos, específicos do aplicativo que não são editáveis pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="ea858-127">Many data-driven applications include lookup tables populated with hard-coded, application-specific data that are not user-editable.</span></span> <span data-ttu-id="ea858-128">Por exemplo, um site de leilão pode ter uma lista suspensa com as opções que descrevem a condição do item que está sendo auctioned: Novo, como novo, BOM e justa.</span><span class="sxs-lookup"><span data-stu-id="ea858-128">For example, an auction website might have a drop-down list with choices that describe the condition of the item being auctioned: New, Like New, Good, and Fair.</span></span> <span data-ttu-id="ea858-129">Em vez de embutir essas opções diretamente na lista suspensa é geralmente melhor colocá-los em uma tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-129">Rather than hard-coding these options directly in the drop-down list it is usually better to place them in a database table.</span></span> <span data-ttu-id="ea858-130">Se, durante o desenvolvimento, uma nova condição chamada fraco é adicionada à tabela, em seguida, ao implantar o aplicativo esse mesmo registro precisa ser adicionada à tabela de pesquisa no banco de dados de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-130">If, during development, a new condition named Poor is added to the table then when deploying the application this same record needs to be added to the lookup table in the production database.</span></span>

<span data-ttu-id="ea858-131">Idealmente, implantar o banco de dados envolveria copiando o banco de dados de desenvolvimento para produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-131">Ideally, deploying the database would involve copying the database from development to production.</span></span> <span data-ttu-id="ea858-132">Mas tenha em mente que, depois que você implantou o aplicativo e retomada de desenvolvimento, o banco de dados de produção está sendo preenchido com dados reais de usuários reais.</span><span class="sxs-lookup"><span data-stu-id="ea858-132">But keep in mind that after you have deployed the application and resumed development, the production database is being populated with real data from real users.</span></span> <span data-ttu-id="ea858-133">Portanto, se você fosse simplesmente copiar o banco de dados de desenvolvimento em produção na próxima implantação substituir o banco de dados de produção e perder seus dados existentes.</span><span class="sxs-lookup"><span data-stu-id="ea858-133">Therefore, if you were to simply copy the database from development to production at the next deployment you would overwrite the production database and lose its existing data.</span></span> <span data-ttu-id="ea858-134">O resultado líquido é que a implantação de banco de dados se resume a aplicar as alterações feitas no banco de dados de desenvolvimento, desde a última implantação.</span><span class="sxs-lookup"><span data-stu-id="ea858-134">The net result is that deploying the database boils down to applying the changes made to the development database since the last deployment.</span></span>

<span data-ttu-id="ea858-135">Como implantar um banco de dados envolve a aplicação das alterações no esquema e, possivelmente, os dados desde a última implantação, um histórico das alterações deve ser mantido (ou determinado no momento da implantação) para que essas alterações podem ser aplicadas em produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-135">Because deploying a database involves applying the changes in the schema and, possibly, the data since the last deployment, a history of changes must be maintained (or determined at deploy-time) so that those changes can be applied on production.</span></span> <span data-ttu-id="ea858-136">Há uma variedade de técnicas para gerenciar e aplicar as alterações ao modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-136">There are a variety of techniques for managing and applying changes to the data model.</span></span>

### <a name="defining-the-baseline"></a><span data-ttu-id="ea858-137">Definindo a linha de base</span><span class="sxs-lookup"><span data-stu-id="ea858-137">Defining the Baseline</span></span>

<span data-ttu-id="ea858-138">Para manter as alterações em seu banco de dados do aplicativo s, você precisa ter algum estado inicial, uma linha de base para o qual as alterações são aplicadas ao.</span><span class="sxs-lookup"><span data-stu-id="ea858-138">To maintain the changes to your application s database you need to have some starting state, a baseline to which the changes are applied to.</span></span> <span data-ttu-id="ea858-139">Por um lado, o estado inicial pode ser um banco de dados vazio com nenhum tabelas, exibições ou procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="ea858-139">At one extreme the starting state could be an empty database with no tables, views, or stored procedures.</span></span> <span data-ttu-id="ea858-140">Uma linha de base resulta em um log de alterações grandes, porque ele deve incluir a criação de todas as tabelas do banco de dados s, exibições e procedimentos armazenados, juntamente com todas as alterações feitas após a implantação inicial.</span><span class="sxs-lookup"><span data-stu-id="ea858-140">Such a baseline results in a large change log because it must include the creation of all of the database s tables, views, and stored procedures along with any changes made after the initial deployment.</span></span> <span data-ttu-id="ea858-141">Na outra extremidade do espectro, você pode definir a linha de base como a versão do banco de dados que é inicialmente implantado no ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-141">At the other end of the spectrum you could set the baseline as the version of the database that is initially deployed to the production environment.</span></span> <span data-ttu-id="ea858-142">Essa opção resulta em um log de alterações muito menor, porque ela inclui apenas as alterações feitas no banco de dados após a primeira implantação.</span><span class="sxs-lookup"><span data-stu-id="ea858-142">This choice results in a much smaller change log because it only includes the changes made to the database following the first deployment.</span></span> <span data-ttu-id="ea858-143">Essa é a abordagem que eu prefiro.</span><span class="sxs-lookup"><span data-stu-id="ea858-143">This is the approach I prefer.</span></span> <span data-ttu-id="ea858-144">E, certamente você pode escolher um meio mais a abordagem de estrada, definindo a linha de base como algum ponto entre a criação inicial do banco de dados e quando o banco de dados é implantado pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="ea858-144">And of course you can choose a more middle of the road approach, defining the baseline as some point between the initial creation of the database and when the database is first deployed.</span></span>

<span data-ttu-id="ea858-145">Depois que você tiver escolhido uma linha de base considere gerar um script SQL que pode ser executado para recriar a versão de linha de base.</span><span class="sxs-lookup"><span data-stu-id="ea858-145">Once you have chosen a baseline consider generating a SQL script that can be executed to recreate the baseline version.</span></span> <span data-ttu-id="ea858-146">Esse script torna possível recriar rapidamente a versão de linha de base do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-146">Such a script makes it possible to quickly recreate the baseline version of the database.</span></span> <span data-ttu-id="ea858-147">Essa funcionalidade é especialmente útil em projetos grandes, onde pode haver vários desenvolvedores trabalhando no projeto ou ambientes adicionais, como teste ou preparo, que cada precisa de sua própria cópia do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-147">This functionality is especially useful in larger projects, where there may be multiple developers working on the project or additional environments, such as testing or staging, that each need their own copy of the database.</span></span>

<span data-ttu-id="ea858-148">Há uma variedade de ferramentas à sua disposição para gerar um script SQL da versão de linha de base.</span><span class="sxs-lookup"><span data-stu-id="ea858-148">There are a variety of tools at your disposal to generate a SQL script of the baseline version.</span></span> <span data-ttu-id="ea858-149">Do SSMS SQL Server Management Studio () pode clicar duas vezes no banco de dados, vá para o submenu de tarefas e escolha a opção de gerar Scripts.</span><span class="sxs-lookup"><span data-stu-id="ea858-149">From SQL Server Management Studio (SSMS) you can right-click on the database, go to the Tasks submenu, and choose the Generate Scripts option.</span></span> <span data-ttu-id="ea858-150">Isso inicia o Assistente de Script, você pode instruir o para gerar um arquivo que contém os comandos SQL para criar objetos de s de seu banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-150">This launches the Script Wizard, which you can instruct to generate a file that contains the SQL commands to create your database s objects.</span></span> <span data-ttu-id="ea858-151">Outra opção é o Assistente de publicação de banco de dados, que pode gerar os comandos SQL para criar não apenas o esquema de banco de dados, mas também os dados nas tabelas de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-151">Another option is the Database Publishing Wizard, which can generate the SQL commands to not only create the database schema, but also the data in the database tables.</span></span> <span data-ttu-id="ea858-152">O Assistente de publicação de banco de dados foi examinado em detalhes na *Implantando um banco de dados* tutorial.</span><span class="sxs-lookup"><span data-stu-id="ea858-152">The Database Publishing Wizard was examined in detail back in the *Deploying a Database* tutorial.</span></span> <span data-ttu-id="ea858-153">Independentemente de qual ferramenta usar, no final das contas, você deve ter um arquivo de script que você pode usar para recriar a versão de linha de base do seu banco de dados, caso seja necessário surgir.</span><span class="sxs-lookup"><span data-stu-id="ea858-153">Regardless of what tool you use, in the end you should have a script file that you can use to recreate the baseline version of your database, should the need arise.</span></span>

## <a name="documenting-the-database-changes-in-prose"></a><span data-ttu-id="ea858-154">Documentar as alterações de banco de dados em um texto</span><span class="sxs-lookup"><span data-stu-id="ea858-154">Documenting the Database Changes in Prose</span></span>

<span data-ttu-id="ea858-155">É a maneira mais simples para manter um log de alterações para o modelo de dados durante a fase de desenvolvimento registrar as alterações em um texto.</span><span class="sxs-lookup"><span data-stu-id="ea858-155">The simplest way to maintain a log of changes to the data model during the development phase is to record the changes in prose.</span></span> <span data-ttu-id="ea858-156">Por exemplo, se durante o desenvolvimento de um aplicativo já implantado, você adiciona uma nova coluna para o `Employees` da tabela, remover uma coluna do `Orders` da tabela e adicionar uma nova tabela (`ProductCategories`), você manteria um arquivo de texto ou documento do Microsoft Word com o histórico do seguinte:</span><span class="sxs-lookup"><span data-stu-id="ea858-156">For example, if during development of an already-deployed application you add a new column to the `Employees` table, remove a column from the `Orders` table, and add a new table (`ProductCategories`), you would maintain a text file or Microsoft Word document with the following history:</span></span>

<a id="0.4_table01"></a>


| <span data-ttu-id="ea858-157">**Data da alteração**</span><span class="sxs-lookup"><span data-stu-id="ea858-157">**Change Date**</span></span> | <span data-ttu-id="ea858-158">**Alterar detalhes**</span><span class="sxs-lookup"><span data-stu-id="ea858-158">**Change Details**</span></span> |
| --- | --- |
| <span data-ttu-id="ea858-159">2009-02-03:</span><span class="sxs-lookup"><span data-stu-id="ea858-159">2009-02-03:</span></span> | <span data-ttu-id="ea858-160">Coluna adicionada `DepartmentID` (`int`, NOT NULL) para o `Employees` tabela.</span><span class="sxs-lookup"><span data-stu-id="ea858-160">Added column `DepartmentID` (`int`, NOT NULL) to the `Employees` table.</span></span> <span data-ttu-id="ea858-161">Adicionada uma restrição de chave estrangeira da `Departments.DepartmentID` para `Employees.DepartmentID`.</span><span class="sxs-lookup"><span data-stu-id="ea858-161">Added a foreign key constraint from `Departments.DepartmentID` to `Employees.DepartmentID`.</span></span> |
| <span data-ttu-id="ea858-162">2009-02-05:</span><span class="sxs-lookup"><span data-stu-id="ea858-162">2009-02-05:</span></span> | <span data-ttu-id="ea858-163">A coluna removida `TotalWeight` do `Orders` tabela.</span><span class="sxs-lookup"><span data-stu-id="ea858-163">Removed column `TotalWeight` from the `Orders` table.</span></span> <span data-ttu-id="ea858-164">Associado a dados já capturados no `OrderDetails` registros.</span><span class="sxs-lookup"><span data-stu-id="ea858-164">Data already captured in associated `OrderDetails` records.</span></span> |
| <span data-ttu-id="ea858-165">2009-02-12:</span><span class="sxs-lookup"><span data-stu-id="ea858-165">2009-02-12:</span></span> | <span data-ttu-id="ea858-166">Criado o `ProductCategories` tabela.</span><span class="sxs-lookup"><span data-stu-id="ea858-166">Created the `ProductCategories` table.</span></span> <span data-ttu-id="ea858-167">Há três colunas: `ProductCategoryID` (`int`, `IDENTITY`, `NOT NULL`), `CategoryName` (`nvarchar(50)`, `NOT NULL`), e `Active` (`bit`, `NOT NULL`).</span><span class="sxs-lookup"><span data-stu-id="ea858-167">There are three columns: `ProductCategoryID` (`int`, `IDENTITY`, `NOT NULL`), `CategoryName` (`nvarchar(50)`, `NOT NULL`), and `Active` (`bit`, `NOT NULL`).</span></span> <span data-ttu-id="ea858-168">Adicionada uma restrição primary key para `ProductCategoryID`e o valor padrão de 1 a `Active`.</span><span class="sxs-lookup"><span data-stu-id="ea858-168">Added a primary key constraint to `ProductCategoryID`, and a default value of 1 to `Active`.</span></span> |


<span data-ttu-id="ea858-169">Há várias desvantagens nessa abordagem.</span><span class="sxs-lookup"><span data-stu-id="ea858-169">There are a number of drawbacks to this approach.</span></span> <span data-ttu-id="ea858-170">Para começar, não há nenhuma esperança para automação.</span><span class="sxs-lookup"><span data-stu-id="ea858-170">For starters, there is no hope for automation.</span></span> <span data-ttu-id="ea858-171">A qualquer momento essas alterações precisam ser aplicados a um banco de dados -, como quando o aplicativo é implantado – um desenvolvedor deve implementar manualmente cada alteração, um de cada vez.</span><span class="sxs-lookup"><span data-stu-id="ea858-171">Anytime these changes need to be applied to a database - such as when the application is deployed - a developer must manually implement each change, one at a time.</span></span> <span data-ttu-id="ea858-172">Além disso, se você precisar reconstruir uma versão específica do banco de dados da linha de base usando o log de alterações, fazendo assim levará mais tempo à medida que aumenta o tamanho do log.</span><span class="sxs-lookup"><span data-stu-id="ea858-172">Moreover, if you need to reconstruct a particular version of the database from the baseline using the change log, doing so will take more and more time as the size of the log grows.</span></span> <span data-ttu-id="ea858-173">Outra desvantagem para esse método é que a clareza e o nível de detalhes de cada entrada de log de alteração é da esquerda para a pessoa que registra a alteração.</span><span class="sxs-lookup"><span data-stu-id="ea858-173">Another drawback to this method is that the clarity and level of detail of each change log entry is left to the person recording the change.</span></span> <span data-ttu-id="ea858-174">Em uma equipe com vários desenvolvedores alguns podem tornar as entradas mais detalhadas, mais legíveis ou mais precisas que outros.</span><span class="sxs-lookup"><span data-stu-id="ea858-174">In a team with multiple developers some may make more detailed, more readable, or more precise entries than others.</span></span> <span data-ttu-id="ea858-175">Além disso, os erros de digitação e outros erros de entrada de dados relacionados a humanos são possíveis.</span><span class="sxs-lookup"><span data-stu-id="ea858-175">Also, typos and other human-related data entry errors are possible.</span></span>

<span data-ttu-id="ea858-176">O principal benefício de documentar as alterações de banco de dados em um texto é a simplicidade.</span><span class="sxs-lookup"><span data-stu-id="ea858-176">The primary benefit of documenting the database changes in prose is simplicity.</span></span> <span data-ttu-id="ea858-177">Você não a familiaridade do t necessidade com a sintaxe SQL para criar e alterar objetos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-177">You don t need familiarity with the SQL syntax for creating and altering database objects.</span></span> <span data-ttu-id="ea858-178">Em vez disso, você pode registrar as alterações em um texto e implementá-los por meio da interface gráfica do usuário do SQL Server Management Studio s.</span><span class="sxs-lookup"><span data-stu-id="ea858-178">Instead, you can record the changes in prose and implement them through SQL Server Management Studio s graphical user interface.</span></span>

<span data-ttu-id="ea858-179">Manter seu log de alterações em um texto é, sem dúvida, não muito sofisticado e não funcionará bem com certos projetos, como aqueles que são grandes no escopo, têm alterações frequentes ao modelo de dados ou envolver vários desenvolvedores.</span><span class="sxs-lookup"><span data-stu-id="ea858-179">Maintaining your change log in prose is, admittedly, not very sophisticated and won't work well with certain projects, such as ones that are large in scope, have frequent changes to the data model, or involve multiple developers.</span></span> <span data-ttu-id="ea858-180">Mas eu já vi essa abordagem funciona muito bem em pequenos, com projetos que têm somente as alterações ocasionais ao modelo de dados e onde o desenvolvedor solo não tem um plano de fundo forte na sintaxe SQL criando e alterando objetos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-180">But I have seen this approach work quite well in small, one-man projects that have only occasional changes to the data model and where the solo developer does not have a strong background in the SQL syntax for creating and altering database objects.</span></span>

> [!NOTE]
> <span data-ttu-id="ea858-181">Enquanto as informações no log de alterações são, tecnicamente, só é necessário até o momento da implantação, é recomendável manter um histórico das alterações.</span><span class="sxs-lookup"><span data-stu-id="ea858-181">While the information in the change log is, technically, only needed until deploy-time, I recommend keeping a history of changes.</span></span> <span data-ttu-id="ea858-182">Mas, em vez de manter um único, crescendo cada arquivo de log de alteração, considere ter um arquivo de log de alteração diferente para cada versão do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-182">But rather than maintaining a single, ever growing change log file, consider having a different change log file for each database version.</span></span> <span data-ttu-id="ea858-183">Normalmente você desejará versão do banco de dados cada vez que ele é implantado.</span><span class="sxs-lookup"><span data-stu-id="ea858-183">Typically you will want to version the database each time it is deployed.</span></span> <span data-ttu-id="ea858-184">Ao manter um log dos logs de alteração pode, a partir da linha de base, recriar qualquer versão do banco de dados executando os scripts de log de alteração a partir da versão 1 e continuando até que a versão que você precise recriar.</span><span class="sxs-lookup"><span data-stu-id="ea858-184">By maintaining a log of change logs you can, starting from the baseline, recreate any database version by executing the change log scripts starting from version 1 and continuing until you reach the version you need to recreate.</span></span>


## <a name="recording-the-sql-change-statements"></a><span data-ttu-id="ea858-185">Gravando as instruções de alteração SQL</span><span class="sxs-lookup"><span data-stu-id="ea858-185">Recording the SQL Change Statements</span></span>

<span data-ttu-id="ea858-186">A principal desvantagem de manter o log de alterações em um texto é a falta de automação.</span><span class="sxs-lookup"><span data-stu-id="ea858-186">The primary drawback of maintaining the change log in prose is the lack of automation.</span></span> <span data-ttu-id="ea858-187">Idealmente, implementar as alterações de banco de dados no banco de dados de produção no momento da implantação seria tão fácil quanto clicar em um botão para executar um script em vez de ter que executar manualmente uma lista de instruções.</span><span class="sxs-lookup"><span data-stu-id="ea858-187">Ideally, implementing the database changes to the production database at deploy-time would be as easy as clicking a button to execute a script rather than having to manually perform a list of instructions.</span></span> <span data-ttu-id="ea858-188">Essa automação é possível, mantendo um log de alterações que contém os comandos SQL usados para alterar o modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-188">Such automation is possible by maintaining a change log that contains those SQL commands used to alter the data model.</span></span>

<span data-ttu-id="ea858-189">A sintaxe SQL inclui um número de instruções para criar e modificar vários objetos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-189">The SQL syntax includes a number of statements for creating and modifying various database objects.</span></span> <span data-ttu-id="ea858-190">Por exemplo, o [ *instrução CREATE TABLE*](https://msdn.microsoft.com/library/ms174979.aspx), quando executada, cria uma nova tabela com as restrições e colunas especificadas.</span><span class="sxs-lookup"><span data-stu-id="ea858-190">For example, the [*CREATE TABLE statement*](https://msdn.microsoft.com/library/ms174979.aspx), when executed, creates a new table with the specified columns and constraints.</span></span> <span data-ttu-id="ea858-191">O [ *instrução ALTER TABLE* ](https://msdn.microsoft.com/library/ms190273.aspx) modifica uma tabela existente, adicionando, removendo ou modificando suas colunas ou restrições.</span><span class="sxs-lookup"><span data-stu-id="ea858-191">The [*ALTER TABLE statement*](https://msdn.microsoft.com/library/ms190273.aspx) modifies an existing table, adding, removing, or modifying its columns or constraints.</span></span> <span data-ttu-id="ea858-192">Também há instruções para criar, modificar e descartar índices, exibições, funções definidas pelo usuário, procedimentos armazenados, gatilhos e outros objetos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-192">There are also statements to create, modify, and drop indexes, views, user-defined functions, stored procedures, triggers, and other database objects.</span></span>

<span data-ttu-id="ea858-193">Voltando ao nosso exemplo anterior, da imagem que durante o desenvolvimento de um aplicativo já implantado, você adiciona uma nova coluna para o `Employees` da tabela, remover uma coluna do `Orders` da tabela e adicionar uma nova tabela (`ProductCategories`).</span><span class="sxs-lookup"><span data-stu-id="ea858-193">Returning to our earlier example, image that during development of an already-deployed application you add a new column to the `Employees` table, remove a column from the `Orders` table, and add a new table (`ProductCategories`).</span></span> <span data-ttu-id="ea858-194">Tais ações pode resultar em um arquivo de log de alteração com comandos SQL a seguir:</span><span class="sxs-lookup"><span data-stu-id="ea858-194">Such actions would result in a change log file with the following SQL commands:</span></span>

[!code-sql[Main](strategies-for-database-development-and-deployment-cs/samples/sample1.sql)]

<span data-ttu-id="ea858-195">Enviar por push essas alterações no banco de dados de produção no momento da implantação é uma operação de um clique: Abra o SQL Server Management Studio, conecte-se ao banco de dados de produção, abra uma janela nova consulta, cole o conteúdo do log de alterações e clique em executar para executar o script.</span><span class="sxs-lookup"><span data-stu-id="ea858-195">Pushing these changes to the production database at deploy-time is a one-click operation: open SQL Server Management Studio, connect to your production database, open a New Query window, paste the contents of the change log, and click Execute to run the script.</span></span>

## <a name="using-a-comparison-tool-to-synchronize-the-data-models"></a><span data-ttu-id="ea858-196">Usando uma ferramenta de comparação para sincronizar os modelos de dados</span><span class="sxs-lookup"><span data-stu-id="ea858-196">Using a Comparison Tool to Synchronize the Data Models</span></span>

<span data-ttu-id="ea858-197">Documentar as alterações de banco de dados em um texto é fácil, mas implementar as alterações exige que um desenvolvedor fazer cada alteração no banco de dados de produção um por vez; Documentar os comandos SQL de alteração torna a implementar essas alterações no banco de dados de produção tão fácil e rápido quanto clicar em um botão, mas requer a aprender e dominar as instruções SQL e sintaxe para criação e alteração de objetos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-197">Documenting database changes in prose is easy, but implementing the changes requires a developer to make each change on the production database one at a time; documenting the change SQL commands makes implementing those changes on the production database as easy and quick as clicking a button, but requires learning and mastering the SQL statements and syntax for creating and altering database objects.</span></span> <span data-ttu-id="ea858-198">Ferramentas de comparação do banco de dados tirar o melhor de ambas as abordagens e descartar o pior.</span><span class="sxs-lookup"><span data-stu-id="ea858-198">Database comparison tools take the best from both approaches and discard the worst.</span></span>

<span data-ttu-id="ea858-199">Uma ferramenta de comparação do banco de dados compara o esquema ou os dados de dois bancos de dados e exibe um relatório de resumo mostrando a você como diferem os bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-199">A database comparison tool compares the schema or data of two databases and displays a summary report showing you how the databases differ.</span></span> <span data-ttu-id="ea858-200">Em seguida, com o clique de um botão, você pode gerar os comandos SQL para a sincronização de um ou mais objetos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-200">Then, with the click of a button, you can generate the SQL commands for synchronizing one or more database objects.</span></span> <span data-ttu-id="ea858-201">Em resumo, você pode usar uma ferramenta de comparação do banco de dados para comparar o desenvolvimento e comandos de bancos de dados de produção no momento da implantação, gerando um arquivo que contém o SQL que, quando executado, aplicará as alterações no esquema de banco de dados s produção até que ele espelha o esquema de banco de dados s de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="ea858-201">In a nutshell, you can use a database comparison tool to compare the development and production databases at deploy-time, generating a file that contains the SQL commands that, when executed, will apply the changes to the production database s schema so that it mirrors the development database s schema.</span></span>

<span data-ttu-id="ea858-202">Há uma variedade de ferramentas de comparação do banco de dados de terceiros oferecidos por fornecedores diferentes.</span><span class="sxs-lookup"><span data-stu-id="ea858-202">There are a variety of third-party database comparison tools offered by many different vendors.</span></span> <span data-ttu-id="ea858-203">Um exemplo é [ *SQL Compare*](http://www.red-gate.com/products/SQL_Compare/), por [ *Red Gate Software*](http://www.red-gate.com/).</span><span class="sxs-lookup"><span data-stu-id="ea858-203">One such example is [*SQL Compare*](http://www.red-gate.com/products/SQL_Compare/), by [*Red Gate Software*](http://www.red-gate.com/).</span></span> <span data-ttu-id="ea858-204">Deixe o s percorrer o processo de usar o SQL Compare para comparar e sincronizar esquemas de bancos de dados de desenvolvimento e produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-204">Let s walk through the process of using SQL Compare to compare and synchronize the development and production databases schemas.</span></span>

> [!NOTE]
> <span data-ttu-id="ea858-205">No momento da redação deste artigo, a versão atual do SQL Compare era versão 7.1, com a edição Standard de US $395 de custos.</span><span class="sxs-lookup"><span data-stu-id="ea858-205">At the time of this writing the current version of SQL Compare was version 7.1, with the Standard Edition costing $395.</span></span> <span data-ttu-id="ea858-206">Você pode acompanhar baixando uma avaliação gratuita de 14 dias.</span><span class="sxs-lookup"><span data-stu-id="ea858-206">You can follow along by downloading a free 14-day trial.</span></span>


<span data-ttu-id="ea858-207">Quando a comparação do SQL inicia a caixa de diálogo de projetos de comparação é aberta, mostrando os projetos de SQL Compare salvos.</span><span class="sxs-lookup"><span data-stu-id="ea858-207">When SQL Compare starts the Comparison Projects dialog box opens, showing the saved SQL Compare projects.</span></span> <span data-ttu-id="ea858-208">Crie um novo projeto.</span><span class="sxs-lookup"><span data-stu-id="ea858-208">Create a new project.</span></span> <span data-ttu-id="ea858-209">Isso inicia o Assistente de configuração de projeto, que solicita informações sobre os bancos de dados a ser comparado (veja a Figura 1).</span><span class="sxs-lookup"><span data-stu-id="ea858-209">This launches the Project Configuration wizard, which prompts for information about the databases to compare (see Figure 1).</span></span> <span data-ttu-id="ea858-210">Insira as informações para os bancos de dados de desenvolvimento e produção de ambiente.</span><span class="sxs-lookup"><span data-stu-id="ea858-210">Enter the information for the development and production environment databases.</span></span>


<span data-ttu-id="ea858-211">[![Comparar o desenvolvimento e os bancos de dados de produção](strategies-for-database-development-and-deployment-cs/_static/image2.jpg)](strategies-for-database-development-and-deployment-cs/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="ea858-211">[![Compare the Development and Production Databases](strategies-for-database-development-and-deployment-cs/_static/image2.jpg)](strategies-for-database-development-and-deployment-cs/_static/image1.jpg)</span></span>

<span data-ttu-id="ea858-212">**Figura 1**: Comparar o desenvolvimento e os bancos de dados de produção ([clique para exibir a imagem em tamanho normal](strategies-for-database-development-and-deployment-cs/_static/image3.jpg))</span><span class="sxs-lookup"><span data-stu-id="ea858-212">**Figure 1**: Compare the Development and Production Databases ([Click to view full-size image](strategies-for-database-development-and-deployment-cs/_static/image3.jpg))</span></span>


> [!NOTE]
> <span data-ttu-id="ea858-213">Se seu banco de dados do ambiente de desenvolvimento é um arquivo de banco de dados do SQL Express Edition no `App_Data` pasta do seu site, você precisará registrar o banco de dados no servidor de banco de dados do SQL Server Express para selecioná-lo na caixa de diálogo mostrada na Figura 1.</span><span class="sxs-lookup"><span data-stu-id="ea858-213">If your development environment database is a SQL Express Edition database file in the `App_Data` folder of your website you will need to register the database in the SQL Server Express database server in order to select it from the dialog box shown in Figure 1.</span></span> <span data-ttu-id="ea858-214">A maneira mais fácil de fazer isso é abrir o SQL Server Management Studio (SSMS), conecte-se ao servidor de banco de dados SQL Server Express e anexar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-214">The easiest way to accomplish this is to open SQL Server Management Studio (SSMS), connect to the SQL Server Express database server, and attach the database.</span></span> <span data-ttu-id="ea858-215">Se você não tiver o SSMS instalado em seu computador, você pode baixar e instalar a versão gratuita [ *versão do SQL Server 2008 Management Studio Basic*](https://www.microsoft.com/downloads/details.aspx?FamilyId=7522A683-4CB2-454E-B908-E805E9BD4E28&amp;displaylang=en).</span><span class="sxs-lookup"><span data-stu-id="ea858-215">If you do not have SSMS installed on your computer you can download and install the free [*SQL Server 2008 Management Studio Basic version*](https://www.microsoft.com/downloads/details.aspx?FamilyId=7522A683-4CB2-454E-B908-E805E9BD4E28&amp;displaylang=en).</span></span>


<span data-ttu-id="ea858-216">Além de selecionar os bancos de dados a ser comparado, você também pode especificar uma variedade de configurações na guia Opções de comparação. Uma opção que você talvez queira ativar é os "Ignorar restrição e índice nomes".</span><span class="sxs-lookup"><span data-stu-id="ea858-216">In addition to selecting the databases to compare, you can also specify a variety of comparison settings from the Options tab. One option you may want to turn on is the "Ignore constraint and index names."</span></span> <span data-ttu-id="ea858-217">Lembre-se de que o tutorial anterior, adicionamos que o aplicativo de serviços de objetos de banco de dados para os bancos de dados de desenvolvimento e produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-217">Recall that in the preceding tutorial we added the application services database objects to the development and production databases.</span></span> <span data-ttu-id="ea858-218">Se você tiver usado o `aspnet_regsql.exe` ferramenta para criar esses objetos no banco de dados de produção, em seguida, você descobrirá que a chave primária e nomes de restrição exclusiva diferem entre os bancos de dados de desenvolvimento e produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-218">If you used the `aspnet_regsql.exe` tool to create these objects on the production database then you will find that the primary key and unique constraint names differ between the development and production databases.</span></span> <span data-ttu-id="ea858-219">Consequentemente, a comparação do SQL sinalizará todas as tabelas dos serviços de aplicativo como diferentes.</span><span class="sxs-lookup"><span data-stu-id="ea858-219">Consequently, SQL Compare will flag all of the application services tables as differing.</span></span> <span data-ttu-id="ea858-220">Você pode deixar os "Ignorar restrição e índice nomes" desmarcada e sincronizar os nomes de restrição ou instruir a comparação do SQL para ignorar essas diferenças.</span><span class="sxs-lookup"><span data-stu-id="ea858-220">You can either leave the "Ignore constraint and index names" unchecked and synchronize the constraint names, or instruct SQL Compare to ignore these differences.</span></span>

<span data-ttu-id="ea858-221">Depois de selecionar os bancos de dados compare (e revisar as opções de comparação), clique no botão comparar agora para começar a comparação.</span><span class="sxs-lookup"><span data-stu-id="ea858-221">After selecting the databases to compare (and reviewing the comparison options), click the Compare Now button to begin the comparison.</span></span> <span data-ttu-id="ea858-222">Ao longo de alguns segundos, a comparação do SQL examina os esquemas de dois bancos de dados e gera um relatório de diferenças entre eles.</span><span class="sxs-lookup"><span data-stu-id="ea858-222">Over the next several seconds, SQL Compare examines the schemas of the two databases and generates a report of how they differ.</span></span> <span data-ttu-id="ea858-223">Eu ve propositadamente feitas algumas modificações no banco de dados de desenvolvimento para mostrar como tais discrepâncias são indicadas na interface de comparação do SQL.</span><span class="sxs-lookup"><span data-stu-id="ea858-223">I ve purposefully made some modifications to the development database to show how such discrepancies are noted in the SQL Compare interface.</span></span> <span data-ttu-id="ea858-224">Como mostra a Figura 2, eu ve adicionado um `BirthDate` coluna para o `Authors` tabela, removida o `ISBN` coluna a partir o `Books` da tabela e adicionou uma nova tabela, `Ratings`, que é destinado para permitir que os usuários que visitam a taxa de site os livros revisados.</span><span class="sxs-lookup"><span data-stu-id="ea858-224">As Figure 2 shows, I ve added a `BirthDate` column to the `Authors` table, removed the `ISBN` column from the `Books` table, and added a new table, `Ratings`, which is meant to let users visiting the site rate the reviewed books.</span></span>

> [!NOTE]
> <span data-ttu-id="ea858-225">As alterações do modelo de dados feitas neste tutorial foram feitas para ilustrar o uso de uma ferramenta de comparação do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-225">The data model changes made in this tutorial were done to illustrate using a database comparison tool.</span></span> <span data-ttu-id="ea858-226">Você não encontrará essas alterações no banco de dados em tutoriais futuros.</span><span class="sxs-lookup"><span data-stu-id="ea858-226">You will not find these changes in the database in future tutorials.</span></span>


<span data-ttu-id="ea858-227">[![Comparação SQL lista as diferenças entre o desenvolvimento e os bancos de dados de produção](strategies-for-database-development-and-deployment-cs/_static/image5.jpg)](strategies-for-database-development-and-deployment-cs/_static/image4.jpg)</span><span class="sxs-lookup"><span data-stu-id="ea858-227">[![SQL Compare Lists the Differences Between the Development and Production Databases](strategies-for-database-development-and-deployment-cs/_static/image5.jpg)](strategies-for-database-development-and-deployment-cs/_static/image4.jpg)</span></span>

<span data-ttu-id="ea858-228">**Figura 2**: Comparação SQL lista as diferenças entre o desenvolvimento e os bancos de dados de produção ([clique para exibir a imagem em tamanho normal](strategies-for-database-development-and-deployment-cs/_static/image6.jpg))</span><span class="sxs-lookup"><span data-stu-id="ea858-228">**Figure 2**: SQL Compare Lists the Differences Between the Development and Production Databases ([Click to view full-size image](strategies-for-database-development-and-deployment-cs/_static/image6.jpg))</span></span>


<span data-ttu-id="ea858-229">Comparação do SQL divide os objetos de banco de dados em grupos, rapidamente mostrando a você quais objetos existem em ambos os bancos de dados, mas são diferente, que existem objetos em um banco de dados, mas não a outra e quais objetos são idênticos.</span><span class="sxs-lookup"><span data-stu-id="ea858-229">SQL Compare breaks down the database objects into groups, quickly showing you what objects exist in both databases but are different, which objects exist in one database but not the other, and which objects are identical.</span></span> <span data-ttu-id="ea858-230">Como você pode ver, há dois objetos que existem em ambos os bancos de dados, mas são diferentes: a `Authors` tabela, que tinha uma coluna adicionada, e o `Books` tabela, que tinha um removido.</span><span class="sxs-lookup"><span data-stu-id="ea858-230">As you can see, there are two objects that exist in both databases but are different: the `Authors` table, which had a column added, and the `Books` table, which had one removed.</span></span> <span data-ttu-id="ea858-231">Há um objeto que existe apenas no desenvolvimento banco de dados, ou seja, recém-criado `Ratings` tabela.</span><span class="sxs-lookup"><span data-stu-id="ea858-231">There is one object that exists only in the development database, namely the newly created `Ratings` table.</span></span> <span data-ttu-id="ea858-232">E há 117 objetos que são idênticos em ambos os bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-232">And there are 117 objects that are identical in both databases.</span></span>

<span data-ttu-id="ea858-233">Selecionando um objeto de banco de dados exibe a janela de diferenças de SQL, que mostra como esses objetos são diferentes.</span><span class="sxs-lookup"><span data-stu-id="ea858-233">Selecting a database object displays the SQL Differences window, which shows how these objects differ.</span></span> <span data-ttu-id="ea858-234">A janela de diferenças de SQL, exibida na parte inferior da Figura 2 destaca que o `Authors` tabela no banco de dados de desenvolvimento tem o `BirthDate` coluna, que não é encontrada no `Authors` tabela no banco de dados de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-234">The SQL Differences window, displayed at the bottom in Figure 2, highlights that the `Authors` table in the development database has the `BirthDate` column, which is not found in the `Authors` table on the production database.</span></span>

<span data-ttu-id="ea858-235">Depois de revisar as diferenças e selecionar quais objetos você deseja sincronizar, a próxima etapa é gerar comandos SQL necessários para atualizar o esquema de s de banco de dados de produção para coincidir com o banco de dados de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="ea858-235">After reviewing the differences and selecting which objects you want to synchronize, the next step is to generate the SQL commands needed to update the production database s schema to match the development database.</span></span> <span data-ttu-id="ea858-236">Isso é feito através do Assistente de sincronização.</span><span class="sxs-lookup"><span data-stu-id="ea858-236">This is accomplished through the Synchronization Wizard.</span></span> <span data-ttu-id="ea858-237">O Assistente de sincronização confirma que objetos para sincronizar e resume a ação de plano (consulte a Figura 3).</span><span class="sxs-lookup"><span data-stu-id="ea858-237">The Synchronization Wizard confirms what objects to synchronize and summarizes the action plan (see Figure 3).</span></span> <span data-ttu-id="ea858-238">Você pode sincronizar os bancos de dados imediatamente ou gerar um script com os comandos SQL que pode ser executado em seu tempo livre.</span><span class="sxs-lookup"><span data-stu-id="ea858-238">You can synchronize the databases immediately or generate a script with the SQL commands that can be run at your leisure.</span></span>


<span data-ttu-id="ea858-239">[![Use o Assistente de sincronização para sincronizar seus esquemas de bancos de dados](strategies-for-database-development-and-deployment-cs/_static/image8.jpg)](strategies-for-database-development-and-deployment-cs/_static/image7.jpg)</span><span class="sxs-lookup"><span data-stu-id="ea858-239">[![Use the Synchronization Wizard to Synchronize Your Databases Schemas](strategies-for-database-development-and-deployment-cs/_static/image8.jpg)](strategies-for-database-development-and-deployment-cs/_static/image7.jpg)</span></span>

<span data-ttu-id="ea858-240">**Figura 3**: Use o Assistente de sincronização para sincronizar seus esquemas de bancos de dados ([clique para exibir a imagem em tamanho normal](strategies-for-database-development-and-deployment-cs/_static/image9.jpg))</span><span class="sxs-lookup"><span data-stu-id="ea858-240">**Figure 3**: Use the Synchronization Wizard to Synchronize Your Databases Schemas ([Click to view full-size image](strategies-for-database-development-and-deployment-cs/_static/image9.jpg))</span></span>


<span data-ttu-id="ea858-241">Ferramentas de comparação do banco de dados, como Red Gate Software s SQL Compare tornar aplicando as alterações no esquema de banco de dados de desenvolvimento para o banco de dados de produção tão fácil quanto apontar e clicar.</span><span class="sxs-lookup"><span data-stu-id="ea858-241">Database comparison tools like Red Gate Software s SQL Compare make applying the changes to the development database schema to the production database as easy as point and click.</span></span>

> [!NOTE]
> <span data-ttu-id="ea858-242">Comparação do SQL compara e sincroniza dois bancos de dados *esquemas*.</span><span class="sxs-lookup"><span data-stu-id="ea858-242">SQL Compare compares and synchronizes two databases *schemas*.</span></span> <span data-ttu-id="ea858-243">Infelizmente, ele não comparar e sincronizar os dados nas tabelas de dois bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-243">Unfortunately, it does not compare and synchronize the data within two databases tables.</span></span> <span data-ttu-id="ea858-244">Red Gate Software oferece um produto chamado [ *SQL Data Compare* ](http://www.red-gate.com/products/SQL_Data_Compare/) que compara e sincroniza os dados entre dois bancos de dados, mas ele é um produto separado do SQL Compare e outro US $395 de custos.</span><span class="sxs-lookup"><span data-stu-id="ea858-244">Red Gate Software does offer a product named [*SQL Data Compare*](http://www.red-gate.com/products/SQL_Data_Compare/) that compares and synchronizes the data between two databases, but it is a separate product from SQL Compare and costs another $395.</span></span>


## <a name="taking-the-application-offline-during-deployment"></a><span data-ttu-id="ea858-245">Colocar o aplicativo Offline durante a implantação</span><span class="sxs-lookup"><span data-stu-id="ea858-245">Taking the Application Offline During Deployment</span></span>

<span data-ttu-id="ea858-246">Como podemos ve visto durante esses tutoriais, a implantação é um processo que envolve várias etapas: copiando as páginas do ASP.NET, páginas mestras, CSS arquivos, JavaScript arquivos, imagens e outro conteúdo necessário do ambiente de desenvolvimento para a produção ambiente; copiar as informações de configuração específicos ao ambiente de produção, se necessário; e aplicando as alterações ao modelo de dados desde a última implantação.</span><span class="sxs-lookup"><span data-stu-id="ea858-246">As we ve seen throughout these tutorials, deployment is a process that involves multiple steps: copying the ASP.NET pages, master pages, CSS files, JavaScript files, images, and other necessary content from the development environment to the production environment; copying up the production environment-specific configuration information, if needed; and applying the changes to the data model since the last deployment.</span></span> <span data-ttu-id="ea858-247">Dependendo do número de arquivos e a complexidade de suas alterações de banco de dados, essas etapas podem levar de alguns segundos a vários minutos para ser concluída.</span><span class="sxs-lookup"><span data-stu-id="ea858-247">Depending on the number of files and the complexity of your database changes, these steps can take anywhere from a few seconds to several minutes to complete.</span></span> <span data-ttu-id="ea858-248">Durante a janela de aplicativo da web está em fluxo e os usuários que visitam o site poderão enfrentar erros ou comportamento inesperado.</span><span class="sxs-lookup"><span data-stu-id="ea858-248">During this window the web application is in flux and users visiting the site may experience errors or unexpected behavior.</span></span>

<span data-ttu-id="ea858-249">Ao implantar um site da Web é melhor colocar o aplicativo web "offline" até que a implantação for concluída.</span><span class="sxs-lookup"><span data-stu-id="ea858-249">When deploying a website it is best to take the web application "offline" until deployment has completed.</span></span> <span data-ttu-id="ea858-250">Desconectar o aplicativo (e colocá-lo a fazer backup depois que o processo de implantação for concluída) é tão fácil como carregar um arquivo e, em seguida, excluí-lo.</span><span class="sxs-lookup"><span data-stu-id="ea858-250">Taking the application offline (and bringing it back up once the deployment process has finished) is as easy as uploading a file and then deleting it.</span></span> <span data-ttu-id="ea858-251">Começando com o ASP.NET 2.0, a simples presença de um arquivo chamado `app_offline.htm` em aplicativo s diretório raiz coloca todo o site "offline".</span><span class="sxs-lookup"><span data-stu-id="ea858-251">Starting with ASP.NET 2.0, the mere presence of a file named `app_offline.htm` in the application s root directory takes the entire website "offline."</span></span> <span data-ttu-id="ea858-252">Todas as solicitações para uma página ASP.NET no site em questão está respondida automaticamente com o conteúdo do `app_offline.htm` arquivo.</span><span class="sxs-lookup"><span data-stu-id="ea858-252">Any request to an ASP.NET page on that site is automatically responded with the contents of the `app_offline.htm` file.</span></span> <span data-ttu-id="ea858-253">Depois que esse arquivo é removido, o aplicativo fica online novamente.</span><span class="sxs-lookup"><span data-stu-id="ea858-253">Once that file is removed, the application comes back online.</span></span>

<span data-ttu-id="ea858-254">Colocar um aplicativo offline durante a implantação, em seguida, é tão simple quanto carregar um `app_offline.htm` arquivo para o ambiente de produção s diretório raiz de antes de começar o processo de implantação e, em seguida, excluí-lo (ou renomeá-lo para algo diferente de) uma vez implantação foi concluída.</span><span class="sxs-lookup"><span data-stu-id="ea858-254">Taking an application offline during deployment, then, is as simple as uploading an `app_offline.htm` file to the production environment s root directory prior to beginning the deployment process and then deleting it (or renaming it to something else) once deployment is complete.</span></span> <span data-ttu-id="ea858-255">Para obter mais informações sobre essa técnica, consulte o artigo de s de John Peterson, levando um [ *ASP.NET aplicativo Offline*](http://www.15seconds.com/issue/061207.htm).</span><span class="sxs-lookup"><span data-stu-id="ea858-255">For more information on this technique refer to John Peterson s article, Taking an [*ASP.NET Application Offline*](http://www.15seconds.com/issue/061207.htm).</span></span>

## <a name="summary"></a><span data-ttu-id="ea858-256">Resumo</span><span class="sxs-lookup"><span data-stu-id="ea858-256">Summary</span></span>

<span data-ttu-id="ea858-257">O principal desafio na implantação de um aplicativo orientado a dados gira em torno de implantar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-257">The main challenge in deploying a data-driven application centers around deploying the database.</span></span> <span data-ttu-id="ea858-258">Porque há duas versões do banco de dados - um no ambiente de desenvolvimento e outro no ambiente de produção esses esquemas de dois bancos de dados podem se tornar fora de sincronia conforme novos recursos são adicionados no desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="ea858-258">Because there are two versions of the database - one in the development environment and one in the production environment - these two databases schemas can become out of sync as new features are added in development.</span></span> <span data-ttu-id="ea858-259">Novidades mais, porque o banco de dados de produção como sendo populado com dados reais de usuários reais, não é possível substituir o banco de dados de produção com o banco de dados de desenvolvimento modificado como você pode fazer ao implantar os arquivos que compõem o aplicativo (as páginas ASP.NET, arquivos de imagem e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="ea858-259">What s more, because the production database as being populated with real data from real users, you cannot overwrite the production database with the modified development database like you can when deploying the files that make up the application (the ASP.NET pages, image files, and so forth).</span></span> <span data-ttu-id="ea858-260">Em vez disso, a implantação de um banco de dados envolve Implementando o conjunto exato das alterações feitas no banco de dados de desenvolvimento no banco de dados de produção desde a última implantação.</span><span class="sxs-lookup"><span data-stu-id="ea858-260">Instead, deploying a database entails implementing the precise set of changes made to the development database on the production database since the last deployment.</span></span>

<span data-ttu-id="ea858-261">Este tutorial analisamos três técnicas de manutenção e aplicação de um log de alterações do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-261">This tutorial looked at three techniques for maintaining and applying a log of database changes.</span></span> <span data-ttu-id="ea858-262">A abordagem mais simples é registrar as alterações em um texto.</span><span class="sxs-lookup"><span data-stu-id="ea858-262">The simplest approach is to record the changes in prose.</span></span> <span data-ttu-id="ea858-263">Embora essa tática torna a implementação dessas alterações do banco de dados de produção um processo manual, ele não requer conhecimento sobre os comandos SQL para Criando e alterando objetos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-263">While this tactic makes implementing these changes on the production database a manual process, it does not require knowledge of the SQL commands for creating and altering database objects.</span></span> <span data-ttu-id="ea858-264">Uma abordagem mais sofisticada e outro que é muito mais aceitável em projetos ou projetos maiores com vários desenvolvedores, é registrar as alterações como uma série de comandos SQL.</span><span class="sxs-lookup"><span data-stu-id="ea858-264">A more sophisticated approach, and one that is much more palatable in larger projects or projects with multiple developers, is to record the changes as a series of SQL commands.</span></span> <span data-ttu-id="ea858-265">Isso acelera consideravelmente muito distribuindo essas alterações para o banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="ea858-265">This greatly hastens rolling out these changes to the target database.</span></span> <span data-ttu-id="ea858-266">O melhor de ambas as abordagens pode ser obtido usando uma ferramenta de comparação do banco de dados, como s Red Gate Software comparação do SQL.</span><span class="sxs-lookup"><span data-stu-id="ea858-266">The best of both approaches can be achieved by using a database comparison tool, such as Red Gate Software s SQL Compare.</span></span>

<span data-ttu-id="ea858-267">Esse tutorial conclui nosso foco sobre como implantar um aplicativo controlado por dados.</span><span class="sxs-lookup"><span data-stu-id="ea858-267">This tutorial concludes our focus on deploying a data-driven application.</span></span> <span data-ttu-id="ea858-268">O próximo conjunto de tutoriais examina como responder a erros no ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="ea858-268">The next set of tutorials looks at how to respond to errors in the production environment.</span></span> <span data-ttu-id="ea858-269">Vamos examinar como exibir uma página de erro amigável em vez disso, em vez da tela amarela de morte.</span><span class="sxs-lookup"><span data-stu-id="ea858-269">We'll look at how to display a friendly error page rather instead of the Yellow Screen of Death.</span></span> <span data-ttu-id="ea858-270">E veremos como registrar em log os detalhes do erro s e como alertar você quando esses erros ocorrem.</span><span class="sxs-lookup"><span data-stu-id="ea858-270">And we'll see how to log the error s details and how to alert you when such errors occur.</span></span>

<span data-ttu-id="ea858-271">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="ea858-271">Happy Programming!</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ea858-272">[Anterior](configuring-a-website-that-uses-application-services-cs.md)
> [Próximo](displaying-a-custom-error-page-cs.md)</span><span class="sxs-lookup"><span data-stu-id="ea858-272">[Previous](configuring-a-website-that-uses-application-services-cs.md)
[Next](displaying-a-custom-error-page-cs.md)</span></span>
