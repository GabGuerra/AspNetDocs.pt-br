---
uid: web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-web-services
title: Noções básicas sobre serviços Web do ASP.NET AJAX | Microsoft Docs
author: scottcate
description: Serviços Web são parte integrante do .NET framework que fornecem uma solução de plataforma cruzada para a troca de dados entre sistemas distribuídos. Embora o Web...
ms.author: riande
ms.date: 03/28/2008
ms.assetid: 3332d6e7-e2e1-4144-b805-e71d51e7e415
msc.legacyurl: /web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-web-services
msc.type: authoredcontent
ms.openlocfilehash: e576e11d63f940f1683ed26d217ff255a31b007c
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59388407"
---
# <a name="understanding-aspnet-ajax-web-services"></a><span data-ttu-id="c37f0-104">Noções básicas sobre os serviços Web do AJAX ASP.NET</span><span class="sxs-lookup"><span data-stu-id="c37f0-104">Understanding ASP.NET AJAX Web Services</span></span>

<span data-ttu-id="c37f0-105">por [Scott Cate](https://github.com/scottcate)</span><span class="sxs-lookup"><span data-stu-id="c37f0-105">by [Scott Cate](https://github.com/scottcate)</span></span>

[<span data-ttu-id="c37f0-106">Baixar PDF</span><span class="sxs-lookup"><span data-stu-id="c37f0-106">Download PDF</span></span>](http://download.microsoft.com/download/C/1/9/C19A3451-1D14-477C-B703-54EF22E197EE/AJAX_tutorial05_Web_Services_with_MS_Ajax_cs.pdf)

> <span data-ttu-id="c37f0-107">Serviços Web são parte integrante do .NET framework que fornecem uma solução de plataforma cruzada para a troca de dados entre sistemas distribuídos.</span><span class="sxs-lookup"><span data-stu-id="c37f0-107">Web Services are an integral part of the .NET framework that provide a cross-platform solution for exchanging data between distributed systems.</span></span> <span data-ttu-id="c37f0-108">Embora os serviços da Web normalmente são usados para permitir que diferentes sistemas operacionais, modelos de objeto e linguagens de programação para enviar e receber dados, eles também podem ser usados para injetar dados em uma página ASP.NET AJAX ou enviar dados de uma página para um sistema back-end dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-108">Although Web Services are normally used to allow different operating systems, object models and programming languages to send and receive data, they can also be used to dynamically inject data into an ASP.NET AJAX page or send data from a page to a back-end system.</span></span> <span data-ttu-id="c37f0-109">Tudo isso pode ser feito sem recorrer para operações de postback.</span><span class="sxs-lookup"><span data-stu-id="c37f0-109">All of this can be done without resorting to postback operations.</span></span>


## <a name="calling-web-services-with-aspnet-ajax"></a><span data-ttu-id="c37f0-110">Chamando serviços Web com AJAX ASP.NET</span><span class="sxs-lookup"><span data-stu-id="c37f0-110">Calling Web Services with ASP.NET AJAX</span></span>

<span data-ttu-id="c37f0-111">Dan Wahlin</span><span class="sxs-lookup"><span data-stu-id="c37f0-111">Dan Wahlin</span></span>

<span data-ttu-id="c37f0-112">Serviços Web são parte integrante do .NET framework que fornecem uma solução de plataforma cruzada para a troca de dados entre sistemas distribuídos.</span><span class="sxs-lookup"><span data-stu-id="c37f0-112">Web Services are an integral part of the .NET framework that provide a cross-platform solution for exchanging data between distributed systems.</span></span> <span data-ttu-id="c37f0-113">Embora os serviços da Web normalmente são usados para permitir que diferentes sistemas operacionais, modelos de objeto e linguagens de programação para enviar e receber dados, eles também podem ser usados para injetar dados em uma página ASP.NET AJAX ou enviar dados de uma página para um sistema back-end dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-113">Although Web Services are normally used to allow different operating systems, object models and programming languages to send and receive data, they can also be used to dynamically inject data into an ASP.NET AJAX page or send data from a page to a back-end system.</span></span> <span data-ttu-id="c37f0-114">Tudo isso pode ser feito sem recorrer para operações de postback.</span><span class="sxs-lookup"><span data-stu-id="c37f0-114">All of this can be done without resorting to postback operations.</span></span>

<span data-ttu-id="c37f0-115">Enquanto o controle UpdatePanel do AJAX ASP.NET fornece uma maneira simples de AJAX habilitar qualquer página do ASP.NET, pode haver ocasiões em que você precisa acessar dinamicamente os dados no servidor sem usar um UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="c37f0-115">While the ASP.NET AJAX UpdatePanel control provides a simple way to AJAX enable any ASP.NET page, there may be times when you need to dynamically access data on the server without using an UpdatePanel.</span></span> <span data-ttu-id="c37f0-116">Neste artigo, você verá como fazer isso criando e consumindo serviços Web em páginas ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="c37f0-116">In this article you'll see how to accomplish this by creating and consuming Web Services within ASP.NET AJAX pages.</span></span>

<span data-ttu-id="c37f0-117">Este artigo se concentra na funcionalidade disponível em extensões do AJAX do ASP.NET core, bem como um controle de serviço da Web habilitado no ASP.NET AJAX Toolkit chamado o AutoCompleteExtender.</span><span class="sxs-lookup"><span data-stu-id="c37f0-117">This article will focus on functionality available in the core ASP.NET AJAX Extensions as well as a Web Service enabled control in the ASP.NET AJAX Toolkit called the AutoCompleteExtender.</span></span> <span data-ttu-id="c37f0-118">Os tópicos abordados incluem a definição de serviços de Web habilitados para AJAX, criando proxies de cliente e chamar os serviços Web com JavaScript.</span><span class="sxs-lookup"><span data-stu-id="c37f0-118">Topics covered include defining AJAX-enabled Web Services, creating client proxies and calling Web Services with JavaScript.</span></span> <span data-ttu-id="c37f0-119">Você também verá como as chamadas de serviço da Web podem ser feitas diretamente para os métodos de página ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="c37f0-119">You'll also see how Web Service calls can be made directly to ASP.NET page methods.</span></span>

## <a name="web-services-configuration"></a><span data-ttu-id="c37f0-120">Configuração de serviços da Web</span><span class="sxs-lookup"><span data-stu-id="c37f0-120">Web Services Configuration</span></span>

<span data-ttu-id="c37f0-121">Quando um novo projeto de Site da Web é criado com o Visual Studio 2008, o arquivo Web. config tem um número de novas adições que pode não ser familiar aos usuários de versões anteriores do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c37f0-121">When a new Web Site project is created with Visual Studio 2008, the web.config file has a number of new additions that may be unfamiliar to users of previous versions of Visual Studio.</span></span> <span data-ttu-id="c37f0-122">Algumas dessas modificações mapeiam o prefixo "asp" para controles do ASP.NET AJAX para que possam ser usados nas páginas enquanto outros definem HttpHandlers e HttpModules necessários.</span><span class="sxs-lookup"><span data-stu-id="c37f0-122">Some of these modifications map the "asp" prefix to ASP.NET AJAX controls so they can be used in pages while others define required HttpHandlers and HttpModules.</span></span> <span data-ttu-id="c37f0-123">A listagem 1 mostra as modificações feitas a `<httpHandlers>` elemento no Web. config que afeta as chamadas de serviço Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-123">Listing 1 shows modifications made to the `<httpHandlers>` element in web.config that affects Web Service calls.</span></span> <span data-ttu-id="c37f0-124">O padrão de que HttpHandler é usado para processar chamadas de. asmx é removido e substituído por uma classe ScriptHandlerFactory localizada no assembly Extensions.</span><span class="sxs-lookup"><span data-stu-id="c37f0-124">The default HttpHandler used to process .asmx calls is removed and replaced with a ScriptHandlerFactory class located in the System.Web.Extensions.dll assembly.</span></span> <span data-ttu-id="c37f0-125">Extensions contém toda a funcionalidade de núcleo usada pelo ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="c37f0-125">System.Web.Extensions.dll contains all of the core functionality used by ASP.NET AJAX.</span></span>

<span data-ttu-id="c37f0-126">**Listagem 1. Configuração do manipulador do ASP.NET AJAX Web Service**</span><span class="sxs-lookup"><span data-stu-id="c37f0-126">**Listing 1. ASP.NET AJAX Web Service Handler Configuration**</span></span>

[!code-xml[Main](understanding-asp-net-ajax-web-services/samples/sample1.xml)]

<span data-ttu-id="c37f0-127">Essa substituição HttpHandler é feita para permitir que o objeto notação JSON (JavaScript) chamadas sejam feitas de páginas ASP.NET AJAX para serviços Web do .NET usando um proxy de serviço Web de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="c37f0-127">This HttpHandler replacement is made in order to allow JavaScript Object Notation (JSON) calls to be made from ASP.NET AJAX pages to .NET Web Services using a JavaScript Web Service proxy.</span></span> <span data-ttu-id="c37f0-128">ASP.NET AJAX envia as mensagens JSON para serviços Web em vez das chamadas simples (SOAP Object Access Protocol) padrão normalmente associadas aos serviços da Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-128">ASP.NET AJAX sends JSON messages to Web Services as opposed to the standard Simple Object Access Protocol (SOAP) calls typically associated with Web Services.</span></span> <span data-ttu-id="c37f0-129">Isso resulta na solicitação menor e mensagens de resposta geral.</span><span class="sxs-lookup"><span data-stu-id="c37f0-129">This results in smaller request and response messages overall.</span></span> <span data-ttu-id="c37f0-130">Ele também permite processamento mais eficiente do lado do cliente de dados, pois a biblioteca JavaScript do AJAX ASP.NET é otimizada para trabalhar com objetos JSON.</span><span class="sxs-lookup"><span data-stu-id="c37f0-130">It also allows for more efficient client-side processing of data since the ASP.NET AJAX JavaScript library is optimized to work with JSON objects.</span></span> <span data-ttu-id="c37f0-131">Listagem 2 e listagem 3 mostra exemplos de mensagens de solicitação e resposta do serviço Web serializados em formato JSON.</span><span class="sxs-lookup"><span data-stu-id="c37f0-131">Listing 2 and Listing 3 show examples of Web Service request and response messages serialized to JSON format.</span></span> <span data-ttu-id="c37f0-132">A mensagem de solicitação mostrada na listagem 2 passa um parâmetro de país com um valor de "Bélgica", enquanto a mensagem de resposta na listagem 3 passa uma matriz de objetos Customer e suas propriedades associadas.</span><span class="sxs-lookup"><span data-stu-id="c37f0-132">The request message shown in Listing 2 passes a country parameter with a value of "Belgium" while the response message in Listing 3 passes an array of Customer objects and their associated properties.</span></span>

<span data-ttu-id="c37f0-133">**Listagem 2. Mensagem de solicitação de serviço Web serializada para JSON**</span><span class="sxs-lookup"><span data-stu-id="c37f0-133">**Listing 2. Web Service Request Message Serialized to JSON**</span></span>

[!code-json[Main](understanding-asp-net-ajax-web-services/samples/sample2.json)]

> <span data-ttu-id="c37f0-134">*> [!NOTE] o nome da operação é definido como parte da URL para o serviço web. Além disso, mensagens de solicitação não são sempre enviadas via JSON. Serviços Web podem utilizar o atributo ScriptMethod com o parâmetro UseHttpGet definido como true, o que faz com que os parâmetros a serem passados por meio de um os parâmetros de cadeia de caracteres de consulta.*</span><span class="sxs-lookup"><span data-stu-id="c37f0-134">*> [!NOTE] the operation name is defined as part of the URL to the web service; additionally, request messages are not always submitted via JSON. Web Services can utilize the ScriptMethod attribute with the UseHttpGet parameter set to true, which causes parameters to be passed via a the query string parameters.*</span></span>


<span data-ttu-id="c37f0-135">**Listagem 3. Mensagem de resposta do serviço Web serializada para JSON**</span><span class="sxs-lookup"><span data-stu-id="c37f0-135">**Listing 3. Web Service Response Message Serialized to JSON**</span></span>

[!code-json[Main](understanding-asp-net-ajax-web-services/samples/sample3.json)]

<span data-ttu-id="c37f0-136">Na próxima seção, você verá como criar serviços da Web capaz de lidar com mensagens de solicitação JSON e responder com tipos complexos e simples.</span><span class="sxs-lookup"><span data-stu-id="c37f0-136">In the next section you'll see how to create Web Services capable of handling JSON request messages and responding with both simple and complex types.</span></span>

## <a name="creating-ajax-enabled-web-services"></a><span data-ttu-id="c37f0-137">Criar serviços Web habilitados para AJAX</span><span class="sxs-lookup"><span data-stu-id="c37f0-137">Creating AJAX-Enabled Web Services</span></span>

<span data-ttu-id="c37f0-138">A estrutura ASP.NET AJAX fornece várias maneiras diferentes para chamar serviços Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-138">The ASP.NET AJAX framework provides several different ways to call Web Services.</span></span> <span data-ttu-id="c37f0-139">Você pode usar o controle AutoCompleteExtender (disponível no ASP.NET AJAX Toolkit) ou JavaScript.</span><span class="sxs-lookup"><span data-stu-id="c37f0-139">You can use the AutoCompleteExtender control (available in the ASP.NET AJAX Toolkit) or JavaScript.</span></span> <span data-ttu-id="c37f0-140">No entanto, antes de chamar um serviço você precisa habilitar AJAX-lo para que ele pode ser chamado pelo código de script de cliente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-140">However, before calling a service you have to AJAX-enable it so that it can be called by client-script code.</span></span>

<span data-ttu-id="c37f0-141">Se você for novo no ASP.NET Web Services, você encontrará ele simples de criar e habilitar AJAX serviços.</span><span class="sxs-lookup"><span data-stu-id="c37f0-141">Whether or not you're new to ASP.NET Web Services, you'll find it straightforward to create and AJAX-enable services.</span></span> <span data-ttu-id="c37f0-142">O .NET framework tem suporte para a criação de serviços Web do ASP.NET desde seu lançamento inicial em 2002 e o ASP.NET AJAX Extensions oferecem funcionalidade adicional do AJAX que aproveita a conjunto de recursos padrão do .NET framework.</span><span class="sxs-lookup"><span data-stu-id="c37f0-142">The .NET framework has supported the creation of ASP.NET Web Services since its initial release in 2002 and the ASP.NET AJAX Extensions provide additional AJAX functionality that builds upon the .NET framework's default set of features.</span></span> <span data-ttu-id="c37f0-143">2008 Beta 2 do Visual Studio .NET tem suporte interno para a criação de arquivos do serviço Web. asmx e automaticamente o código associado ao lado de classes é derivada da classe WebService.</span><span class="sxs-lookup"><span data-stu-id="c37f0-143">Visual Studio .NET 2008 Beta 2 has built-in support for creating .asmx Web Service files and automatically derives associated code beside classes from the System.Web.Services.WebService class.</span></span> <span data-ttu-id="c37f0-144">Conforme você adiciona métodos na classe, você deve aplicar o atributo WebMethod para que eles sejam chamados pelos consumidores de serviço Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-144">As you add methods into the class you must apply the WebMethod attribute in order for them to be called by Web Service consumers.</span></span>

<span data-ttu-id="c37f0-145">Listagem 4 mostra um exemplo de como aplicar o atributo WebMethod para um método chamado GetCustomersByCountry().</span><span class="sxs-lookup"><span data-stu-id="c37f0-145">Listing 4 shows an example of applying the WebMethod attribute to a method named GetCustomersByCountry().</span></span>

<span data-ttu-id="c37f0-146">**Listagem 4. Usando o atributo WebMethod em um serviço Web**</span><span class="sxs-lookup"><span data-stu-id="c37f0-146">**Listing 4. Using the WebMethod Attribute in a Web Service**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample4.cs)]

<span data-ttu-id="c37f0-147">O método GetCustomersByCountry() aceita um parâmetro de país e retorna matriz de objetos de um cliente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-147">The GetCustomersByCountry() method accepts a country parameter and returns a Customer object array.</span></span> <span data-ttu-id="c37f0-148">O valor de país passado para o método é encaminhado para uma classe de camada de negócios que por sua vez chama uma classe da camada de dados para recuperar os dados do banco de dados, preencha as propriedades do objeto cliente com dados e retornar a matriz.</span><span class="sxs-lookup"><span data-stu-id="c37f0-148">The country value passed into the method is forwarded to a business layer class which in turn calls a data layer class to retrieve the data from the database, fill the Customer object properties with data and return the array.</span></span>

## <a name="using-the-scriptservice-attribute"></a><span data-ttu-id="c37f0-149">Usando o atributo ScriptService</span><span class="sxs-lookup"><span data-stu-id="c37f0-149">Using the ScriptService Attribute</span></span>

<span data-ttu-id="c37f0-150">Ao adicionar o WebMethod atributo permite que o método GetCustomersByCountry() a ser chamado por clientes que enviam mensagens SOAP padrão para o serviço Web, ela não permite chamadas JSON para ser feita a partir de aplicativos do ASP.NET AJAX fora da caixa.</span><span class="sxs-lookup"><span data-stu-id="c37f0-150">While adding the WebMethod attribute allows the GetCustomersByCountry() method to be called by clients that send standard SOAP messages to the Web Service, it doesn't allow JSON calls to be made from ASP.NET AJAX applications out of the box.</span></span> <span data-ttu-id="c37f0-151">Para permitir chamadas JSON ser feito com que você precisa aplicar a extensão ASP.NET AJAX `ScriptService` atributo à classe de serviço da Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-151">To allow JSON calls to be made you have to apply the ASP.NET AJAX Extension's `ScriptService` attribute to the Web Service class.</span></span> <span data-ttu-id="c37f0-152">Isso permite que um serviço Web para enviar mensagens de resposta formatadas usando JSON e script do lado do cliente chamar um serviço por meio do envio de mensagens JSON.</span><span class="sxs-lookup"><span data-stu-id="c37f0-152">This enables a Web Service to send response messages formatted using JSON and allows client-side script to call a service by sending JSON messages.</span></span>

<span data-ttu-id="c37f0-153">Listagem 5 mostra um exemplo de aplicar o atributo ScriptService para uma classe de serviço Web denominada CustomersService.</span><span class="sxs-lookup"><span data-stu-id="c37f0-153">Listing 5 shows an example of applying the ScriptService attribute to a Web Service class named CustomersService.</span></span>

<span data-ttu-id="c37f0-154">**Listagem 5. Usando o atributo ScriptService para habilitar um serviço Web com AJAX**</span><span class="sxs-lookup"><span data-stu-id="c37f0-154">**Listing 5. Using the ScriptService Attribute to AJAX-enable a Web Service**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample5.cs)]

<span data-ttu-id="c37f0-155">O atributo ScriptService atua como um marcador que indica que ele pode ser chamado do código de script do AJAX.</span><span class="sxs-lookup"><span data-stu-id="c37f0-155">The ScriptService attribute acts as a marker that indicates it can be called from AJAX script code.</span></span> <span data-ttu-id="c37f0-156">Na verdade, ele não manipula todas as tarefas de serialização ou desserialização de JSON que ocorrem nos bastidores.</span><span class="sxs-lookup"><span data-stu-id="c37f0-156">It doesn't actually handle any of the JSON serialization or deserialization tasks that occur behind the scenes.</span></span> <span data-ttu-id="c37f0-157">O ScriptHandlerFactory (configurado no Web. config) e outras classes relacionadas para fazer a maior parte do processamento de JSON.</span><span class="sxs-lookup"><span data-stu-id="c37f0-157">The ScriptHandlerFactory (configured in web.config) and other related classes do the bulk of JSON processing.</span></span>

## <a name="using-the-scriptmethod-attribute"></a><span data-ttu-id="c37f0-158">Usando o atributo ScriptMethod</span><span class="sxs-lookup"><span data-stu-id="c37f0-158">Using the ScriptMethod Attribute</span></span>

<span data-ttu-id="c37f0-159">O atributo ScriptService é o único atributo do ASP.NET AJAX que deve ser definida em um serviço da Web .NET para que ele a ser usado pelas páginas do ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="c37f0-159">The ScriptService attribute is the only ASP.NET AJAX attribute that has to be defined in a .NET Web Service in order for it to be used by ASP.NET AJAX pages.</span></span> <span data-ttu-id="c37f0-160">No entanto, outro atributo chamado ScriptMethod também pode ser aplicado diretamente para os métodos da Web em um serviço.</span><span class="sxs-lookup"><span data-stu-id="c37f0-160">However, another attribute named ScriptMethod can also be applied directly to Web Methods in a service.</span></span> <span data-ttu-id="c37f0-161">ScriptMethod define três propriedades, incluindo `UseHttpGet`, `ResponseFormat` e `XmlSerializeString`.</span><span class="sxs-lookup"><span data-stu-id="c37f0-161">ScriptMethod defines three properties including `UseHttpGet`, `ResponseFormat` and `XmlSerializeString`.</span></span> <span data-ttu-id="c37f0-162">Alterando os valores dessas propriedades pode ser útil em casos em que o tipo de solicitação aceito por um método da Web precisa ser alterado para GET, quando um método da Web precisa retornar dados XML brutos na forma de um `XmlDocument` ou `XmlElement` objeto ou quando os dados retornados de um  serviço sempre deve ser serializado como XML, em vez de JSON.</span><span class="sxs-lookup"><span data-stu-id="c37f0-162">Changing the values of these properties can be useful in cases where the type of request accepted by a Web Method needs to be changed to GET, when a Web Method needs to return raw XML data in the form of an `XmlDocument` or `XmlElement` object or when data returned from a service should always be serialized as XML instead of JSON.</span></span>

<span data-ttu-id="c37f0-163">A propriedade pode ser usada quando um método da Web deve aceitar de UseHttpGet obter solicitações em vez de solicitações POST.</span><span class="sxs-lookup"><span data-stu-id="c37f0-163">The UseHttpGet property can be used when a Web Method should accept GET requests as opposed to POST requests.</span></span> <span data-ttu-id="c37f0-164">As solicitações são enviadas usando uma URL com parâmetros de entrada do método Web convertido em parâmetros de QueryString.</span><span class="sxs-lookup"><span data-stu-id="c37f0-164">Requests are sent using a URL with Web Method input parameters converted to QueryString parameters.</span></span> <span data-ttu-id="c37f0-165">O UseHttpGet propriedade assume false como padrão e só deverá ser definido como `true` quando as operações são conhecidas ser seguras e quando os dados confidenciais não são passados para um serviço Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-165">The UseHttpGet property defaults to false and should only be set to `true` when operations are known to be safe and when sensitive data is not passed to a Web Service.</span></span> <span data-ttu-id="c37f0-166">Listagem 6 mostra um exemplo de como usar o atributo ScriptMethod com a propriedade UseHttpGet.</span><span class="sxs-lookup"><span data-stu-id="c37f0-166">Listing 6 shows an example of using the ScriptMethod attribute with the UseHttpGet property.</span></span>

<span data-ttu-id="c37f0-167">**Listagem 6. Usando o atributo ScriptMethod com a propriedade UseHttpGet.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-167">**Listing 6. Using the ScriptMethod attribute with the UseHttpGet property.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample6.cs)]

<span data-ttu-id="c37f0-168">Um exemplo dos cabeçalhos enviados quando o método de Web HttpGetEcho mostrado na listagem 6 é chamado são mostrado a seguir:</span><span class="sxs-lookup"><span data-stu-id="c37f0-168">An example of the headers sent when the HttpGetEcho Web Method shown in Listing 6 is called are shown next:</span></span>

`GET /CustomerViewer/DemoService.asmx/HttpGetEcho?input=%22Input Value%22 HTTP/1.1`

<span data-ttu-id="c37f0-169">Além de permitir que os métodos da Web aceitar solicitações HTTP GET, o atributo ScriptMethod também pode ser usado quando respostas XML precisam ser retornado de um serviço em vez de JSON.</span><span class="sxs-lookup"><span data-stu-id="c37f0-169">In addition to allowing Web Methods to accept HTTP GET requests, the ScriptMethod attribute can also be used when XML responses need to be returned from a service rather than JSON.</span></span> <span data-ttu-id="c37f0-170">Por exemplo, um serviço Web pode recuperar um RSS feed de um site remoto e retorná-lo como um objeto XmlDocument ou XmlElement.</span><span class="sxs-lookup"><span data-stu-id="c37f0-170">For example, a Web Service may retrieve an RSS feed from a remote site and return it as an XmlDocument or XmlElement object.</span></span> <span data-ttu-id="c37f0-171">Processamento do XML dados, em seguida, podem ocorrer no cliente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-171">Processing of the XML data can then occur on the client.</span></span>

<span data-ttu-id="c37f0-172">Listagem 7 mostra um exemplo de como usar a propriedade ResponseFormat para especificar que os dados XML devem ser retornados de um método Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-172">Listing 7 shows an example of using the ResponseFormat property to specify that XML data should be returned from a Web Method.</span></span>

<span data-ttu-id="c37f0-173">**Listagem 7. Usando o atributo ScriptMethod com a propriedade ResponseFormat.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-173">**Listing 7. Using the ScriptMethod attribute with the ResponseFormat property.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample7.cs)]

<span data-ttu-id="c37f0-174">A propriedade ResponseFormat também pode ser usada junto com a propriedade XmlSerializeString.</span><span class="sxs-lookup"><span data-stu-id="c37f0-174">The ResponseFormat property can also be used along with the XmlSerializeString property.</span></span> <span data-ttu-id="c37f0-175">A propriedade XmlSerializeString tem um valor padrão de false, que significa que todos retornam tipos exceto cadeias de caracteres retornadas de um método Web são serializados como XML quando o `ResponseFormat` estiver definida como `ResponseFormat.Xml`.</span><span class="sxs-lookup"><span data-stu-id="c37f0-175">The XmlSerializeString property has a default value of false which means that all return types except strings returned from a Web Method are serialized as XML when the `ResponseFormat` property is set to `ResponseFormat.Xml`.</span></span> <span data-ttu-id="c37f0-176">Quando `XmlSerializeString` é definido como `true`, todos os tipos retornados de um método Web são serializados como XML, incluindo tipos de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="c37f0-176">When `XmlSerializeString` is set to `true`, all types returned from a Web Method are serialized as XML including string types.</span></span> <span data-ttu-id="c37f0-177">Se a propriedade ResponseFormat tem um valor de `ResponseFormat.Json` a propriedade XmlSerializeString será ignorada.</span><span class="sxs-lookup"><span data-stu-id="c37f0-177">If the ResponseFormat property has a value of `ResponseFormat.Json` the XmlSerializeString property is ignored.</span></span>

<span data-ttu-id="c37f0-178">Listagem 8 mostra um exemplo de como usar a propriedade XmlSerializeString para forçar as cadeias de caracteres a ser serializado como XML.</span><span class="sxs-lookup"><span data-stu-id="c37f0-178">Listing 8 shows an example of using the XmlSerializeString property to force strings to be serialized as XML.</span></span>

<span data-ttu-id="c37f0-179">**Listagem 8. Usando o atributo ScriptMethod com a propriedade XmlSerializeString**</span><span class="sxs-lookup"><span data-stu-id="c37f0-179">**Listing 8. Using the ScriptMethod attribute with the XmlSerializeString property**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample8.cs)]

<span data-ttu-id="c37f0-180">O valor retornado da chamada do método de Web GetXmlString mostrado na listagem 8 é mostrado a seguir:</span><span class="sxs-lookup"><span data-stu-id="c37f0-180">The value returned from calling the GetXmlString Web Method shown in Listing 8 is shown next:</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample9.cs)]

<span data-ttu-id="c37f0-181">Embora o formato JSON padrão minimiza o tamanho total de mensagens de solicitação e resposta e é consumido mais prontamente pelos clientes do ASP.NET AJAX de uma maneira de navegadores, as propriedades ResponseFormat e XmlSerializeString podem ser utilizada ao cliente aplicativos como o Internet Explorer 5 ou superior esperam que os dados XML a ser retornado de um método Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-181">Although the default JSON format minimizes the overall size of request and response messages and is more readily consumed by ASP.NET AJAX clients in a cross-browser manner, the ResponseFormat and XmlSerializeString properties can be utilized when client applications such as Internet Explorer 5 or higher expect XML data to be returned from a Web Method.</span></span>

## <a name="working-with-complex-types"></a><span data-ttu-id="c37f0-182">Trabalhando com tipos complexos</span><span class="sxs-lookup"><span data-stu-id="c37f0-182">Working with Complex Types</span></span>

<span data-ttu-id="c37f0-183">Listagem 5 mostramos um exemplo de retornar um tipo complexo de chamada de cliente de um serviço Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-183">Listing 5 showed an example of returning a complex type named Customer from a Web Service.</span></span> <span data-ttu-id="c37f0-184">A classe Customer define vários tipos diferentes de simples internamente como propriedades como FirstName e LastName.</span><span class="sxs-lookup"><span data-stu-id="c37f0-184">The Customer class defines several different simple types internally as properties such as FirstName and LastName.</span></span> <span data-ttu-id="c37f0-185">Tipos complexos usado como um parâmetro de entrada ou tipo de retorno em um método de Web habilitados para AJAX automaticamente são serializados em JSON antes de serem enviados para o lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-185">Complex types used as an input parameter or return type on an AJAX-enabled Web Method are automatically serialized into JSON before being sent to the client-side.</span></span> <span data-ttu-id="c37f0-186">No entanto, os tipos complexos aninhados (aqueles definidos internamente dentro de outro tipo) não ficam disponíveis para o cliente como objetos autônomos por padrão.</span><span class="sxs-lookup"><span data-stu-id="c37f0-186">However, nested complex types (those defined internally within another type) are not made available to the client as standalone objects by default.</span></span>

<span data-ttu-id="c37f0-187">Em casos onde um tipo complexo aninhado usado por um serviço Web também deverá ser usado em uma página de cliente, o atributo GenerateScriptType do AJAX ASP.NET pode ser adicionado ao serviço Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-187">In cases where a nested complex type used by a Web Service must also be used in a client page, the ASP.NET AJAX GenerateScriptType attribute can be added to the Web Service.</span></span> <span data-ttu-id="c37f0-188">Por exemplo, a classe de CustomerDetails mostrada na listagem 9 contém propriedades de endereço e sexo que ***representam tipos complexos aninhados.***</span><span class="sxs-lookup"><span data-stu-id="c37f0-188">For example, the CustomerDetails class shown in Listing 9 contains Address and Gender properties which ***represent nested complex types.***</span></span>

<span data-ttu-id="c37f0-189">**Listagem 9. A classe CustomerDetails mostrada aqui contém dois tipos de complexos aninhados.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-189">**Listing 9. The CustomerDetails class shown here contains two nested complex types.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample10.cs)]

<span data-ttu-id="c37f0-190">Os objetos de endereço e sexo definidos dentro da classe CustomerDetails mostrada na listagem 9 não serão disponibilizados automaticamente para uso no lado do cliente por meio de JavaScript, pois são tipos aninhados (endereço é uma classe e sexo é uma enumeração).</span><span class="sxs-lookup"><span data-stu-id="c37f0-190">The Address and Gender objects defined within the CustomerDetails class shown in Listing 9 won't automatically be made available for use on the client-side via JavaScript since they are nested types (Address is a class and Gender is an enumeration).</span></span> <span data-ttu-id="c37f0-191">Em situações em que um tipo aninhado usado dentro de um serviço Web deve estar disponível no lado do cliente, o atributo GenerateScriptType mencionado anteriormente pode ser usado (consulte a listagem 10).</span><span class="sxs-lookup"><span data-stu-id="c37f0-191">In situations where a nested type used within a Web Service must be available on the client-side, the GenerateScriptType attribute mentioned earlier can be used (see Listing 10).</span></span> <span data-ttu-id="c37f0-192">Esse atributo pode ser adicionado várias vezes em casos em que os diferentes tipos complexos aninhados são retornados de um serviço.</span><span class="sxs-lookup"><span data-stu-id="c37f0-192">This attribute can be added multiple times in cases where different nested complex types are returned from a service.</span></span> <span data-ttu-id="c37f0-193">Ele pode ser aplicado diretamente à classe de serviço Web ou acima de métodos de Web específicos.</span><span class="sxs-lookup"><span data-stu-id="c37f0-193">It can be applied directly to the Web Service class or above specific Web Methods.</span></span>

<span data-ttu-id="c37f0-194">**Listagem 10. Usando o atributo GenerateScriptService para definir tipos aninhados que devem estar disponíveis para o cliente.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-194">**Listing 10. Using the GenerateScriptService attribute to define nested types that should be available to the client.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample11.cs)]

<span data-ttu-id="c37f0-195">Aplicando o `GenerateScriptType` atributo para os tipos de serviço Web, o endereço e o gênero será automaticamente disponibilizado para uso pelo código do ASP.NET AJAX JavaScript do lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-195">By applying the `GenerateScriptType` attribute to the Web Service, the Address and Gender types will automatically be made available for use by client-side ASP.NET AJAX JavaScript code.</span></span> <span data-ttu-id="c37f0-196">Um exemplo de JavaScript que é automaticamente gerada e enviada ao cliente, adicionando o atributo GenerateScriptType em um serviço Web é mostrado na listagem 11.</span><span class="sxs-lookup"><span data-stu-id="c37f0-196">An example of the JavaScript that is automatically generated and sent to the client by adding the GenerateScriptType attribute on a Web Service is shown in Listing 11.</span></span> <span data-ttu-id="c37f0-197">Você verá como usar tipos complexos aninhados posteriormente neste artigo.</span><span class="sxs-lookup"><span data-stu-id="c37f0-197">You'll see how to use nested complex types later in the article.</span></span>

<span data-ttu-id="c37f0-198">**Listagem 11. Tipos complexos aninhados disponibilizados para uma página ASP.NET AJAX.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-198">**Listing 11. Nested complex types made available to an ASP.NET AJAX page.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample12.cs)]

<span data-ttu-id="c37f0-199">Agora que você já viu como criar serviços Web e torná-los acessíveis para páginas ASP.NET AJAX, vamos dar uma olhada em como criar e usar os proxies JavaScript para que os dados podem ser recuperados ou enviados aos serviços da Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-199">Now that you've seen how to create Web Services and make them accessible to ASP.NET AJAX pages, let's take a look at how to create and use JavaScript proxies so that data can be retrieved or sent to Web Services.</span></span>

## <a name="creating-javascript-proxies"></a><span data-ttu-id="c37f0-200">Criação de Proxies JavaScript</span><span class="sxs-lookup"><span data-stu-id="c37f0-200">Creating JavaScript Proxies</span></span>

<span data-ttu-id="c37f0-201">Chamar um serviço da Web padrão (.NET ou outra plataforma) normalmente envolve a criação de um objeto proxy que protege você contra as complexidades de envio de mensagens de solicitação e resposta SOAP.</span><span class="sxs-lookup"><span data-stu-id="c37f0-201">Calling a standard Web Service (.NET or another platform) typically involves creating a proxy object that shields you from the complexities of sending SOAP request and response messages.</span></span> <span data-ttu-id="c37f0-202">Com chamadas de Web Service do ASP.NET AJAX, os proxies JavaScript podem ser criados e usados para chamar facilmente serviços sem se preocupar sobre a serialização e desserialização de mensagens JSON.</span><span class="sxs-lookup"><span data-stu-id="c37f0-202">With ASP.NET AJAX Web Service calls, JavaScript proxies can be created and used to easily call services without worrying about serializing and deserializing JSON messages.</span></span> <span data-ttu-id="c37f0-203">Proxies JavaScript podem ser gerados automaticamente, usando o controle ScriptManager do AJAX ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="c37f0-203">JavaScript proxies can be automatically generated by using the ASP.NET AJAX ScriptManager control.</span></span>

<span data-ttu-id="c37f0-204">Criando um proxy JavaScript que pode chamar serviços da Web é realizado usando a propriedade de serviços do ScriptManager.</span><span class="sxs-lookup"><span data-stu-id="c37f0-204">Creating a JavaScript proxy that can call Web Services is accomplished by using the ScriptManager's Services property.</span></span> <span data-ttu-id="c37f0-205">Essa propriedade permite que você defina um ou mais serviços que uma página ASP.NET AJAX pode chamar de forma assíncrona para enviar ou receber dados sem a necessidade de operações de postback.</span><span class="sxs-lookup"><span data-stu-id="c37f0-205">This property allows you to define one or more services that an ASP.NET AJAX page can call asynchronously to send or receive data without requiring postback operations.</span></span> <span data-ttu-id="c37f0-206">Definir um serviço usando o ASP.NET AJAX `ServiceReference` controle e atribuindo a URL do serviço Web para o controle `Path` propriedade.</span><span class="sxs-lookup"><span data-stu-id="c37f0-206">You define a service by using the ASP.NET AJAX `ServiceReference` control and assigning the Web Service URL to the control's `Path` property.</span></span> <span data-ttu-id="c37f0-207">Listagem 12 mostra um exemplo de como fazer referência a um serviço chamado CustomersService.asmx.</span><span class="sxs-lookup"><span data-stu-id="c37f0-207">Listing 12 shows an example of referencing a service named CustomersService.asmx.</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample13.aspx)]

<span data-ttu-id="c37f0-208">**Listagem 12. Definindo um serviço Web usado em uma página ASP.NET AJAX.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-208">**Listing 12. Defining a Web Service used in an ASP.NET AJAX page.**</span></span>

<span data-ttu-id="c37f0-209">Adicionando uma referência para o CustomersService.asmx por meio do controle ScriptManager faz com que um proxy JavaScript sejam gerados dinamicamente e referenciado pela página.</span><span class="sxs-lookup"><span data-stu-id="c37f0-209">Adding a reference to the CustomersService.asmx through the ScriptManager control causes a JavaScript proxy to be dynamically generated and referenced by the page.</span></span> <span data-ttu-id="c37f0-210">O proxy é inserido usando o &lt;script&gt; marcar e carregados dinamicamente chamando o arquivo CustomersService.asmx e acrescentando /js ao final dele.</span><span class="sxs-lookup"><span data-stu-id="c37f0-210">The proxy is embedded by using the &lt;script&gt; tag and dynamically loaded by calling the CustomersService.asmx file and appending /js to the end of it.</span></span> <span data-ttu-id="c37f0-211">O exemplo a seguir mostra como o proxy JavaScript é inserido na página quando a depuração está desabilitada no Web. config:</span><span class="sxs-lookup"><span data-stu-id="c37f0-211">The following example shows how the JavaScript proxy is embedded in the page when debugging is disabled in web.config:</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample14.html)]

> <span data-ttu-id="c37f0-212">*> [!NOTE] Se você gostaria de ver o código de proxy JavaScript real que é gerado você pode digitar a URL para o serviço de Web do .NET desejada na caixa de endereço do Internet Explorer e acrescentar /js ao final dele.*</span><span class="sxs-lookup"><span data-stu-id="c37f0-212">*> [!NOTE] If you'd like to see the actual JavaScript proxy code that is generated you can type the URL to the desired .NET Web Service into Internet Explorer's address box and append /js to the end of it.*</span></span>


<span data-ttu-id="c37f0-213">Se a depuração está habilitada no Web. config, que uma versão de depuração de proxy JavaScript será inserida na página como mostrado a seguir:</span><span class="sxs-lookup"><span data-stu-id="c37f0-213">If debugging is enabled in web.config a debug version of the JavaScript proxy will be embedded in the page as shown next:</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample15.html)]

<span data-ttu-id="c37f0-214">O proxy JavaScript criado pelo ScriptManager também podem ser inserido diretamente na página, em vez de referenciados usando o &lt;script&gt; atributo src da marca.</span><span class="sxs-lookup"><span data-stu-id="c37f0-214">The JavaScript proxy created by the ScriptManager can also be embedded directly into the page rather than referenced using the &lt;script&gt; tag's src attribute.</span></span> <span data-ttu-id="c37f0-215">Isso pode ser feito definindo a propriedade do InlineScript ServiceReference do controle como true (o padrão é false).</span><span class="sxs-lookup"><span data-stu-id="c37f0-215">This can be done by setting the ServiceReference control's InlineScript property to true (the default is false).</span></span> <span data-ttu-id="c37f0-216">Isso pode ser útil quando um proxy não é compartilhado por várias páginas e você gostaria de reduzir o número de chamadas de rede feitas no servidor.</span><span class="sxs-lookup"><span data-stu-id="c37f0-216">This can be useful when a proxy isn't shared across multiple pages and when you'd like to reduce the number of network calls made to the server.</span></span> <span data-ttu-id="c37f0-217">Quando InlineScript é definido como true, o script de proxy não ser armazenado em cache pelo navegador para que o valor padrão de false é recomendado em casos em que o proxy é usado por várias páginas em um aplicativo ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="c37f0-217">When InlineScript is set to true the proxy script won't be cached by the browser so the default value of false is recommended in cases where the proxy is used by multiple pages in an ASP.NET AJAX application.</span></span> <span data-ttu-id="c37f0-218">Um exemplo de como usar a propriedade InlineScript é mostrado a seguir:</span><span class="sxs-lookup"><span data-stu-id="c37f0-218">An example of using the InlineScript property is shown next:</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample16.aspx)]

## <a name="using-javascript-proxies"></a><span data-ttu-id="c37f0-219">Uso de Proxies de JavaScript</span><span class="sxs-lookup"><span data-stu-id="c37f0-219">Using JavaScript Proxies</span></span>

<span data-ttu-id="c37f0-220">Depois que um serviço Web é referenciado por uma página ASP.NET AJAX usando o controle do ScriptManager, pode ser feita uma chamada para o serviço Web e os dados retornados podem ser tratados usando funções de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="c37f0-220">Once a Web Service is referenced by an ASP.NET AJAX page using the ScriptManager control, a call can be made to the Web Service and the returned data can be handled using callback functions.</span></span> <span data-ttu-id="c37f0-221">Um serviço Web é chamado referenciando seu namespace (se houver), nome de classe e nome do método Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-221">A Web Service is called by referencing its namespace (if one exists), class name and Web Method name.</span></span> <span data-ttu-id="c37f0-222">Todos os parâmetros passados para o serviço Web podem ser definidos juntamente com uma função de retorno de chamada que manipula os dados retornados.</span><span class="sxs-lookup"><span data-stu-id="c37f0-222">Any parameters passed to the Web Service can be defined along with a callback function that handles the returned data.</span></span>

<span data-ttu-id="c37f0-223">Um exemplo de como usar um proxy JavaScript para chamar um método de Web chamado GetCustomersByCountry() é mostrado na listagem 13.</span><span class="sxs-lookup"><span data-stu-id="c37f0-223">An example of using a JavaScript proxy to call a Web Method named GetCustomersByCountry() is shown in Listing 13.</span></span> <span data-ttu-id="c37f0-224">A função GetCustomersByCountry() é chamada quando um usuário final clica em um botão na página.</span><span class="sxs-lookup"><span data-stu-id="c37f0-224">The GetCustomersByCountry() function is called when an end user clicks a button on the page.</span></span>

<span data-ttu-id="c37f0-225">**Listagem 13. Chamando um serviço Web com um proxy JavaScript.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-225">**Listing 13. Calling a Web Service with a JavaScript proxy.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample17.js)]

<span data-ttu-id="c37f0-226">Essa chamada faz referência ao namespace de InterfaceTraining, CustomersService classe e método de Web GetCustomersByCountry definidos no serviço.</span><span class="sxs-lookup"><span data-stu-id="c37f0-226">This call references the InterfaceTraining namespace, CustomersService class and GetCustomersByCountry Web Method defined in the service.</span></span> <span data-ttu-id="c37f0-227">Ele passa um valor de país obtido de uma caixa de texto, bem como uma função de retorno de chamada chamado OnWSRequestComplete que deve ser invocado quando a chamada de serviço da Web assíncrona retorna.</span><span class="sxs-lookup"><span data-stu-id="c37f0-227">It passes a country value obtained from a textbox as well as a callback function named OnWSRequestComplete that should be invoked when the asynchronous Web Service call returns.</span></span> <span data-ttu-id="c37f0-228">OnWSRequestComplete manipula a matriz de objetos de cliente retornados do serviço e converte-os em uma tabela que é exibida na página.</span><span class="sxs-lookup"><span data-stu-id="c37f0-228">OnWSRequestComplete handles the array of Customer objects returned from the service and converts them into a table that is displayed in the page.</span></span> <span data-ttu-id="c37f0-229">A saída gerada a partir da chamada é mostrada na Figura 1.</span><span class="sxs-lookup"><span data-stu-id="c37f0-229">The output generated from the call is shown in Figure 1.</span></span>


<span data-ttu-id="c37f0-230">[![Associando dados obtidos ao realizar uma chamada AJAX assíncrona para um serviço Web.](understanding-asp-net-ajax-web-services/_static/image2.png)](understanding-asp-net-ajax-web-services/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c37f0-230">[![Binding data obtained by making an asynchronous AJAX call to a Web Service.](understanding-asp-net-ajax-web-services/_static/image2.png)](understanding-asp-net-ajax-web-services/_static/image1.png)</span></span>

<span data-ttu-id="c37f0-231">**Figura 1**: Associando dados obtidos ao realizar uma chamada AJAX assíncrona para um serviço Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-231">**Figure 1**: Binding data obtained by making an asynchronous AJAX call to a Web Service.</span></span>  <span data-ttu-id="c37f0-232">([Clique para exibir a imagem em tamanho normal](understanding-asp-net-ajax-web-services/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c37f0-232">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image3.png))</span></span>


<span data-ttu-id="c37f0-233">Proxies JavaScript também podem fazer chamadas unidirecionais para serviços da Web em casos em que um método da Web deve ser chamado, mas o proxy não deve esperar por uma resposta.</span><span class="sxs-lookup"><span data-stu-id="c37f0-233">JavaScript proxies can also make one-way calls to Web Services in cases where a Web Method should be called but the proxy shouldn't wait for a response.</span></span> <span data-ttu-id="c37f0-234">Por exemplo, você talvez queira chamar um Web Service para iniciar um processo como um fluxo de trabalho, mas não esperar por um valor de retorno do serviço.</span><span class="sxs-lookup"><span data-stu-id="c37f0-234">For example, you may want to call a Web Service to start a process such as a work-flow but not wait for a return value from the service.</span></span> <span data-ttu-id="c37f0-235">Em casos em que uma chamada unidirecional precisa ser feita a um serviço, a função de retorno de chamada, mostrada na listagem 13 simplesmente pode ser omitida.</span><span class="sxs-lookup"><span data-stu-id="c37f0-235">In cases where a one-way call needs to be made to a service, the callback function shown in Listing 13 can simply be omitted.</span></span> <span data-ttu-id="c37f0-236">Como nenhuma função de retorno de chamada é definida não esperará o objeto de proxy para o serviço Web retornar dados.</span><span class="sxs-lookup"><span data-stu-id="c37f0-236">Since no callback function is defined the proxy object will not wait for the Web Service to return data.</span></span>

## <a name="handling-errors"></a><span data-ttu-id="c37f0-237">Manipulando erros</span><span class="sxs-lookup"><span data-stu-id="c37f0-237">Handling Errors</span></span>

<span data-ttu-id="c37f0-238">Retornos de chamada assíncronos para serviços Web podem encontrar diferentes tipos de erros, como a rede está inoperante, o serviço Web está indisponível ou uma exceção que está sendo retornado.</span><span class="sxs-lookup"><span data-stu-id="c37f0-238">Asynchronous callbacks to Web Services can encounter different types of errors such as the network being down, the Web Service being unavailable or an exception being returned.</span></span> <span data-ttu-id="c37f0-239">Felizmente, os objetos de proxy JavaScript gerados pelo ScriptManager permitem que vários retornos de chamada a ser definido para tratar erros e falhas, além do retorno de chamada bem-sucedido mostrado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-239">Fortunately, JavaScript proxy objects generated by the ScriptManager allow multiple callbacks to be defined to handle errors and failures in addition to the success callback shown earlier.</span></span> <span data-ttu-id="c37f0-240">Uma função de retorno de chamada de erro pode ser definida imediatamente após a função de retorno de chamada padrão na chamada para o método da Web, conforme mostrado na listagem 14.</span><span class="sxs-lookup"><span data-stu-id="c37f0-240">An error callback function can be defined immediately after the standard callback function in the call to the Web Method as shown in Listing 14.</span></span>

<span data-ttu-id="c37f0-241">**Listagem 14. Definir uma função de retorno de chamada do erro e exibição de erros.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-241">**Listing 14. Defining an error callback function and displaying errors.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample18.js)]

<span data-ttu-id="c37f0-242">Todos os erros que ocorrem quando o serviço Web é chamado disparará a função de retorno de chamada de OnWSRequestFailed() para ser chamado que aceita um objeto que representa o erro como um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="c37f0-242">Any errors that occur when the Web Service is called will trigger the OnWSRequestFailed() callback function to be called which accepts an object representing the error as a parameter.</span></span> <span data-ttu-id="c37f0-243">O objeto de erro expõe várias funções diferentes para determinar a causa do erro, bem como se a chamada atingiu o tempo limite. Listagem 14 mostra um exemplo de como usar as funções de erro diferentes e a Figura 2 mostra um exemplo da saída gerada pelas funções.</span><span class="sxs-lookup"><span data-stu-id="c37f0-243">The error object exposes several different functions to determine the cause of the error as well as whether or not the call timed out. Listing 14 shows an example of using the different error functions and Figure 2 shows an example of the output generated by the functions.</span></span>


<span data-ttu-id="c37f0-244">[![Saída gerada ao chamar funções de erro do ASP.NET AJAX.](understanding-asp-net-ajax-web-services/_static/image5.png)](understanding-asp-net-ajax-web-services/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c37f0-244">[![Output generated by calling ASP.NET AJAX error functions.](understanding-asp-net-ajax-web-services/_static/image5.png)](understanding-asp-net-ajax-web-services/_static/image4.png)</span></span>

<span data-ttu-id="c37f0-245">**Figura 2**: Saída gerada ao chamar funções de erro do ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="c37f0-245">**Figure 2**: Output generated by calling ASP.NET AJAX error functions.</span></span>  <span data-ttu-id="c37f0-246">([Clique para exibir a imagem em tamanho normal](understanding-asp-net-ajax-web-services/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c37f0-246">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image6.png))</span></span>


## <a name="handling-xml-data-returned-from-a-web-service"></a><span data-ttu-id="c37f0-247">Manipulação de dados XML retornados de um serviço Web</span><span class="sxs-lookup"><span data-stu-id="c37f0-247">Handling XML Data Returned from a Web Service</span></span>

<span data-ttu-id="c37f0-248">Vimos anteriormente como um método Web poderia retornar dados XML brutos, usando o atributo ScriptMethod, juntamente com sua propriedade ResponseFormat.</span><span class="sxs-lookup"><span data-stu-id="c37f0-248">Earlier you saw how a Web Method could return raw XML data by using the ScriptMethod attribute along with its ResponseFormat property.</span></span> <span data-ttu-id="c37f0-249">Quando ResponseFormat for definido como ResponseFormat.Xml, os dados retornados do serviço Web são serializados como XML em vez de JSON.</span><span class="sxs-lookup"><span data-stu-id="c37f0-249">When ResponseFormat is set to ResponseFormat.Xml, data returned from the Web Service is serialized as XML rather than JSON.</span></span> <span data-ttu-id="c37f0-250">Isso pode ser útil quando os dados XML devem ser passados diretamente para o cliente para o processamento usando JavaScript ou XSLT.</span><span class="sxs-lookup"><span data-stu-id="c37f0-250">This can be useful when XML data needs to be passed directly to the client for processing using JavaScript or XSLT.</span></span> <span data-ttu-id="c37f0-251">No momento, o Internet Explorer 5 ou superior fornece o melhor modelo de objeto do lado do cliente para análise e filtragem de dados XML devido a seu suporte interno para o MSXML.</span><span class="sxs-lookup"><span data-stu-id="c37f0-251">At the current time, Internet Explorer 5 or higher provides the best client-side object model for parsing and filtering XML data due to its built-in support for MSXML.</span></span>

<span data-ttu-id="c37f0-252">Recuperando dados XML de um serviço Web não é diferente de recuperar outros tipos de dados.</span><span class="sxs-lookup"><span data-stu-id="c37f0-252">Retrieving XML data from a Web Service is no different than retrieving other data types.</span></span> <span data-ttu-id="c37f0-253">Iniciar, invocando o proxy do JavaScript para definir uma função de retorno de chamada e chamar a função apropriada.</span><span class="sxs-lookup"><span data-stu-id="c37f0-253">Start by invoking the JavaScript proxy to call the appropriate function and define a callback function.</span></span> <span data-ttu-id="c37f0-254">Depois que a chamada retorna você pode processar os dados na função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="c37f0-254">Once the call returns you can then process the data in the callback function.</span></span>

<span data-ttu-id="c37f0-255">Listagem 15 mostra um exemplo de como chamar um método de Web chamado GetRssFeed() que retorna um objeto XmlElement.</span><span class="sxs-lookup"><span data-stu-id="c37f0-255">Listing 15 shows an example of calling a Web Method named GetRssFeed() that returns an XmlElement object.</span></span> <span data-ttu-id="c37f0-256">GetRssFeed() aceita um único parâmetro que representa a URL para o RSS feed para recuperar.</span><span class="sxs-lookup"><span data-stu-id="c37f0-256">GetRssFeed() accepts a single parameter representing the URL for the RSS feed to retrieve.</span></span>

<span data-ttu-id="c37f0-257">**Listagem 15. Trabalhando com dados XML retornados de um serviço Web.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-257">**Listing 15. Working with XML data returned from a Web Service.**</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample19.html)]

<span data-ttu-id="c37f0-258">Este exemplo passa uma URL para um RSS feed e processa os dados XML retornados na função OnWSRequestComplete().</span><span class="sxs-lookup"><span data-stu-id="c37f0-258">This example passes a URL to an RSS feed and processes the returned XML data in the OnWSRequestComplete() function.</span></span> <span data-ttu-id="c37f0-259">OnWSRequestComplete() primeiro verifica para ver se o navegador é saber se o analisador MSXML está disponível, o Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="c37f0-259">OnWSRequestComplete() first checks to see if the browser is Internet Explorer to know whether or not the MSXML parser is available.</span></span> <span data-ttu-id="c37f0-260">Se for, uma instrução XPath é usada para localizar todos os &lt;item&gt; marcas dentro do RSS feed.</span><span class="sxs-lookup"><span data-stu-id="c37f0-260">If it is, an XPath statement is used to locate all &lt;item&gt; tags within the RSS feed.</span></span> <span data-ttu-id="c37f0-261">Cada item, em seguida, fazer a iteração com e os respectivos &lt;title&gt; e &lt;link&gt; marcas são localizadas e processadas para exibir dados de cada item.</span><span class="sxs-lookup"><span data-stu-id="c37f0-261">Each item is then iterated through and the associated &lt;title&gt; and &lt;link&gt; tags are located and processed to display each item's data.</span></span> <span data-ttu-id="c37f0-262">Figura 3 mostra um exemplo da saída gerada de fazer um ASP.NET AJAX chamar por meio de um proxy JavaScript para o método de Web GetRssFeed().</span><span class="sxs-lookup"><span data-stu-id="c37f0-262">Figure 3 shows an example of the output generated from making an ASP.NET AJAX call through a JavaScript proxy to the GetRssFeed() Web Method.</span></span>

## <a name="handling-complex-types"></a><span data-ttu-id="c37f0-263">Tratamento de tipos complexos</span><span class="sxs-lookup"><span data-stu-id="c37f0-263">Handling Complex Types</span></span>

<span data-ttu-id="c37f0-264">Tipos complexos aceito ou retornado por um serviço Web são automaticamente expostos por meio de um proxy JavaScript.</span><span class="sxs-lookup"><span data-stu-id="c37f0-264">Complex types accepted or returned by a Web Service are automatically exposed through a JavaScript proxy.</span></span> <span data-ttu-id="c37f0-265">No entanto, os tipos complexos aninhados não são diretamente acessíveis no lado do cliente, a menos que o atributo GenerateScriptType é aplicado ao serviço, conforme discutido anteriormente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-265">However, nested complex types are not directly accessible on the client-side unless the GenerateScriptType attribute is applied to the service as discussed earlier.</span></span> <span data-ttu-id="c37f0-266">Por que você deseja usar um tipo complexo aninhado no lado do cliente?</span><span class="sxs-lookup"><span data-stu-id="c37f0-266">Why would you want to use a nested complex type on the client-side?</span></span>

<span data-ttu-id="c37f0-267">Para responder essa pergunta, suponha que uma página ASP.NET AJAX exibe os dados do cliente e permite que os usuários finais atualizar o endereço do cliente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-267">To answer this question, assume that an ASP.NET AJAX page displays customer data and allows end users to update a customer's address.</span></span> <span data-ttu-id="c37f0-268">Se o serviço da Web Especifica que o tipo de endereço (um tipo complexo definido dentro de uma classe CustomerDetails) possa ser enviado ao cliente, em seguida, o processo de atualização pode ser dividido em funções separadas melhor para reutilização de códigos.</span><span class="sxs-lookup"><span data-stu-id="c37f0-268">If the Web Service specifies that the Address type (a complex type defined within a CustomerDetails class) can be sent to the client then the update process can be divided into separate functions for better code re-use.</span></span>


<span data-ttu-id="c37f0-269">[![Saída de criação de chamar um serviço Web que retorna dados RSS.](understanding-asp-net-ajax-web-services/_static/image8.png)](understanding-asp-net-ajax-web-services/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c37f0-269">[![Output creating from calling a Web Service that returns RSS data.](understanding-asp-net-ajax-web-services/_static/image8.png)](understanding-asp-net-ajax-web-services/_static/image7.png)</span></span>

<span data-ttu-id="c37f0-270">**Figura 3**: Saída de criação de chamar um serviço Web que retorna dados RSS.</span><span class="sxs-lookup"><span data-stu-id="c37f0-270">**Figure 3**: Output creating from calling a Web Service that returns RSS data.</span></span>  <span data-ttu-id="c37f0-271">([Clique para exibir a imagem em tamanho normal](understanding-asp-net-ajax-web-services/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c37f0-271">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image9.png))</span></span>


<span data-ttu-id="c37f0-272">Listagem 16 mostra um exemplo de código do lado do cliente que invoca um objeto de endereço definido em um namespace de modelo, preenche com dados atualizados e o atribui a propriedade de endereço de um objeto CustomerDetails.</span><span class="sxs-lookup"><span data-stu-id="c37f0-272">Listing 16 shows an example of client-side code that invokes an Address object defined in a Model namespace, fills it with updated data and assigns it to a CustomerDetails object's Address property.</span></span> <span data-ttu-id="c37f0-273">O objeto CustomerDetails é então passado para o serviço Web para processamento.</span><span class="sxs-lookup"><span data-stu-id="c37f0-273">The CustomerDetails object is then passed to the Web Service for processing.</span></span>

<span data-ttu-id="c37f0-274">**Listagem 16. Usando tipos complexos aninhados**</span><span class="sxs-lookup"><span data-stu-id="c37f0-274">**Listing 16. Using nested complex types**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample20.js)]

## <a name="creating-and-using-page-methods"></a><span data-ttu-id="c37f0-275">Criando e usando os métodos de página</span><span class="sxs-lookup"><span data-stu-id="c37f0-275">Creating and Using Page Methods</span></span>

<span data-ttu-id="c37f0-276">Serviços Web fornecem uma maneira excelente para expor serviços utilizáveis novamente a uma variedade de clientes, incluindo páginas ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="c37f0-276">Web Services provide an excellent way to expose re-useable services to a variety of clients including ASP.NET AJAX pages.</span></span> <span data-ttu-id="c37f0-277">No entanto, pode haver casos em que uma página precisa recuperar dados que já não usados ou compartilhados por outras páginas.</span><span class="sxs-lookup"><span data-stu-id="c37f0-277">However, there may be cases where a page needs to retrieve data that won't ever be used or shared by other pages.</span></span> <span data-ttu-id="c37f0-278">Nesse caso, tornar um arquivo. asmx para permitir que a página para acessar os dados pode parecer um exagero, pois o serviço é usado somente por uma única página.</span><span class="sxs-lookup"><span data-stu-id="c37f0-278">In this case, making an .asmx file to allow the page to access the data may seem like overkill since the service is only used by a single page.</span></span>

<span data-ttu-id="c37f0-279">ASP.NET AJAX fornece outro mecanismo para fazer chamadas de tipo de serviço Web sem criar arquivos. asmx de autônomo.</span><span class="sxs-lookup"><span data-stu-id="c37f0-279">ASP.NET AJAX provides another mechanism for making Web Service-like calls without creating standalone .asmx files.</span></span> <span data-ttu-id="c37f0-280">Isso é feito usando uma técnica conhecida como "métodos de página".</span><span class="sxs-lookup"><span data-stu-id="c37f0-280">This is done by using a technique referred to as "page methods".</span></span> <span data-ttu-id="c37f0-281">Métodos de página são métodos estáticos (compartilhado no VB.NET) inseridos diretamente em um arquivo de página ou ao lado do código que têm o atributo WebMethod aplicado a eles.</span><span class="sxs-lookup"><span data-stu-id="c37f0-281">Page methods are static (shared in VB.NET) methods embedded directly in a page or code-beside file that have the WebMethod attribute applied to them.</span></span> <span data-ttu-id="c37f0-282">Aplicando o atributo WebMethod eles podem ser chamados usando um objeto JavaScript especial chamado PageMethods que é criada dinamicamente em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="c37f0-282">By applying the WebMethod attribute they can be called using a special JavaScript object named PageMethods that gets dynamically created at runtime.</span></span> <span data-ttu-id="c37f0-283">O objeto PageMethods atua como um proxy que protege você contra o processo de serialização/desserialização JSON.</span><span class="sxs-lookup"><span data-stu-id="c37f0-283">The PageMethods object acts as a proxy that shields you from the JSON serialization/deserialization process.</span></span> <span data-ttu-id="c37f0-284">Observe que, para usar o objeto PageMethods você deve definir propriedade de EnablePageMethods do ScriptManager como true.</span><span class="sxs-lookup"><span data-stu-id="c37f0-284">Note that in order to use the PageMethods object you must set the ScriptManager's EnablePageMethods property to true.</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample21.aspx)]

<span data-ttu-id="c37f0-285">Listagem 17 mostra um exemplo de definição de dois métodos de página em uma classe do lado do código do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="c37f0-285">Listing 17 shows an example of defining two page methods in an ASP.NET code-beside class.</span></span> <span data-ttu-id="c37f0-286">Esses métodos recuperam dados de uma classe de camada de negócios localizada no aplicativo do\_pasta de código do site.</span><span class="sxs-lookup"><span data-stu-id="c37f0-286">These methods retrieve data from a business layer class located in the App\_Code folder of the Website.</span></span>

<span data-ttu-id="c37f0-287">**Listagem 17. Definindo os métodos de página.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-287">**Listing 17. Defining page methods.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample22.cs)]

<span data-ttu-id="c37f0-288">Quando o ScriptManager detecta a presença dos métodos Web na página, ele gera uma referência dinâmica para o objeto PageMethods mencionado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-288">When ScriptManager detects the presence of Web Methods in the page it generates a dynamic reference to the PageMethods object mentioned earlier.</span></span> <span data-ttu-id="c37f0-289">Chamando um método Web é realizado pela referência à classe PageMethods seguida do nome do método e quaisquer dados de parâmetro necessários que devem ser passados.</span><span class="sxs-lookup"><span data-stu-id="c37f0-289">Calling a Web Method is accomplished by referencing the PageMethods class followed by the name of the method and any necessary parameter data that should be passed.</span></span> <span data-ttu-id="c37f0-290">Listagem 18 mostra exemplos de como chamar os dois métodos de página mostrados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-290">Listing 18 shows examples of calling the two page methods shown earlier.</span></span>

<span data-ttu-id="c37f0-291">**Listagem 18. Chamando métodos de página com o objeto PageMethods JavaScript.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-291">**Listing 18. Calling page methods with the PageMethods JavaScript object.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample23.js)]

<span data-ttu-id="c37f0-292">Usando o objeto PageMethods é muito semelhante ao uso de um objeto de proxy do JavaScript.</span><span class="sxs-lookup"><span data-stu-id="c37f0-292">Using the PageMethods object is very similar to using a JavaScript proxy object.</span></span> <span data-ttu-id="c37f0-293">Você primeiro especificar todos os dados de parâmetro que devem ser passados para o método de página e, em seguida, definem a função de retorno de chamada que deve ser chamada quando a chamada assíncrona retorna.</span><span class="sxs-lookup"><span data-stu-id="c37f0-293">You first specify all of the parameter data that should be passed to the page method and then define the callback function that should be called when the asynchronous call returns.</span></span> <span data-ttu-id="c37f0-294">Também pode ser especificado um retorno de chamada de falha (consulte a listagem 14 para obter um exemplo de tratamento de falhas).</span><span class="sxs-lookup"><span data-stu-id="c37f0-294">A failure callback can also be specified (refer to Listing 14 for an example of handling failures).</span></span>

## <a name="the-autocompleteextender-and-the-aspnet-ajax-toolkit"></a><span data-ttu-id="c37f0-295">O AutoCompleteExtender e o Kit de ferramentas do ASP.NET AJAX</span><span class="sxs-lookup"><span data-stu-id="c37f0-295">The AutoCompleteExtender and the ASP.NET AJAX Toolkit</span></span>

<span data-ttu-id="c37f0-296">O Kit de ferramentas do ASP.NET AJAX (disponível no [ http://ajax.asp.net ](http://ajax.asp.net)) oferece vários controles que podem ser usados para acessar serviços Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-296">The ASP.NET AJAX Toolkit (available from [http://ajax.asp.net](http://ajax.asp.net)) offers several controls that can be used to access Web Services.</span></span> <span data-ttu-id="c37f0-297">Especificamente, o Kit de ferramentas contém um controle útil chamado `AutoCompleteExtender` que pode ser usado para chamar serviços Web e mostrar dados em páginas sem escrever qualquer código JavaScript em todos os.</span><span class="sxs-lookup"><span data-stu-id="c37f0-297">Specifically, the toolkit contains a useful control named `AutoCompleteExtender` that can be used to call Web Services and show data in pages without writing any JavaScript code at all.</span></span>

<span data-ttu-id="c37f0-298">O controle AutoCompleteExtender pode ser usado para estender a funcionalidade existente de uma caixa de texto e ajudam os usuários mais localizar facilmente os dados que estão procurando.</span><span class="sxs-lookup"><span data-stu-id="c37f0-298">The AutoCompleteExtender control can be used to extend existing functionality of a textbox and help users more easily locate data they're looking for.</span></span> <span data-ttu-id="c37f0-299">Como ele digita em uma caixa de texto o controle pode ser usado para consultar um serviço Web e mostra os resultados abaixo da caixa de texto dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-299">As they type into a textbox the control can be used to query a Web Service and shows results below the textbox dynamically.</span></span> <span data-ttu-id="c37f0-300">Figura 4 mostra um exemplo de como usar o controle AutoCompleteExtender para exibir as ids de cliente para um aplicativo de suporte.</span><span class="sxs-lookup"><span data-stu-id="c37f0-300">Figure 4 shows an example of using the AutoCompleteExtender control to display customer ids for a support application.</span></span> <span data-ttu-id="c37f0-301">Conforme o usuário digita caracteres diferentes na caixa de texto, os itens diferentes serão exibidos abaixo dele com base em suas entradas.</span><span class="sxs-lookup"><span data-stu-id="c37f0-301">As the user types different characters into the textbox, different items will be shown below it based upon their input.</span></span> <span data-ttu-id="c37f0-302">Os usuários podem selecionar a id do cliente desejado.</span><span class="sxs-lookup"><span data-stu-id="c37f0-302">Users can then select the desired customer id.</span></span>

<span data-ttu-id="c37f0-303">Usar o AutoCompleteExtender dentro de uma página ASP.NET AJAX exige que o assembly de AjaxControlToolkit ser adicionado à pasta de compartimento do site.</span><span class="sxs-lookup"><span data-stu-id="c37f0-303">Using the AutoCompleteExtender within an ASP.NET AJAX page requires that the AjaxControlToolkit.dll assembly be added to the Website's bin folder.</span></span> <span data-ttu-id="c37f0-304">Depois que o assembly do Kit de ferramentas tiver sido adicionado, você desejará fazer referência a ele em Web. config para que os controles que ele contém estão disponíveis para todas as páginas em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="c37f0-304">Once the toolkit assembly has been added, you'll want to reference it in web.config so that the controls it contains are available to all pages in an application.</span></span> <span data-ttu-id="c37f0-305">Isso pode ser feito adicionando a seguinte marca dentro do Web. config &lt;controles&gt; marca:</span><span class="sxs-lookup"><span data-stu-id="c37f0-305">This can be done by adding the following tag within web.config's &lt;controls&gt; tag:</span></span>

[!code-xml[Main](understanding-asp-net-ajax-web-services/samples/sample24.xml)]

<span data-ttu-id="c37f0-306">Em casos em que você só precisa usar o controle em uma página específica, você pode referenciá-la adicionando a diretiva de referência na parte superior de uma página, conforme mostrado a seguir em vez de atualizar Web. config:</span><span class="sxs-lookup"><span data-stu-id="c37f0-306">In cases where you only need to use the control in a specific page you can reference it by adding the Reference directive to the top of a page as shown next rather than updating web.config:</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample25.aspx)]


<span data-ttu-id="c37f0-307">[![Usando o controle AutoCompleteExtender.](understanding-asp-net-ajax-web-services/_static/image11.png)](understanding-asp-net-ajax-web-services/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c37f0-307">[![Using the AutoCompleteExtender control.](understanding-asp-net-ajax-web-services/_static/image11.png)](understanding-asp-net-ajax-web-services/_static/image10.png)</span></span>

<span data-ttu-id="c37f0-308">**Figura 4**: Usando o controle AutoCompleteExtender.</span><span class="sxs-lookup"><span data-stu-id="c37f0-308">**Figure 4**: Using the AutoCompleteExtender control.</span></span>  <span data-ttu-id="c37f0-309">([Clique para exibir a imagem em tamanho normal](understanding-asp-net-ajax-web-services/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c37f0-309">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image12.png))</span></span>


<span data-ttu-id="c37f0-310">Depois que o site foi configurado para usar o Kit de ferramentas do ASP.NET AJAX, um controle AutoCompleteExtender pode ser adicionado na página muito como você adicionaria um controle de servidor ASP.NET regular.</span><span class="sxs-lookup"><span data-stu-id="c37f0-310">Once the Website has been configured to use the ASP.NET AJAX Toolkit, an AutoCompleteExtender control can be added into the page much like you'd add a regular ASP.NET server control.</span></span> <span data-ttu-id="c37f0-311">Listagem 19 mostra um exemplo de como usar o controle para chamar um serviço Web.</span><span class="sxs-lookup"><span data-stu-id="c37f0-311">Listing 19 shows an example of using the control to call a Web Service.</span></span>

<span data-ttu-id="c37f0-312">**Listagem 19. Usando o controle AutoCompleteExtender de kit de ferramentas do ASP.NET AJAX.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-312">**Listing 19. Using the ASP.NET AJAX Toolkit AutoCompleteExtender control.**</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample26.aspx)]

<span data-ttu-id="c37f0-313">O AutoCompleteExtender tem várias propriedades diferentes, incluindo as propriedades padrão de ID e runat encontradas nos controles de servidor.</span><span class="sxs-lookup"><span data-stu-id="c37f0-313">The AutoCompleteExtender has several different properties including the standard ID and runat properties found on server controls.</span></span> <span data-ttu-id="c37f0-314">Além disso, ele permite que você defina quantos caracteres de um tipo de usuário final antes que o serviço Web é consultada para obter dados.</span><span class="sxs-lookup"><span data-stu-id="c37f0-314">In addition to these, it allows you to define how many characters an end user types before the Web Service is queried for data.</span></span> <span data-ttu-id="c37f0-315">A propriedade MinimumPrefixLength mostrada na listagem 19 faz com que o serviço a ser chamado sempre que um caractere é digitado na caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="c37f0-315">The MinimumPrefixLength property shown in Listing 19 causes the service to be called each time a character is typed into the textbox.</span></span> <span data-ttu-id="c37f0-316">Você vai querer ter cuidado para definir esse valor, pois cada vez que o usuário digita um caractere, o serviço Web será chamado para pesquisar valores que correspondem aos caracteres na caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="c37f0-316">You'll want to be careful setting this value since each time the user types a character the Web Service will be called to search for values that match the characters in the textbox.</span></span> <span data-ttu-id="c37f0-317">O serviço Web para chamar, bem como o método da Web de destino é definido usando as propriedades ServicePath e ServiceMethod respectivamente.</span><span class="sxs-lookup"><span data-stu-id="c37f0-317">The Web Service to call as well as the target Web Method are defined using the ServicePath and ServiceMethod properties respectively.</span></span> <span data-ttu-id="c37f0-318">Por fim, a propriedade TargetControlID identifica qual caixa de texto para vincular o controle AutoCompleteExtender.</span><span class="sxs-lookup"><span data-stu-id="c37f0-318">Finally, the TargetControlID property identifies which textbox to hook the AutoCompleteExtender control to.</span></span>

<span data-ttu-id="c37f0-319">O serviço Web que está sendo chamado deve ter o atributo ScriptService aplicado conforme discutido anteriormente e o método da Web de destino deve aceitar dois parâmetros nomeados prefixText e contagem.</span><span class="sxs-lookup"><span data-stu-id="c37f0-319">The Web Service being called must have the ScriptService attribute applied as discussed earlier and the target Web Method must accept two parameters named prefixText and count.</span></span> <span data-ttu-id="c37f0-320">O parâmetro prefixText representa os caracteres digitados pelo usuário final e o parâmetro de contagem que representa quantos itens devem para retornar (o padrão é 10).</span><span class="sxs-lookup"><span data-stu-id="c37f0-320">The prefixText parameter represents the characters typed by the end user and the count parameter represents how many items to return (the default is 10).</span></span> <span data-ttu-id="c37f0-321">Listagem 20 mostra um exemplo do método Web GetCustomerIDs chamado pelo controle AutoCompleteExtender mostrado anteriormente na listagem 19.</span><span class="sxs-lookup"><span data-stu-id="c37f0-321">Listing 20 shows an example of the GetCustomerIDs Web Method called by the AutoCompleteExtender control shown earlier in Listing 19.</span></span> <span data-ttu-id="c37f0-322">O método da Web chama um método de camada de negócios que por sua vez chama da camada de dados método que manipula a filtragem dos dados e retornar os resultados de correspondência.</span><span class="sxs-lookup"><span data-stu-id="c37f0-322">The Web Method calls a business layer method that in turn calls a data layer method that handles filtering the data and returning the matching results.</span></span> <span data-ttu-id="c37f0-323">O código para o método de camada de dados é mostrado na listagem 21.</span><span class="sxs-lookup"><span data-stu-id="c37f0-323">The code for the data layer method is shown in Listing 21.</span></span>

<span data-ttu-id="c37f0-324">**Listagem 20. Filtrando dados enviados do controle AutoCompleteExtender.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-324">**Listing 20. Filtering data sent from the AutoCompleteExtender control.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample27.cs)]

<span data-ttu-id="c37f0-325">**Listagem 21. Filtrando os resultados com base na entrada do usuário final.**</span><span class="sxs-lookup"><span data-stu-id="c37f0-325">**Listing 21. Filtering results based upon end user input.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample28.cs)]

## <a name="conclusion"></a><span data-ttu-id="c37f0-326">Conclusão</span><span class="sxs-lookup"><span data-stu-id="c37f0-326">Conclusion</span></span>

<span data-ttu-id="c37f0-327">ASP.NET AJAX fornece excelente suporte para chamar serviços da Web sem escrever uma grande quantidade de código JavaScript personalizado para manipular as mensagens de solicitação e resposta.</span><span class="sxs-lookup"><span data-stu-id="c37f0-327">ASP.NET AJAX provides excellent support for calling Web Services without writing a lot of custom JavaScript code to handle the request and response messages.</span></span> <span data-ttu-id="c37f0-328">Neste artigo, você viu como habilitar com AJAX .NET Web Services para habilitá-los para processar as mensagens JSON e como definir os proxies JavaScript usando o controle ScriptManager.</span><span class="sxs-lookup"><span data-stu-id="c37f0-328">In this article you've seen how to AJAX-enable .NET Web Services to enable them to process JSON messages and how to define JavaScript proxies using the ScriptManager control.</span></span> <span data-ttu-id="c37f0-329">Você também viu como o JavaScript proxies podem ser usados para chamar serviços Web, lidar com tipos complexos e simples e lidar com falhas.</span><span class="sxs-lookup"><span data-stu-id="c37f0-329">You've also seen how JavaScript proxies can be used to call Web Services, handle simple and complex types and deal with failures.</span></span> <span data-ttu-id="c37f0-330">Por fim, você viu como os métodos de página podem ser usados para simplificar o processo de criação e fazer chamadas de serviço Web e como o controle AutoCompleteExtender pode fornecer ajuda aos usuários finais enquanto digitam.</span><span class="sxs-lookup"><span data-stu-id="c37f0-330">Finally, you've seen how page methods can be used to simplify the process of creating and making Web Service calls and how the AutoCompleteExtender control can provide help to end users as they type.</span></span> <span data-ttu-id="c37f0-331">Embora o UpdatePanel disponível no ASP.NET AJAX certamente será o controle preferencial para muitos programadores AJAX devido à sua simplicidade, a saber como chamar serviços da Web por meio de proxies JavaScript pode ser útil em muitos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="c37f0-331">Although the UpdatePanel available in ASP.NET AJAX will certainly be the control of choice for many AJAX programmers due to its simplicity, knowing how to call Web Services through JavaScript proxies can be useful in many applications.</span></span>

## <a name="bio"></a><span data-ttu-id="c37f0-332">Bio</span><span class="sxs-lookup"><span data-stu-id="c37f0-332">Bio</span></span>

<span data-ttu-id="c37f0-333">Dan Wahlin (Microsoft Most Valuable Professional do ASP.NET e XML Web Services) é desenvolvimento instrutor e arquitetura consultor .NET no treinamento técnico de Interface ([http://www.interfacett.com](http://www.interfacett.com)).</span><span class="sxs-lookup"><span data-stu-id="c37f0-333">Dan Wahlin (Microsoft Most Valuable Professional for ASP.NET and XML Web Services) is a .NET development instructor and architecture consultant at Interface Technical Training ([http://www.interfacett.com](http://www.interfacett.com)).</span></span> <span data-ttu-id="c37f0-334">Dan fundou o XML para o site da Web de desenvolvedores do ASP.NET ([www.XMLforASP.NET](http://www.XMLforASP.NET)), está na agência do palestrante da INETA e dá palestras em várias conferências.</span><span class="sxs-lookup"><span data-stu-id="c37f0-334">Dan founded the XML for ASP.NET Developers Web site ([www.XMLforASP.NET](http://www.XMLforASP.NET)), is on the INETA Speaker's Bureau and speaks at several conferences.</span></span> <span data-ttu-id="c37f0-335">Dan é co-autor Professional Windows DNA (Wrox), ASP.NET: Dicas, tutoriais e código (Sams), soluções do ASP.NET 1.1 Insider, Professional ASP.NET 2.0 AJAX (Wrox), Hacks do ASP.NET 2.0 MVP e XML criado para desenvolvedores do ASP.NET (Sams).</span><span class="sxs-lookup"><span data-stu-id="c37f0-335">Dan co-authored Professional Windows DNA (Wrox), ASP.NET: Tips, Tutorials and Code (Sams), ASP.NET 1.1 Insider Solutions, Professional ASP.NET 2.0 AJAX (Wrox), ASP.NET 2.0 MVP Hacks and authored XML for ASP.NET Developers (Sams).</span></span> <span data-ttu-id="c37f0-336">Quando ele não está escrevendo código, artigos ou livros, Dan gosta de escrever e gravando música e reprodução de Golfe e o basquete com sua esposa e filhos.</span><span class="sxs-lookup"><span data-stu-id="c37f0-336">When he's not writing code, articles or books, Dan enjoys writing and recording music and playing golf and basketball with his wife and kids.</span></span>

<span data-ttu-id="c37f0-337">Scott Cate tem trabalhado com tecnologias Web Microsoft desde 1997 e é o presidente da myKB.com ([www.myKB.com](http://www.myKB.com)) onde ele é especialista na escrita de ASP.NET com base em aplicativos com foco em soluções de Software da Base de dados de Conhecimento.</span><span class="sxs-lookup"><span data-stu-id="c37f0-337">Scott Cate has been working with Microsoft Web technologies since 1997 and is the President of myKB.com ([www.myKB.com](http://www.myKB.com)) where he specializes in writing ASP.NET based applications focused on Knowledge Base Software solutions.</span></span> <span data-ttu-id="c37f0-338">Scott pode ser contatado através do email [ scott.cate@myKB.com ](mailto:scott.cate@myKB.com) ou em seu blog em [ScottCate.com](http://ScottCate.com)</span><span class="sxs-lookup"><span data-stu-id="c37f0-338">Scott can be contacted via email at [scott.cate@myKB.com](mailto:scott.cate@myKB.com) or his blog at [ScottCate.com](http://ScottCate.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c37f0-339">[Anterior](understanding-asp-net-ajax-localization.md)
> [Próximo](understanding-asp-net-ajax-debugging-capabilities.md)</span><span class="sxs-lookup"><span data-stu-id="c37f0-339">[Previous](understanding-asp-net-ajax-localization.md)
[Next](understanding-asp-net-ajax-debugging-capabilities.md)</span></span>
