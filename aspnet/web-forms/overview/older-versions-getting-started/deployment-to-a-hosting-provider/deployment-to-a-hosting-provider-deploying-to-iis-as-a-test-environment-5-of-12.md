---
uid: web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12
title: 'Implantando um aplicativo da Web ASP.NET com o SQL Server Compact usando o Visual Studio ou Visual Web Developer: Implantando no IIS como um ambiente de teste – 5 de 12 | Microsoft Docs'
author: tdykstra
description: Esta série de tutoriais mostra como implantar (publicar) um ASP.NET projeto de aplicativo web que inclui um banco de dados do SQL Server Compact usando o Visual Stu...
ms.author: riande
ms.date: 11/17/2011
ms.assetid: 493b2a66-816c-485c-8315-952ed1085ccc
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12
msc.type: authoredcontent
ms.openlocfilehash: ba939012e8fb11a50992eeaef70e8ebf61cea851
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57058803"
---
<a name="deploying-an-aspnet-web-application-with-sql-server-compact-using-visual-studio-or-visual-web-developer-deploying-to-iis-as-a-test-environment---5-of-12"></a><span data-ttu-id="e4815-103">Implantando um aplicativo da Web ASP.NET com o SQL Server Compact usando o Visual Studio ou Visual Web Developer: Implantando no IIS como um ambiente de teste – 5 de 12</span><span class="sxs-lookup"><span data-stu-id="e4815-103">Deploying an ASP.NET Web Application with SQL Server Compact using Visual Studio or Visual Web Developer: Deploying to IIS as a Test Environment - 5 of 12</span></span>
====================
<span data-ttu-id="e4815-104">por [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="e4815-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="e4815-105">Baixe o projeto inicial</span><span class="sxs-lookup"><span data-stu-id="e4815-105">Download Starter Project</span></span>](http://code.msdn.microsoft.com/Deploying-an-ASPNET-Web-4e31366b)

> <span data-ttu-id="e4815-106">Esta série de tutoriais mostra como implantar (publicar) um ASP.NET projeto de aplicativo web que inclui um banco de dados do SQL Server Compact usando o Visual Studio 2012 RC ou Visual Studio Express 2012 RC para Web.</span><span class="sxs-lookup"><span data-stu-id="e4815-106">This series of tutorials shows you how to deploy (publish) an ASP.NET web application project that includes a SQL Server Compact database by using Visual Studio 2012 RC or Visual Studio Express 2012 RC for Web.</span></span> <span data-ttu-id="e4815-107">Você também pode usar o Visual Studio 2010 se você instalar a atualização de publicação na Web.</span><span class="sxs-lookup"><span data-stu-id="e4815-107">You can also use Visual Studio 2010 if you install the Web Publish Update.</span></span> <span data-ttu-id="e4815-108">Para obter uma introdução à série, consulte [o primeiro tutorial na série](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="e4815-108">For an introduction to the series, see [the first tutorial in the series](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span></span>
> 
> <span data-ttu-id="e4815-109">Para obter um tutorial que mostra os recursos de implantação introduzidos após a versão RC do Visual Studio 2012, mostra como implantar as edições do SQL Server que não seja o SQL Server Compact e mostra como implantar aplicativos de Web do serviço de aplicativo do Azure, consulte [implantação da Web do ASP.NET usando o Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span><span class="sxs-lookup"><span data-stu-id="e4815-109">For a tutorial that shows deployment features introduced after the RC release of Visual Studio 2012, shows how to deploy SQL Server editions other than SQL Server Compact, and shows how to deploy to Azure App Service Web Apps, see [ASP.NET Web Deployment using Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span></span>


## <a name="overview"></a><span data-ttu-id="e4815-110">Visão geral</span><span class="sxs-lookup"><span data-stu-id="e4815-110">Overview</span></span>

<span data-ttu-id="e4815-111">Este tutorial mostra como implantar um aplicativo da web ASP.NET no IIS no computador local.</span><span class="sxs-lookup"><span data-stu-id="e4815-111">This tutorial shows how to deploy an ASP.NET web application to IIS on the local computer.</span></span>

<span data-ttu-id="e4815-112">Quando você desenvolve um aplicativo, geralmente você testa executá-lo no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e4815-112">When you develop an application, you generally test by running it in Visual Studio.</span></span> <span data-ttu-id="e4815-113">Por padrão, isso significa que você estiver usando o Visual Studio Development Server (também conhecido como Cassini).</span><span class="sxs-lookup"><span data-stu-id="e4815-113">By default, this means you're using the Visual Studio Development Server (also known as Cassini).</span></span> <span data-ttu-id="e4815-114">O Visual Studio Development Server torna mais fácil de testar durante o desenvolvimento no Visual Studio, mas ele não funciona exatamente como o IIS.</span><span class="sxs-lookup"><span data-stu-id="e4815-114">The Visual Studio Development Server makes it easy to test during development in Visual Studio, but it doesn't work exactly like IIS.</span></span> <span data-ttu-id="e4815-115">Como resultado, é possível que um aplicativo será executado corretamente quando você testá-lo no Visual Studio, mas falha quando ele é implantado no IIS em um ambiente de hospedagem.</span><span class="sxs-lookup"><span data-stu-id="e4815-115">As a result, it's possible that an application will run correctly when you test it in Visual Studio, but fail when it's deployed to IIS in a hosting environment.</span></span>

<span data-ttu-id="e4815-116">Você pode testar seu aplicativo de maneira mais confiável das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="e4815-116">You can test your application more reliably in these ways:</span></span>

1. <span data-ttu-id="e4815-117">Usar o IIS Express ou o IIS completo em vez do Visual Studio Development Server quando você testar no Visual Studio durante o desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="e4815-117">Use IIS Express or full IIS instead of the Visual Studio Development Server when you test in Visual Studio during development.</span></span> <span data-ttu-id="e4815-118">Esse método geralmente emula mais precisamente como seu site será executado no IIS.</span><span class="sxs-lookup"><span data-stu-id="e4815-118">This method generally emulates more accurately how your site will run under IIS.</span></span> <span data-ttu-id="e4815-119">No entanto, esse método não testa seu processo de implantação ou validar que o resultado do processo de implantação será executado corretamente.</span><span class="sxs-lookup"><span data-stu-id="e4815-119">However, this method does not test your deployment process or validate that the result of the deployment process will run correctly.</span></span>
2. <span data-ttu-id="e4815-120">Implante o aplicativo ao IIS no computador de desenvolvimento usando o mesmo processo que você usará posteriormente para implantá-lo em seu ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="e4815-120">Deploy the application to IIS on your development computer by using the same process that you'll use later to deploy it to your production environment.</span></span> <span data-ttu-id="e4815-121">Esse método valida seu processo de implantação além de validar que o aplicativo será executado corretamente no IIS.</span><span class="sxs-lookup"><span data-stu-id="e4815-121">This method validates your deployment process in addition to validating that your application will run correctly under IIS.</span></span>
3. <span data-ttu-id="e4815-122">Implante o aplicativo em um ambiente de teste que é o mais próximo possível para seu ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="e4815-122">Deploy the application to a test environment that is as close as possible to your production environment.</span></span> <span data-ttu-id="e4815-123">Como o ambiente de produção para esses tutoriais é um provedor de hospedagem de terceiros, o ambiente de teste ideal seria uma segunda conta com o provedor de hospedagem.</span><span class="sxs-lookup"><span data-stu-id="e4815-123">Since the production environment for these tutorials is a third-party hosting provider, the ideal test environment would be a second account with the hosting provider.</span></span> <span data-ttu-id="e4815-124">Você usaria essa segunda conta somente para teste, mas ele seria configurado da mesma forma que a conta de produção.</span><span class="sxs-lookup"><span data-stu-id="e4815-124">You would use this second account only for testing, but it would be set up the same way as the production account.</span></span>

<span data-ttu-id="e4815-125">Este tutorial mostra as etapas para a opção 2.</span><span class="sxs-lookup"><span data-stu-id="e4815-125">This tutorial shows the steps for option 2.</span></span> <span data-ttu-id="e4815-126">Diretrizes para a opção 3 é fornecido no final o [implantando no ambiente de produção](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) tutorial, e há links para recursos para a opção 1 no final deste tutorial.</span><span class="sxs-lookup"><span data-stu-id="e4815-126">Guidance for option 3 is provided at the end of the [Deploying to the Production Environment](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) tutorial, and at the end of this tutorial there are links to resources for option 1.</span></span>

<span data-ttu-id="e4815-127">Lembrete: Se você receber uma mensagem de erro ou se algo não funciona ao percorrer o tutorial, certifique-se de verificar a [página de solução de problemas](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="e4815-127">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the [troubleshooting page](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span></span>

## <a name="configuring-the-application-to-run-in-medium-trust"></a><span data-ttu-id="e4815-128">Configurando o aplicativo para execução em confiança média</span><span class="sxs-lookup"><span data-stu-id="e4815-128">Configuring the Application to Run in Medium Trust</span></span>

<span data-ttu-id="e4815-129">Antes de instalar o IIS e implantando a ele, você vai alterar uma configuração do arquivo Web. config para fazer com que o site executado mais como ele será em um ambiente típico de hospedagem compartilhado.</span><span class="sxs-lookup"><span data-stu-id="e4815-129">Before installing IIS and deploying to it, you'll change a Web.config file setting in order to make the site run more like it will in a typical shared hosting environment.</span></span>

<span data-ttu-id="e4815-130">Provedores de hospedagem normalmente executar seu site da web no *confiança média*, que significa que há algumas coisas que ele não tem permissão para fazer.</span><span class="sxs-lookup"><span data-stu-id="e4815-130">Hosting providers typically run your web site in *medium trust*, which means there are some things it is not allowed to do.</span></span> <span data-ttu-id="e4815-131">Por exemplo, o código do aplicativo não pode acessar o registro do Windows e não é possível ler ou gravar arquivos que estão fora da hierarquia de pastas do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e4815-131">For example, application code can't access the Windows registry and can't read or write files that are outside of your application's folder hierarchy.</span></span> <span data-ttu-id="e4815-132">Por padrão, seu aplicativo é executado *alta confiança* no computador local, que significa que o aplicativo pode ser capaz de fazer coisas que falharem ao implantá-lo para a produção.</span><span class="sxs-lookup"><span data-stu-id="e4815-132">By default your application runs in *high trust* on your local computer, which means that the application might be able to do things that would fail when you deploy it to production.</span></span> <span data-ttu-id="e4815-133">Portanto, para tornar o ambiente de teste que mais reflitam com precisão o ambiente de produção, você configurará o aplicativo seja executado em confiança média.</span><span class="sxs-lookup"><span data-stu-id="e4815-133">Therefore, to make the test environment more accurately reflect the production environment, you'll configure the application to run in medium trust.</span></span>

<span data-ttu-id="e4815-134">No arquivo Web. config do aplicativo, adicione uma **relação de confiança** elemento o **System. Web** elemento, conforme mostrado neste exemplo.</span><span class="sxs-lookup"><span data-stu-id="e4815-134">In the application Web.config file, add a **trust** element in the **system.web** element, as shown in this example.</span></span>

[!code-xml[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample1.xml?highlight=4)]

<span data-ttu-id="e4815-135">Agora, o aplicativo será executado em confiança média no IIS, mesmo em seu computador local.</span><span class="sxs-lookup"><span data-stu-id="e4815-135">The application will now run in medium trust in IIS even on your local computer.</span></span> <span data-ttu-id="e4815-136">Essa configuração permite que você mais cedo possível capturar todas as tentativas por código do aplicativo para fazer algo que falharia na produção.</span><span class="sxs-lookup"><span data-stu-id="e4815-136">This setting enables you to catch as early as possible any attempts by application code to do something that would fail in production.</span></span>

> [!NOTE]
> <span data-ttu-id="e4815-137">Se você estiver usando o Entity Framework Code First Migrations, certifique-se de que você tenha a versão 5.0 ou posterior instalado.</span><span class="sxs-lookup"><span data-stu-id="e4815-137">If you are using Entity Framework Code First Migrations, make sure that you have version 5.0 or later installed.</span></span> <span data-ttu-id="e4815-138">No Entity Framework versão 4.3, migrações requer confiança total para atualizar o esquema de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e4815-138">In Entity Framework version 4.3, Migrations requires full trust in order to update the database schema.</span></span>


## <a name="installing-iis-and-web-deploy"></a><span data-ttu-id="e4815-139">Instalando o IIS e Web implantar</span><span class="sxs-lookup"><span data-stu-id="e4815-139">Installing IIS and Web Deploy</span></span>

<span data-ttu-id="e4815-140">Para implantar em IIS no computador de desenvolvimento, você deve ter o IIS e implantação da Web instalado.</span><span class="sxs-lookup"><span data-stu-id="e4815-140">To deploy to IIS on your development computer, you must have IIS and Web Deploy installed.</span></span> <span data-ttu-id="e4815-141">Eles não estão incluídos na configuração padrão Windows 7.</span><span class="sxs-lookup"><span data-stu-id="e4815-141">These are not included in the default Windows 7 configuration.</span></span> <span data-ttu-id="e4815-142">Se você já tiver instalado o IIS e a implantação da Web, vá para a próxima seção.</span><span class="sxs-lookup"><span data-stu-id="e4815-142">If you have already installed both IIS and Web Deploy, skip to the next section.</span></span>

<span data-ttu-id="e4815-143">Usando o [Web Platform Installer](https://www.microsoft.com/web/downloads/platform.aspx) é a maneira preferencial para instalar o IIS e a implantação da Web, porque o Web Platform Installer instala uma configuração recomendada para o IIS e instala automaticamente os pré-requisitos para o IIS e da Web Implante se necessário.</span><span class="sxs-lookup"><span data-stu-id="e4815-143">Using the [Web Platform Installer](https://www.microsoft.com/web/downloads/platform.aspx) is the preferred way to install IIS and Web Deploy, because the Web Platform Installer installs a recommended configuration for IIS and it automatically installs the prerequisites for IIS and Web Deploy if necessary.</span></span>

<span data-ttu-id="e4815-144">Para executar o Web Platform Installer para instalar o IIS e implantação da Web, use o link a seguir.</span><span class="sxs-lookup"><span data-stu-id="e4815-144">To run Web Platform Installer to install IIS and Web Deploy, use the following link.</span></span> <span data-ttu-id="e4815-145">Se você já tiver instalado o IIS, implantação da Web ou qualquer um de seus componentes obrigatórios, o Web Platform Installer instala apenas o que está faltando.</span><span class="sxs-lookup"><span data-stu-id="e4815-145">If you already have installed IIS, Web Deploy or any of their required components, the Web Platform Installer installs only what is missing.</span></span>

- [<span data-ttu-id="e4815-146">Instalar o IIS e implantação da Web usando WebPI</span><span class="sxs-lookup"><span data-stu-id="e4815-146">Install IIS and Web Deploy using WebPI</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=IIS7;ASPNET;NETFramework4;WDeploy)

## <a name="setting-the-default-application-pool-to-net-4"></a><span data-ttu-id="e4815-147">Configuração do Pool de aplicativos padrão para o .NET 4</span><span class="sxs-lookup"><span data-stu-id="e4815-147">Setting the Default Application Pool to .NET 4</span></span>

<span data-ttu-id="e4815-148">Depois de instalar o IIS, execute **o Gerenciador do IIS** para certificar-se de que o .NET Framework versão 4 é atribuído ao pool de aplicativos padrão.</span><span class="sxs-lookup"><span data-stu-id="e4815-148">After installing IIS, run **IIS Manager** to make sure that the .NET Framework version 4 is assigned to the default application pool.</span></span>

<span data-ttu-id="e4815-149">De que o Windows **inicie** menu, selecione **execute**, insira "inetmgr" e, em seguida, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="e4815-149">From the Windows **Start** menu, select **Run**, enter "inetmgr", and then click **OK**.</span></span> <span data-ttu-id="e4815-150">(Se o **executados** comando não está no seu **iniciar** menu, você pode pressionar a tecla Windows e o R para abri-lo.</span><span class="sxs-lookup"><span data-stu-id="e4815-150">(If the **Run** command is not in your **Start** menu, you can press the Windows Key and R to open it.</span></span> <span data-ttu-id="e4815-151">Ou clique com botão direito a barra de tarefas, clique em **propriedades**, selecione o **Menu Iniciar** , clique em **personalizar**e selecione **executar comando**.)</span><span class="sxs-lookup"><span data-stu-id="e4815-151">Or right-click the taskbar, click **Properties**, select the **Start Menu** tab, click **Customize**, and select **Run command**.)</span></span>

<span data-ttu-id="e4815-152">No **conexões** painel, expanda o nó do servidor e selecione **Pools de aplicativos**.</span><span class="sxs-lookup"><span data-stu-id="e4815-152">In the **Connections** pane, expand the server node and select **Application Pools**.</span></span> <span data-ttu-id="e4815-153">No **Pools de aplicativos** painel, se **DefaultAppPool** é atribuído para o .NET framework versão 4, como mostra a ilustração a seguir, pule para a próxima seção.</span><span class="sxs-lookup"><span data-stu-id="e4815-153">In the **Application Pools** pane, if **DefaultAppPool** is assigned to the .NET framework version 4 as in the following illustration, skip to the next section.</span></span>

<span data-ttu-id="e4815-154">[![Inetmgr_showing_4.0_app_pools](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image2.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-154">[![Inetmgr_showing_4.0_app_pools](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image2.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image1.png)</span></span>

<span data-ttu-id="e4815-155">Se você vir apenas dois pools de aplicativos e os dois são definidos para o .NET Framework 2.0, você precisa instalar o ASP.NET 4 no IIS:</span><span class="sxs-lookup"><span data-stu-id="e4815-155">If you see only two application pools and both of them are set to the .NET Framework 2.0, you have to install ASP.NET 4 in IIS:</span></span>

- <span data-ttu-id="e4815-156">Abra uma janela de prompt de comando clicando **Prompt de comando** em que o Windows **inicie** menu e selecionando **executar como administrador**.</span><span class="sxs-lookup"><span data-stu-id="e4815-156">Open a command prompt window by right-clicking **Command Prompt** in the Windows **Start** menu and selecting **Run as Administrator**.</span></span> <span data-ttu-id="e4815-157">Em seguida, execute [aspnet\_regiis.exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) para instalar o ASP.NET 4 no IIS, usando os comandos a seguir.</span><span class="sxs-lookup"><span data-stu-id="e4815-157">Then run [aspnet\_regiis.exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) to install ASP.NET 4 in IIS, using the following commands.</span></span> <span data-ttu-id="e4815-158">(Em sistemas de 64 bits, substitua "Estrutura" com "Framework64").</span><span class="sxs-lookup"><span data-stu-id="e4815-158">(In 64-bit systems, replace "Framework" with "Framework64".)</span></span>

    [!code-console[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample2.cmd)]

    <span data-ttu-id="e4815-159">[![aspnet_regiis_installing_ASP.NET_4](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image4.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-159">[![aspnet_regiis_installing_ASP.NET_4](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image4.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image3.png)</span></span>

    <span data-ttu-id="e4815-160">Este comando cria novos pools de aplicativos para o .NET Framework 4, mas o pool de aplicativos padrão ainda será definido como 2.0.</span><span class="sxs-lookup"><span data-stu-id="e4815-160">This command creates new application pools for the .NET Framework 4, but the default application pool will still be set to 2.0.</span></span> <span data-ttu-id="e4815-161">Você estará Implantando um aplicativo que tem como alvo o .NET 4 para esse pool de aplicativos, portanto, você precisa alterar o pool de aplicativos para o .NET 4.</span><span class="sxs-lookup"><span data-stu-id="e4815-161">You'll be deploying an application that targets .NET 4 to that application pool, so you have to change the application pool to .NET 4.</span></span>

<span data-ttu-id="e4815-162">Se você fechou **o Gerenciador do IIS**, execute-o novamente, expanda o nó do servidor e clique em **Pools de aplicativos** para exibir o **Pools de aplicativos** painel novamente.</span><span class="sxs-lookup"><span data-stu-id="e4815-162">If you closed **IIS Manager**, run it again, expand the server node, and click **Application Pools** to display the **Application Pools** pane again.</span></span>

<span data-ttu-id="e4815-163">No **Pools de aplicativos** painel, clique em **DefaultAppPool**e, em seguida, no **ações** painel clique **configurações básicas**.</span><span class="sxs-lookup"><span data-stu-id="e4815-163">In the **Application Pools** pane, click **DefaultAppPool**, and then in the **Actions** pane click **Basic Settings**.</span></span>

<span data-ttu-id="e4815-164">[![Inetmgr_selecting_Basic_Settings_for_app_pool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image6.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-164">[![Inetmgr_selecting_Basic_Settings_for_app_pool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image6.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image5.png)</span></span>

<span data-ttu-id="e4815-165">No **Editar Pool de aplicativos** caixa de diálogo alteração **versão do .NET Framework** para **v4.0.30319 do .NET Framework** e clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="e4815-165">In the **Edit Application Pool** dialog box, change **.NET Framework version** to **.NET Framework v4.0.30319** and click **OK**.</span></span>

<span data-ttu-id="e4815-166">[![Selecting_.NET_4_for_DefaultAppPool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image8.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-166">[![Selecting_.NET_4_for_DefaultAppPool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image8.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image7.png)</span></span>

<span data-ttu-id="e4815-167">Agora você está pronto para publicar no IIS.</span><span class="sxs-lookup"><span data-stu-id="e4815-167">You are now ready to publish to IIS.</span></span>

## <a name="publishing-to-iis"></a><span data-ttu-id="e4815-168">Publicação para IIS</span><span class="sxs-lookup"><span data-stu-id="e4815-168">Publishing to IIS</span></span>

<span data-ttu-id="e4815-169">Há várias maneiras que você pode implantar usando o Visual Studio 2010 e a implantação da Web:</span><span class="sxs-lookup"><span data-stu-id="e4815-169">There are several ways you can deploy using Visual Studio 2010 and Web Deploy:</span></span>

- <span data-ttu-id="e4815-170">Use o Visual Studio, um clique para publicar.</span><span class="sxs-lookup"><span data-stu-id="e4815-170">Use Visual Studio one-click publish.</span></span>
- <span data-ttu-id="e4815-171">Criar uma *pacote de implantação* e instalá-lo usando a UI do Gerenciador do IIS.</span><span class="sxs-lookup"><span data-stu-id="e4815-171">Create a *deployment package* and install it using the IIS Manager UI.</span></span> <span data-ttu-id="e4815-172">O pacote de implantação consiste em uma *. zip* arquivo que contém todos os arquivos e metadados necessários para instalar um site no IIS.</span><span class="sxs-lookup"><span data-stu-id="e4815-172">The deployment package consists of a *.zip* file that contains all the files and metadata needed to install a site in IIS.</span></span>
- <span data-ttu-id="e4815-173">Criar um pacote de implantação e instalá-lo usando a linha de comando.</span><span class="sxs-lookup"><span data-stu-id="e4815-173">Create a deployment package and install it using the command line.</span></span>

<span data-ttu-id="e4815-174">O processo que você seguiu nos tutoriais anteriores para configurar o Visual Studio para automatizar tarefas de implantação se aplica a todos esses três métodos.</span><span class="sxs-lookup"><span data-stu-id="e4815-174">The process you went through in the previous tutorials to set up Visual Studio to automate deployment tasks applies to all of these three methods.</span></span> <span data-ttu-id="e4815-175">Esses tutoriais, você usará o primeiro desses métodos.</span><span class="sxs-lookup"><span data-stu-id="e4815-175">In these tutorials you'll use the first of these methods.</span></span> <span data-ttu-id="e4815-176">Para obter informações sobre como usar pacotes de implantação, consulte [mapa de conteúdo de implantação do ASP.NET](https://msdn.microsoft.com/library/bb386521.aspx).</span><span class="sxs-lookup"><span data-stu-id="e4815-176">For information about using deployment packages, see [ASP.NET Deployment Content Map](https://msdn.microsoft.com/library/bb386521.aspx).</span></span>

<span data-ttu-id="e4815-177">Antes de publicar, certifique-se de que você está executando o Visual Studio no modo de administrador.</span><span class="sxs-lookup"><span data-stu-id="e4815-177">Before publishing, make sure that you are running Visual Studio in administrator mode.</span></span> <span data-ttu-id="e4815-178">(No Windows 7 **inicie** menu, clique com botão direito no ícone para a versão do Visual Studio que você está usando e selecione **executar como administrador**.) Modo de administrador é necessário para publicar somente quando você estiver publicando para IIS no computador local.</span><span class="sxs-lookup"><span data-stu-id="e4815-178">(In the Windows 7 **Start** menu, right-click the icon for the version of Visual Studio you're using and select **Run as Administrator**.) Administrator mode is required for publishing only when you are publishing to IIS on the local computer.</span></span>

<span data-ttu-id="e4815-179">Na **Gerenciador de soluções**, clique com botão direito do projeto ContosoUniversity (não no projeto ContosoUniversity.DAL) e selecione **publicar**.</span><span class="sxs-lookup"><span data-stu-id="e4815-179">In **Solution Explorer**, right-click the ContosoUniversity project (not the ContosoUniversity.DAL project) and select **Publish**.</span></span>

<span data-ttu-id="e4815-180">O **publicar na Web** assistente é exibido.</span><span class="sxs-lookup"><span data-stu-id="e4815-180">The **Publish Web** wizard appears.</span></span>

![Publish_Web_wizard_Profile_tab](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image9.png)

<span data-ttu-id="e4815-182">Na lista suspensa, selecione  **&lt;New... &gt;**.</span><span class="sxs-lookup"><span data-stu-id="e4815-182">In the drop-down list, select **&lt;New...&gt;**.</span></span>

<span data-ttu-id="e4815-183">No **novo perfil** caixa de diálogo, insira "Test" e, em seguida, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="e4815-183">In the **New Profile** dialog box, enter "Test", and then click **OK**.</span></span>

![New_Profile_dialog_box](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image10.png)

<span data-ttu-id="e4815-185">Esse nome é que o mesmo que o nó central do Web.Test.config transformar o arquivo que você criou anteriormente.</span><span class="sxs-lookup"><span data-stu-id="e4815-185">This name is the same as the middle node of the Web.Test.config transform file that you created earlier.</span></span> <span data-ttu-id="e4815-186">Essa correspondência é o que faz com que as transformações Web.Test.config a ser aplicada quando você publica por meio desse perfil.</span><span class="sxs-lookup"><span data-stu-id="e4815-186">This correspondence is what causes the Web.Test.config transformations to be applied when you publish by using this profile.</span></span>

<span data-ttu-id="e4815-187">O assistente avançará automaticamente para o **Conexão** guia.</span><span class="sxs-lookup"><span data-stu-id="e4815-187">The wizard automatically advances to the **Connection** tab.</span></span>

<span data-ttu-id="e4815-188">No **URL do serviço** , digite *localhost*.</span><span class="sxs-lookup"><span data-stu-id="e4815-188">In the **Service URL** box, enter *localhost*.</span></span>

<span data-ttu-id="e4815-189">No **Site/aplicativo** , digite *Default Web Site/ContosoUniversity*.</span><span class="sxs-lookup"><span data-stu-id="e4815-189">In the **Site/application** box, enter *Default Web Site/ContosoUniversity*.</span></span>

<span data-ttu-id="e4815-190">No **URL de destino** , digite `http://localhost/ContosoUniversity`.</span><span class="sxs-lookup"><span data-stu-id="e4815-190">In the **Destination URL** box, enter `http://localhost/ContosoUniversity`.</span></span>

<span data-ttu-id="e4815-191">O **URL de destino** configuração não é necessária.</span><span class="sxs-lookup"><span data-stu-id="e4815-191">The **Destination URL** setting isn't required.</span></span> <span data-ttu-id="e4815-192">Quando o Visual Studio terminar de implantar o aplicativo, ele abre automaticamente o navegador padrão para essa URL.</span><span class="sxs-lookup"><span data-stu-id="e4815-192">When Visual Studio finishes deploying the application, it automatically opens your default browser to this URL.</span></span> <span data-ttu-id="e4815-193">Se você não quiser que o navegador para abrir automaticamente após a implantação, deixe essa caixa em branco.</span><span class="sxs-lookup"><span data-stu-id="e4815-193">If you don't want the browser to open automatically after deployment, leave this box blank.</span></span>

![Publish_Web_wizard_Connection_tab_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image11.png)

<span data-ttu-id="e4815-195">Clique em **validar Conexão** para verificar se as configurações estão corretas e se conectar ao IIS no computador local.</span><span class="sxs-lookup"><span data-stu-id="e4815-195">Click **Validate Connection** to verify that the settings are correct and you can connect to IIS on the local computer.</span></span>

<span data-ttu-id="e4815-196">Uma marca de seleção verde verifica se a conexão foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="e4815-196">A green check mark verifies that the connection is successful.</span></span>

![Publish_Web_wizard_Connection_tab_validated](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image12.png)

<span data-ttu-id="e4815-198">Clique em **próxima** para ir para o **configurações** guia.</span><span class="sxs-lookup"><span data-stu-id="e4815-198">Click **Next** to advance to the **Settings** tab.</span></span>

<span data-ttu-id="e4815-199">O **configuração** caixa suspensa Especifica a configuração de compilação para implantar.</span><span class="sxs-lookup"><span data-stu-id="e4815-199">The **Configuration** drop-down box specifies the build configuration to deploy.</span></span> <span data-ttu-id="e4815-200">O valor padrão é a versão, o que é o que você deseja.</span><span class="sxs-lookup"><span data-stu-id="e4815-200">The default value is Release, which is what you want.</span></span>

<span data-ttu-id="e4815-201">Deixe o **remover arquivos adicionais no destino** caixa de seleção desmarcada.</span><span class="sxs-lookup"><span data-stu-id="e4815-201">Leave the **Remove additional files at destination** check box cleared.</span></span> <span data-ttu-id="e4815-202">Como essa é a primeira implantação, haverá todos os arquivos na pasta de destino ainda.</span><span class="sxs-lookup"><span data-stu-id="e4815-202">Since this is your first deployment, there won't be any files in the destination folder yet.</span></span>

<span data-ttu-id="e4815-203">No **bancos de dados** , digite o seguinte valor na caixa de cadeia de caracteres de conexão para **SchoolContext**:</span><span class="sxs-lookup"><span data-stu-id="e4815-203">In the **Databases** section, enter the following value in the connection string box for **SchoolContext**:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample3.cmd)]

<span data-ttu-id="e4815-204">O processo de implantação colocará essa cadeia de caracteres de conexão no arquivo Web. config implantado porque **Use essa cadeia de caracteres de conexão em tempo de execução** está selecionado.</span><span class="sxs-lookup"><span data-stu-id="e4815-204">The deployment process will put this connection string in the deployed Web.config file because **Use this connection string at runtime** is selected.</span></span>

<span data-ttu-id="e4815-205">Também no **SchoolContext**, selecione **aplicar migrações do Code First**.</span><span class="sxs-lookup"><span data-stu-id="e4815-205">Also under **SchoolContext**, select **Apply Code First Migrations**.</span></span> <span data-ttu-id="e4815-206">Essa opção faz com que o processo de implantação configurar o arquivo Web. config implantado para especificar o `MigrateDatabaseToLatestVersion` inicializador.</span><span class="sxs-lookup"><span data-stu-id="e4815-206">This option causes the deployment process to configure the deployed Web.config file to specify the `MigrateDatabaseToLatestVersion` initializer.</span></span> <span data-ttu-id="e4815-207">Esse inicializador atualiza automaticamente o banco de dados para a versão mais recente quando o aplicativo acessa o banco de dados pela primeira vez após a implantação.</span><span class="sxs-lookup"><span data-stu-id="e4815-207">This initializer automatically updates the database to the latest version when the application accesses the database for the first time after deployment.</span></span>

<span data-ttu-id="e4815-208">Na caixa de cadeia de caracteres de conexão para **DefaultConnection**, digite o seguinte valor:</span><span class="sxs-lookup"><span data-stu-id="e4815-208">In the connection string box for **DefaultConnection**, enter the following value:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample4.cmd)]

<span data-ttu-id="e4815-209">Deixe **Atualizar banco de dados** desmarcada.</span><span class="sxs-lookup"><span data-stu-id="e4815-209">Leave **Update database** cleared.</span></span> <span data-ttu-id="e4815-210">O banco de dados de associação será implantado copiando o arquivo. sdf no aplicativo\_dados e você não deseja que o processo de implantação faça qualquer coisa com esse banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e4815-210">The membership database will be deployed by copying the .sdf file in App\_Data, and you don't want the deployment process to do anything else with this database.</span></span>

![Publish_Web_wizard_Settings_tab_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image13.png)

<span data-ttu-id="e4815-212">Clique em **próxima** para ir para o **visualização** guia.</span><span class="sxs-lookup"><span data-stu-id="e4815-212">Click **Next** to advance to the **Preview** tab.</span></span>

<span data-ttu-id="e4815-213">No **versão prévia** , clique em **iniciar visualização** para ver uma lista dos arquivos que serão copiados.</span><span class="sxs-lookup"><span data-stu-id="e4815-213">In the **Preview** tab, click **Start Preview** to see a list of the files that will be copied.</span></span>

![Publish_Web_wizard_Preview_tab_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image14.png)

![Publish_Web_wizard_Preview_tab_Test_with_file_list](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image15.png)

<span data-ttu-id="e4815-216">Clique em **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="e4815-216">Click **Publish**.</span></span>

<span data-ttu-id="e4815-217">Se o Visual Studio não está no modo de administrador, você poderá receber uma mensagem de erro que indica um erro de permissões.</span><span class="sxs-lookup"><span data-stu-id="e4815-217">If Visual Studio is not in administrator mode, you might get an error message that indicates a permissions error.</span></span> <span data-ttu-id="e4815-218">Nesse caso, feche o Visual Studio, abra-o no modo de administrador e tente publicar novamente.</span><span class="sxs-lookup"><span data-stu-id="e4815-218">In that case, close Visual Studio, open it in administrator mode, and try to publish again.</span></span>

<span data-ttu-id="e4815-219">Se o Visual Studio está no modo de administrador, o **saída** janela relatórios bem-sucedida compilar e publicar.</span><span class="sxs-lookup"><span data-stu-id="e4815-219">If Visual Studio is in administrator mode, the **Output** window reports successful build and publish.</span></span>

![Output_window_publish_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image16.png)

<span data-ttu-id="e4815-221">O navegador é aberto automaticamente para a página inicial do Contoso University em execução no IIS no computador local.</span><span class="sxs-lookup"><span data-stu-id="e4815-221">The browser automatically opens to the Contoso University Home page running in IIS on the local computer.</span></span>

<span data-ttu-id="e4815-222">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image18.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-222">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image18.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image17.png)</span></span>

## <a name="testing-in-the-test-environment"></a><span data-ttu-id="e4815-223">Teste no ambiente de teste</span><span class="sxs-lookup"><span data-stu-id="e4815-223">Testing in the Test Environment</span></span>

<span data-ttu-id="e4815-224">Observe que o indicador de ambiente mostra "(teste)" em vez de "(desenvolvimento)", que mostra que o *Web. config* transformação para o indicador de ambiente foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="e4815-224">Notice that the environment indicator shows "(Test)" instead of "(Dev)", which shows that the *Web.config* transformation for the environment indicator was successful.</span></span>

<span data-ttu-id="e4815-225">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image20.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-225">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image20.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image19.png)</span></span>

<span data-ttu-id="e4815-226">Execute o **alunos** página para verificar se o banco de dados implantado não tem nenhum aluno.</span><span class="sxs-lookup"><span data-stu-id="e4815-226">Run the **Students** page to verify that the deployed database has no students.</span></span> <span data-ttu-id="e4815-227">Quando você seleciona essa página, ele pode levar alguns minutos para carregar porque o Code First cria o banco de dados e, em seguida, executa o `Seed` método.</span><span class="sxs-lookup"><span data-stu-id="e4815-227">When you select this page it may take a few minutes to load because Code First creates the database and then runs the `Seed` method.</span></span> <span data-ttu-id="e4815-228">(Ele não fez isso quando você estava na home page, porque o aplicativo não tente acessar o banco de dados ainda.)</span><span class="sxs-lookup"><span data-stu-id="e4815-228">(It didn't do that when you were on the home page because the application didn't try to access the database yet.)</span></span>

<span data-ttu-id="e4815-229">[![Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image22.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-229">[![Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image22.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image21.png)</span></span>

<span data-ttu-id="e4815-230">Execute o **instrutores** página para verificar se que o Code First propagado o banco de dados do instrutor:</span><span class="sxs-lookup"><span data-stu-id="e4815-230">Run the **Instructors** page to verify that Code First seeded the database with instructor data:</span></span>

<span data-ttu-id="e4815-231">[![Instructors_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image24.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-231">[![Instructors_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image24.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image23.png)</span></span>

<span data-ttu-id="e4815-232">Selecione **adicionar alunos** da **alunos** menu, adicionar um aluno e, em seguida, exibir o novo aluno no **alunos** página para verificar se que você pode escrever com êxito no banco de dados :</span><span class="sxs-lookup"><span data-stu-id="e4815-232">Select **Add Students** from the **Students** menu, add a student, and then view the new student in the **Students** page to verify that you can successfully write to the database:</span></span>

<span data-ttu-id="e4815-233">[![Add_Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image26.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-233">[![Add_Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image26.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image25.png)</span></span>

<span data-ttu-id="e4815-234">[![Students_page_with_new_student_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image28.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-234">[![Students_page_with_new_student_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image28.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image27.png)</span></span>

<span data-ttu-id="e4815-235">Dos **cursos** menu, selecione **atualização créditos**.</span><span class="sxs-lookup"><span data-stu-id="e4815-235">From the **Courses** menu, select **Update Credits**.</span></span> <span data-ttu-id="e4815-236">O **créditos de atualização** página requer permissões de administrador, portanto, o **Log In** página é exibida.</span><span class="sxs-lookup"><span data-stu-id="e4815-236">The **Update Credits** page requires administrator permissions, so the **Log In** page is displayed.</span></span> <span data-ttu-id="e4815-237">Insira as credenciais da conta de administrador que você criou anteriormente ("admin" e "Pas$ w0rd").</span><span class="sxs-lookup"><span data-stu-id="e4815-237">Enter the administrator account credentials that you created earlier ("admin" and "Pas$w0rd").</span></span> <span data-ttu-id="e4815-238">O **atualização créditos** página for exibida, que verifica que a conta de administrador que você criou no tutorial anterior foi implantada corretamente no ambiente de teste.</span><span class="sxs-lookup"><span data-stu-id="e4815-238">The **Update Credits** page is displayed, which verifies that the administrator account that you created in the previous tutorial was correctly deployed to the test environment.</span></span>

<span data-ttu-id="e4815-239">[![Log_In_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image30.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-239">[![Log_In_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image30.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image29.png)</span></span>

<span data-ttu-id="e4815-240">[![Update_Credits_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image32.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-240">[![Update_Credits_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image32.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image31.png)</span></span>

<span data-ttu-id="e4815-241">Verificar se um *Elmah* pasta existe com apenas o arquivo de espaço reservado para ele.</span><span class="sxs-lookup"><span data-stu-id="e4815-241">Verify that an *Elmah* folder exists with only the placeholder file in it.</span></span>

<span data-ttu-id="e4815-242">[![Elmah_folder_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image34.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="e4815-242">[![Elmah_folder_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image34.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image33.png)</span></span>

<a id="efcfmigrations"></a>

## <a name="reviewing-the-automatic-webconfig-changes-for-code-first-migrations"></a><span data-ttu-id="e4815-243">Revisar as alterações da Web. config automática para migrações do Code First</span><span class="sxs-lookup"><span data-stu-id="e4815-243">Reviewing the Automatic Web.config Changes for Code First Migrations</span></span>

<span data-ttu-id="e4815-244">Abra o *Web. config* arquivo no aplicativo implantado na *C:\inetpub\wwwroot\ContosoUniversity* e você pode ver onde o processo de implantação configurado migrações do Code First para automaticamente Atualize o banco de dados para a versão mais recente.</span><span class="sxs-lookup"><span data-stu-id="e4815-244">Open the *Web.config* file in the deployed application at *C:\inetpub\wwwroot\ContosoUniversity* and you can see where the deployment process configured Code First Migrations to automatically update the database to the latest version.</span></span>

![](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image35.png)

<span data-ttu-id="e4815-245">O processo de implantação também criou uma nova cadeia de conexão para migrações do Code First exclusivamente atualizar o esquema de banco de dados:</span><span class="sxs-lookup"><span data-stu-id="e4815-245">The deployment process also created a new connection string for Code First Migrations to use exclusively for updating the database schema:</span></span>

![DatabasePublish_connection_string](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image36.png)

<span data-ttu-id="e4815-247">Essa cadeia de caracteres de conexão adicional permite que você especifique uma conta de usuário para atualizações de esquema de banco de dados e uma conta de usuário diferentes para acesso de dados do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e4815-247">This additional connection string enables you to specify one user account for database schema updates, and a different user account for application data access.</span></span> <span data-ttu-id="e4815-248">Por exemplo, você pode atribuir o BD\_função de proprietário para migrações do Code First e o banco de dados\_datareader e o banco de dados\_datawriter funções para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e4815-248">For example, you could assign the db\_owner role to Code First Migrations, and db\_datareader and db\_datawriter roles to the application.</span></span> <span data-ttu-id="e4815-249">Isso é um padrão comum de defesa em profundidade que impede que o código potencialmente mal-intencionado no aplicativo de alterar o esquema de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e4815-249">This is a common defense-in-depth pattern that prevents potentially malicious code in the application from changing the database schema.</span></span> <span data-ttu-id="e4815-250">(Por exemplo, isso pode acontecer em um ataque de injeção de SQL.) Esse padrão não é usado por esses tutoriais.</span><span class="sxs-lookup"><span data-stu-id="e4815-250">(For example, this might happen in a successful SQL injection attack.) This pattern is not used by these tutorials.</span></span> <span data-ttu-id="e4815-251">Não se aplica ao SQL Server Compact, e não se aplica quando você migra para o SQL Server em um tutorial posterior nesta série.</span><span class="sxs-lookup"><span data-stu-id="e4815-251">It does not apply to SQL Server Compact, and it does not apply when you migrate to SQL Server in a later tutorial in this series.</span></span> <span data-ttu-id="e4815-252">O site de Cytanium oferece apenas uma conta de usuário para acessar o banco de dados do SQL Server que você criou em Cytanium.</span><span class="sxs-lookup"><span data-stu-id="e4815-252">The Cytanium site offers just one user account for accessing the SQL Server database that you create at Cytanium.</span></span> <span data-ttu-id="e4815-253">Se você for capaz de implementar esse padrão em seu cenário, você pode fazer isso executando as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="e4815-253">If you are able to implement this pattern in your scenario, you can do it by performing the following steps:</span></span>

1. <span data-ttu-id="e4815-254">No **as configurações** guia da **publicar na Web** assistente, insira a cadeia de caracteres de conexão que especifica um usuário com permissões de atualização do esquema de banco de dados completo e desmarque o **usar essa cadeia de caracteres de conexão em tempo de execução** caixa de seleção.</span><span class="sxs-lookup"><span data-stu-id="e4815-254">In the **Settings** tab of the **Publish Web** wizard, enter the connection string that specifies a user with full database schema update permissions, and clear the **Use this connection string at runtime** check box.</span></span> <span data-ttu-id="e4815-255">No arquivo Web. config implantado, isso se torna o `DatabasePublish` cadeia de caracteres de conexão.</span><span class="sxs-lookup"><span data-stu-id="e4815-255">In the deployed Web.config file, this becomes the `DatabasePublish` connection string.</span></span>
2. <span data-ttu-id="e4815-256">Crie uma transformação do arquivo Web. config para a cadeia de caracteres de conexão que você deseja que o aplicativo para usar em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="e4815-256">Create a Web.config file transformation for the connection string that you want the application to use at run time.</span></span>

<span data-ttu-id="e4815-257">Agora você implantou seu aplicativo ao IIS no computador de desenvolvimento e testá-lo lá.</span><span class="sxs-lookup"><span data-stu-id="e4815-257">You have now deployed your application to IIS on your development computer and tested it there.</span></span> <span data-ttu-id="e4815-258">Isso verifica se o processo de implantação copiados de conteúdo do aplicativo para o local certo (excluindo os arquivos que você não quiser implantar), e também essa implantação da Web configurado IIS corretamente durante a implantação.</span><span class="sxs-lookup"><span data-stu-id="e4815-258">This verifies that the deployment process copied the application's content to the right location (excluding the files that you did not want to deploy), and also that Web Deploy configured IIS correctly during deployment.</span></span> <span data-ttu-id="e4815-259">No próximo tutorial, você executará mais um teste que localiza uma tarefa de implantação que ainda não foi feita: definindo permissões de pasta na *Elmah* pasta.</span><span class="sxs-lookup"><span data-stu-id="e4815-259">In the next tutorial, you'll run one more test that finds a deployment task that has not yet been done: setting folder permissions on the *Elmah* folder.</span></span>

## <a name="more-information"></a><span data-ttu-id="e4815-260">Mais informações</span><span class="sxs-lookup"><span data-stu-id="e4815-260">More Information</span></span>

<span data-ttu-id="e4815-261">Para obter informações sobre como executar o IIS ou IIS Express no Visual Studio, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="e4815-261">For information about running IIS or IIS Express in Visual Studio, see the following resources:</span></span>

- <span data-ttu-id="e4815-262">[Visão geral do IIS Express](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) no site IIS.net.</span><span class="sxs-lookup"><span data-stu-id="e4815-262">[IIS Express Overview](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) on the IIS.net site.</span></span>
- <span data-ttu-id="e4815-263">[Introdução ao IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) no blog de Guthrie.</span><span class="sxs-lookup"><span data-stu-id="e4815-263">[Introducing IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) on Scott Guthrie's blog.</span></span>
- <span data-ttu-id="e4815-264">[Como: Especificar o servidor Web para projetos Web no Visual Studio](https://msdn.microsoft.com/library/ms178108.aspx).</span><span class="sxs-lookup"><span data-stu-id="e4815-264">[How to: Specify the Web Server for Web Projects in Visual Studio](https://msdn.microsoft.com/library/ms178108.aspx).</span></span>
- <span data-ttu-id="e4815-265">[Principais diferenças entre o IIS e o ASP.NET Development Server](../deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) no site do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="e4815-265">[Core Differences Between IIS and the ASP.NET Development Server](../deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) on the ASP.NET site.</span></span>
- <span data-ttu-id="e4815-266">[Testar a ASP.NET MVC ou o aplicativo de formulários da Web no IIS 7 em 30 segundos](https://blogs.msdn.com/b/rickandy/archive/2011/04/22/test-you-asp-net-mvc-or-webforms-application-on-iis-7-in-30-seconds.aspx) no blog de Rick Anderson.</span><span class="sxs-lookup"><span data-stu-id="e4815-266">[Test your ASP.NET MVC or Web Forms Application on IIS 7 in 30 seconds](https://blogs.msdn.com/b/rickandy/archive/2011/04/22/test-you-asp-net-mvc-or-webforms-application-on-iis-7-in-30-seconds.aspx) on Rick Anderson's blog.</span></span> <span data-ttu-id="e4815-267">Essa entrada fornece exemplos de por que testar com o Visual Studio Development Server (Cassini) não é tão confiável quanto o teste no IIS Express e por testes no IIS Express não é tão confiável quanto o teste no IIS.</span><span class="sxs-lookup"><span data-stu-id="e4815-267">This entry provides examples of why testing with the Visual Studio Development Server (Cassini) is not as reliable as testing in IIS Express, and why testing in IIS Express is not as reliable as testing in IIS.</span></span>

<span data-ttu-id="e4815-268">Para obter informações sobre quais problemas podem surgir quando seu aplicativo é executado em confiança média, consulte [hospedando aplicativos do ASP.NET em confiança média](http://www.4guysfromrolla.com/articles/100307-1.aspx) em que a equipe de site Rolla de 4.</span><span class="sxs-lookup"><span data-stu-id="e4815-268">For information about what issues might arise when your application runs in medium trust, see [Hosting ASP.NET Applications in Medium Trust](http://www.4guysfromrolla.com/articles/100307-1.aspx) on the 4 Guys from Rolla site.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e4815-269">[Anterior](deployment-to-a-hosting-provider-configuring-project-properties-4-of-12.md)
> [Próximo](deployment-to-a-hosting-provider-setting-folder-permissions-6-of-12.md)</span><span class="sxs-lookup"><span data-stu-id="e4815-269">[Previous](deployment-to-a-hosting-provider-configuring-project-properties-4-of-12.md)
[Next](deployment-to-a-hosting-provider-setting-folder-permissions-6-of-12.md)</span></span>
