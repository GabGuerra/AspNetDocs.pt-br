---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
title: Adicionando mais colunas DataTable (VB) | Microsoft Docs
author: rick-anderson
description: Ao usar o Assistente do TableAdapter para criar um conjunto de dados tipado, DataTable correspondente contém as colunas retornadas pela consulta de banco de dados principal. Lá, mas...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 1e8e65f9-fe3e-4250-810b-c90227786bed
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: 75b5a1e1d6beb00079d754601860d0c25bc8a23e
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57062743"
---
<a name="adding-additional-datatable-columns-vb"></a><span data-ttu-id="1b85e-104">Adicionar mais colunas DataTable (VB)</span><span class="sxs-lookup"><span data-stu-id="1b85e-104">Adding Additional DataTable Columns (VB)</span></span>
====================
<span data-ttu-id="1b85e-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1b85e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1b85e-106">[Baixar o código](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip) ou [baixar PDF](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1b85e-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip) or [Download PDF](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span></span>

> <span data-ttu-id="1b85e-107">Ao usar o Assistente do TableAdapter para criar um conjunto de dados tipado, DataTable correspondente contém as colunas retornadas pela consulta de banco de dados principal.</span><span class="sxs-lookup"><span data-stu-id="1b85e-107">When using the TableAdapter Wizard to create a Typed DataSet, the corresponding DataTable contains the columns returned by the main database query.</span></span> <span data-ttu-id="1b85e-108">Mas há ocasiões em que o DataTable precisa incluir colunas adicionais.</span><span class="sxs-lookup"><span data-stu-id="1b85e-108">But there are occasions when the DataTable needs to include additional columns.</span></span> <span data-ttu-id="1b85e-109">Neste tutorial, saiba por que os procedimentos armazenados são recomendados quando precisarmos de mais colunas DataTable.</span><span class="sxs-lookup"><span data-stu-id="1b85e-109">In this tutorial we learn why stored procedures are recommended when we need additional DataTable columns.</span></span>


## <a name="introduction"></a><span data-ttu-id="1b85e-110">Introdução</span><span class="sxs-lookup"><span data-stu-id="1b85e-110">Introduction</span></span>

<span data-ttu-id="1b85e-111">Ao adicionar um TableAdapter a um conjunto de dados tipado, o esquema de s DataTable correspondente é determinado pela consulta TableAdapter s principal.</span><span class="sxs-lookup"><span data-stu-id="1b85e-111">When adding a TableAdapter to a Typed DataSet, the corresponding DataTable s schema is determined by the TableAdapter s main query.</span></span> <span data-ttu-id="1b85e-112">Por exemplo, se a consulta principal retorna campos de dados *um*, *B*, e *C*, a DataTable terá três colunas correspondentes denominadas *um*, *B*, e *C*. Além de sua consulta principal, um TableAdapter pode incluir consultas adicionais que retornam, talvez, um subconjunto dos dados com base em algum parâmetro.</span><span class="sxs-lookup"><span data-stu-id="1b85e-112">For example, if the main query returns data fields *A*, *B*, and *C*, the DataTable will have three corresponding columns named *A*, *B*, and *C*. In addition to its main query, a TableAdapter can include additional queries that return, perhaps, a subset of the data based on some parameter.</span></span> <span data-ttu-id="1b85e-113">Por exemplo, em além com o `ProductsTableAdapter` consulta principal s, que retorna informações sobre todos os produtos, ela também contém métodos como `GetProductsByCategoryID(categoryID)` e `GetProductByProductID(productID)`, que retornam informações de produto específico com base em um parâmetro fornecido.</span><span class="sxs-lookup"><span data-stu-id="1b85e-113">For instance, in addition to the `ProductsTableAdapter` s main query, which returns information about all products, it also contains methods like `GetProductsByCategoryID(categoryID)` and `GetProductByProductID(productID)`, which return specific product information based on a supplied parameter.</span></span>

<span data-ttu-id="1b85e-114">O modelo de ter o esquema de DataTable s refletem a consulta principal do TableAdapter s funciona bem se todos os métodos TableAdapter s retornam o mesmo ou menos campos de dados daquelas especificadas na consulta principal.</span><span class="sxs-lookup"><span data-stu-id="1b85e-114">The model of having the DataTable s schema reflect the TableAdapter s main query works well if all of the TableAdapter s methods return the same or fewer data fields than those specified in the main query.</span></span> <span data-ttu-id="1b85e-115">Se precisar de um método do TableAdapter retornar campos de dados adicionais, podemos deve expandir o esquema de DataTable s adequadamente.</span><span class="sxs-lookup"><span data-stu-id="1b85e-115">If a TableAdapter method needs to return additional data fields, then we should expand the DataTable s schema accordingly.</span></span> <span data-ttu-id="1b85e-116">No [mestre/detalhes usando uma lista com marcadores de registros de mestre com um DataList de detalhes](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial adicionamos um método para o `CategoriesTableAdapter` que retornou a `CategoryID`, `CategoryName`, e `Description` campos de dados definidos no a consulta principal adição `NumberOfProducts`, um campo de dados adicionais que relatou o número de produtos associados a cada categoria.</span><span class="sxs-lookup"><span data-stu-id="1b85e-116">In the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that returned the `CategoryID`, `CategoryName`, and `Description` data fields defined in the main query plus `NumberOfProducts`, an additional data field that reported the number of products associated with each category.</span></span> <span data-ttu-id="1b85e-117">Manualmente, adicionamos uma nova coluna para o `CategoriesDataTable` para capturar o `NumberOfProducts` valor desse novo método do campo de dados.</span><span class="sxs-lookup"><span data-stu-id="1b85e-117">We manually added a new column to the `CategoriesDataTable` in order to capture the `NumberOfProducts` data field value from this new method.</span></span>

<span data-ttu-id="1b85e-118">Conforme discutido na [carregar arquivos](../working-with-binary-files/uploading-files-vb.md) tutorial, grande cuidado com TableAdapters que usam instruções SQL ad hoc e têm métodos cujos campos de dados não coincidem com precisão a consulta principal.</span><span class="sxs-lookup"><span data-stu-id="1b85e-118">As discussed in the [Uploading Files](../working-with-binary-files/uploading-files-vb.md) tutorial, great care must be taken with TableAdapters that use ad-hoc SQL statements and have methods whose data fields do not precisely match the main query.</span></span> <span data-ttu-id="1b85e-119">Se o Assistente de configuração do TableAdapter é executado novamente, ele atualizará todos os métodos TableAdapter s para que corresponda a sua lista de campos de dados da consulta principal.</span><span class="sxs-lookup"><span data-stu-id="1b85e-119">If the TableAdapter Configuration wizard is re-run, it will update all of the TableAdapter s methods so that their data field list matches the main query.</span></span> <span data-ttu-id="1b85e-120">Consequentemente, quaisquer métodos com listas de coluna personalizada serão revertido para a lista de colunas da consulta principal s e não retornar os dados esperados.</span><span class="sxs-lookup"><span data-stu-id="1b85e-120">Consequently, any methods with customized column lists will revert to the main query s column list and not return the expected data.</span></span> <span data-ttu-id="1b85e-121">Esse problema não ocorre ao usar procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="1b85e-121">This issue does not arise when using stored procedures.</span></span>

<span data-ttu-id="1b85e-122">Neste tutorial vamos examinar como estender o esquema de s uma DataTable para incluir colunas adicionais.</span><span class="sxs-lookup"><span data-stu-id="1b85e-122">In this tutorial we will look at how to extend a DataTable s schema to include additional columns.</span></span> <span data-ttu-id="1b85e-123">Devido a fragilidade do TableAdapter ao usar instruções SQL ad hoc, neste tutorial usaremos procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="1b85e-123">Due to the brittleness of the TableAdapter when using ad-hoc SQL statements, in this tutorial we will use stored procedures.</span></span> <span data-ttu-id="1b85e-124">Consulte a [criando novos procedimentos armazenados para o s TableAdapters do conjunto de dados tipado](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) e [usando procedimentos armazenados existentes para o s TableAdapters do conjunto de dados tipado](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutoriais para saber mais sobre Configurando um TableAdapter para usar procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="1b85e-124">Refer to the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) and [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorials for more information on configuring a TableAdapter to use stored procedures.</span></span>

## <a name="step-1-adding-apricequartilecolumn-to-theproductsdatatable"></a><span data-ttu-id="1b85e-125">Etapa 1: Adicionando um`PriceQuartile`coluna para o`ProductsDataTable`</span><span class="sxs-lookup"><span data-stu-id="1b85e-125">Step 1: Adding a`PriceQuartile`Column to the`ProductsDataTable`</span></span>

<span data-ttu-id="1b85e-126">No *criando novos procedimentos armazenados para o s TableAdapters do conjunto de dados tipado* tutorial, criamos um DataSet tipado chamado `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="1b85e-126">In the *Creating New Stored Procedures for the Typed DataSet s TableAdapters* tutorial we created a Typed DataSet named `NorthwindWithSprocs`.</span></span> <span data-ttu-id="1b85e-127">Atualmente, esse conjunto de dados contém duas DataTables: `ProductsDataTable` e `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="1b85e-127">This DataSet currently contains two DataTables: `ProductsDataTable` and `EmployeesDataTable`.</span></span> <span data-ttu-id="1b85e-128">O `ProductsTableAdapter` tem três métodos a seguir:</span><span class="sxs-lookup"><span data-stu-id="1b85e-128">The `ProductsTableAdapter` has the following three methods:</span></span>

- <span data-ttu-id="1b85e-129">`GetProducts` -a consulta principal, que retorna todos os registros do `Products` tabela</span><span class="sxs-lookup"><span data-stu-id="1b85e-129">`GetProducts` - the main query, which returns all records from the `Products` table</span></span>
- <span data-ttu-id="1b85e-130">`GetProductsByCategoryID(categoryID)` -Retorna todos os produtos com a especificada *categoryID*.</span><span class="sxs-lookup"><span data-stu-id="1b85e-130">`GetProductsByCategoryID(categoryID)` - returns all products with the specified *categoryID*.</span></span>
- <span data-ttu-id="1b85e-131">`GetProductByProductID(productID)` -Retorna o produto específico com a especificada *productID*.</span><span class="sxs-lookup"><span data-stu-id="1b85e-131">`GetProductByProductID(productID)` - returns the particular product with the specified *productID*.</span></span>

<span data-ttu-id="1b85e-132">A consulta principal e os dois métodos adicionais retornam o mesmo conjunto de campos de dados, ou seja, todas as colunas da `Products` tabela.</span><span class="sxs-lookup"><span data-stu-id="1b85e-132">The main query and the two additional methods all return the same set of data fields, namely all of the columns from the `Products` table.</span></span> <span data-ttu-id="1b85e-133">Não há nenhum subconsultas correlacionadas ou `JOIN` s, extraindo dados relacionados do `Categories` ou `Suppliers` tabelas.</span><span class="sxs-lookup"><span data-stu-id="1b85e-133">There are no correlated subqueries or `JOIN` s pulling related data from the `Categories` or `Suppliers` tables.</span></span> <span data-ttu-id="1b85e-134">Portanto, o `ProductsDataTable` tem uma coluna correspondente para cada campo no `Products` tabela.</span><span class="sxs-lookup"><span data-stu-id="1b85e-134">Therefore, the `ProductsDataTable` has a corresponding column for each field in the `Products` table.</span></span>

<span data-ttu-id="1b85e-135">Para este tutorial, vamos s adicionar um método para o `ProductsTableAdapter` chamado `GetProductsWithPriceQuartile` que retorna todos os produtos.</span><span class="sxs-lookup"><span data-stu-id="1b85e-135">For this tutorial, let s add a method to the `ProductsTableAdapter` named `GetProductsWithPriceQuartile` that returns all of the products.</span></span> <span data-ttu-id="1b85e-136">Além dos campos de dados padrão do produto, `GetProductsWithPriceQuartile` também incluirá uma `PriceQuartile` campo de dados que indica sob quais quartil o preço do produto s cai.</span><span class="sxs-lookup"><span data-stu-id="1b85e-136">In addition to the standard product data fields, `GetProductsWithPriceQuartile` will also include a `PriceQuartile` data field that indicates under which quartile the product s price falls.</span></span> <span data-ttu-id="1b85e-137">Por exemplo, os produtos cujos preços estão em 25% mais caro terá um `PriceQuartile` valor de 1, enquanto aquelas cujos preços se enquadram na parte inferior 25% terá um valor de 4.</span><span class="sxs-lookup"><span data-stu-id="1b85e-137">For example, those products whose prices are in the most expensive 25% will have a `PriceQuartile` value of 1, while those whose prices fall in the bottom 25% will have a value of 4.</span></span> <span data-ttu-id="1b85e-138">Antes de nos preocupamos criando o procedimento armazenado para retornar essa informação, no entanto, primeiro precisamos atualizar o `ProductsDataTable` para incluir uma coluna para conter a `PriceQuartile` resultados quando o `GetProductsWithPriceQuartile` método é usado.</span><span class="sxs-lookup"><span data-stu-id="1b85e-138">Before we worry about creating the stored procedure to return this information, however, we first need to update the `ProductsDataTable` to include a column to hold the `PriceQuartile` results when the `GetProductsWithPriceQuartile` method is used.</span></span>

<span data-ttu-id="1b85e-139">Abra o `NorthwindWithSprocs` conjunto de dados e clique duas vezes no `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="1b85e-139">Open the `NorthwindWithSprocs` DataSet and right-click on the `ProductsDataTable`.</span></span> <span data-ttu-id="1b85e-140">Escolha Adicionar no menu de contexto e, em seguida, escolha a coluna.</span><span class="sxs-lookup"><span data-stu-id="1b85e-140">Choose Add from the context-menu and then pick Column.</span></span>


<span data-ttu-id="1b85e-141">[![Adicionar uma nova coluna para o ProductsDataTable](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1b85e-141">[![Add a New Column to the ProductsDataTable](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="1b85e-142">**Figura 1**: Adicionar uma nova coluna para o `ProductsDataTable` ([clique para exibir a imagem em tamanho normal](adding-additional-datatable-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="1b85e-142">**Figure 1**: Add a New Column to the `ProductsDataTable` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image3.png))</span></span>


<span data-ttu-id="1b85e-143">Isso adicionará uma nova coluna à DataTable chamado Column1 do tipo `System.String`.</span><span class="sxs-lookup"><span data-stu-id="1b85e-143">This will add a new column to the DataTable named Column1 of type `System.String`.</span></span> <span data-ttu-id="1b85e-144">Precisamos atualizar esse nome de coluna s PriceQuartile e seu tipo como `System.Int32` , pois ele será usado para manter um número entre 1 e 4.</span><span class="sxs-lookup"><span data-stu-id="1b85e-144">We need to update this column s name to PriceQuartile and its type to `System.Int32` since it will be used to hold a number between 1 and 4.</span></span> <span data-ttu-id="1b85e-145">Selecione a coluna recentemente adicionada na `ProductsDataTable` e, na janela Propriedades, defina a `Name` propriedade PriceQuartile e o `DataType` propriedade `System.Int32`.</span><span class="sxs-lookup"><span data-stu-id="1b85e-145">Select the newly-added column in the `ProductsDataTable` and, from the Properties window, set the `Name` property to PriceQuartile and the `DataType` property to `System.Int32`.</span></span>


<span data-ttu-id="1b85e-146">[![Definir as propriedades de tipo de dados e o nome da nova coluna s](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="1b85e-146">[![Set the New Column s Name and DataType Properties](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="1b85e-147">**Figura 2**: Definir a nova coluna s `Name` e `DataType` propriedades ([clique para exibir a imagem em tamanho normal](adding-additional-datatable-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="1b85e-147">**Figure 2**: Set the New Column s `Name` and `DataType` Properties ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image6.png))</span></span>


<span data-ttu-id="1b85e-148">Como mostra a Figura 2, há propriedades adicionais que podem ser definidas, como se os valores na coluna devem ser exclusivos, se a coluna for uma coluna de incremento automático, ou não de banco de dados `NULL` valores são permitidos e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="1b85e-148">As Figure 2 shows, there are additional properties that can be set, such as whether the values in the column must be unique, if the column is an auto-increment column, whether or not database `NULL` values are allowed, and so on.</span></span> <span data-ttu-id="1b85e-149">Deixe esses valores definidos como seus padrões.</span><span class="sxs-lookup"><span data-stu-id="1b85e-149">Leave these values set to their defaults.</span></span>

## <a name="step-2-creating-thegetproductswithpricequartilemethod"></a><span data-ttu-id="1b85e-150">Etapa 2: Criando o`GetProductsWithPriceQuartile`método</span><span class="sxs-lookup"><span data-stu-id="1b85e-150">Step 2: Creating the`GetProductsWithPriceQuartile`Method</span></span>

<span data-ttu-id="1b85e-151">Agora que o `ProductsDataTable` foi atualizado para incluir os `PriceQuartile` coluna, estamos prontos para criar o `GetProductsWithPriceQuartile` método.</span><span class="sxs-lookup"><span data-stu-id="1b85e-151">Now that the `ProductsDataTable` has been updated to include the `PriceQuartile` column, we are ready to create the `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="1b85e-152">Inicie o botão direito do mouse no TableAdapter e selecionando Add Query no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="1b85e-152">Start by right-clicking on the TableAdapter and choosing Add Query from the context-menu.</span></span> <span data-ttu-id="1b85e-153">Isso abre o Assistente de configuração de consulta do TableAdapter, que primeiro solicita sobre se desejamos usar instruções SQL ad hoc ou um procedimento armazenado de novo ou existente.</span><span class="sxs-lookup"><span data-stu-id="1b85e-153">This brings up the TableAdapter Query Configuration wizard, which first prompts us as to whether we want to use ad-hoc SQL statements or a new or existing stored procedure.</span></span> <span data-ttu-id="1b85e-154">Já que estamos don t ainda tem um procedimento armazenado que retorna os dados de preço quartil, permitem que s permitem que o TableAdapter criar esse procedimento armazenado para nós.</span><span class="sxs-lookup"><span data-stu-id="1b85e-154">Since we don t yet have a stored procedure that returns the price quartile data, let s allow the TableAdapter to create this stored procedure for us.</span></span> <span data-ttu-id="1b85e-155">Selecione a opção de procedimento armazenado criar novo e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="1b85e-155">Select the Create new stored procedure option and click Next.</span></span>


<span data-ttu-id="1b85e-156">[![Instruir o Assistente para criar o procedimento armazenado para que possamos TableAdapter](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1b85e-156">[![Instruct the TableAdapter Wizard to Create the Stored Procedure For Us](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="1b85e-157">**Figura 3**: Instruir o Assistente para criar o armazenado procedimento para nós TableAdapter ([clique para exibir a imagem em tamanho normal](adding-additional-datatable-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="1b85e-157">**Figure 3**: Instruct the TableAdapter Wizard to Create the Stored Procedure For Us ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image9.png))</span></span>


<span data-ttu-id="1b85e-158">A tela subsequente, mostrada na Figura 4, o assistente solicita a nós que tipo de consulta para adicionar.</span><span class="sxs-lookup"><span data-stu-id="1b85e-158">In the subsequent screen, shown in Figure 4, the wizard asks us what type of query to add.</span></span> <span data-ttu-id="1b85e-159">Uma vez que o `GetProductsWithPriceQuartile` método retornará todas as colunas e registros da `Products` da tabela, selecione SELECT que retorna linhas de opção e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="1b85e-159">Since the `GetProductsWithPriceQuartile` method will return all columns and records from the `Products` table, select the SELECT which returns rows option and click Next.</span></span>


<span data-ttu-id="1b85e-160">[![Nossa consulta será uma instrução SELECT que retorna várias linhas](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="1b85e-160">[![Our Query will be a SELECT Statement that Returns Multiple Rows](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="1b85e-161">**Figura 4**: Nossa consulta será um `SELECT` instrução que retorna várias linhas ([clique para exibir a imagem em tamanho normal](adding-additional-datatable-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="1b85e-161">**Figure 4**: Our Query will be a `SELECT` Statement that Returns Multiple Rows ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image12.png))</span></span>


<span data-ttu-id="1b85e-162">Em seguida, será solicitado a fornecer o `SELECT` consulta.</span><span class="sxs-lookup"><span data-stu-id="1b85e-162">Next we are prompted for the `SELECT` query.</span></span> <span data-ttu-id="1b85e-163">Insira a seguinte consulta no Assistente:</span><span class="sxs-lookup"><span data-stu-id="1b85e-163">Enter the following query into the wizard:</span></span>


[!code-sql[Main](adding-additional-datatable-columns-vb/samples/sample1.sql)]

<span data-ttu-id="1b85e-164">A consulta acima usa o SQL Server 2005 s novo [ `NTILE` função](https://msdn.microsoft.com/library/ms175126.aspx) para dividir os resultados em quatro grupos em que os grupos são determinados pelo `UnitPrice` valores classificados em ordem decrescente.</span><span class="sxs-lookup"><span data-stu-id="1b85e-164">The above query uses SQL Server 2005 s new [`NTILE` function](https://msdn.microsoft.com/library/ms175126.aspx) to divide the results into four groups where the groups are determined by the `UnitPrice` values sorted in descending order.</span></span>

<span data-ttu-id="1b85e-165">Infelizmente, o construtor de consultas não sabem como analisar o `OVER` palavra-chave e exibirá um erro ao analisar a consulta acima.</span><span class="sxs-lookup"><span data-stu-id="1b85e-165">Unfortunately, the Query Builder does not know how to parse the `OVER` keyword and will display an error when parsing the above query.</span></span> <span data-ttu-id="1b85e-166">Portanto, insira a consulta acima diretamente na caixa de texto no assistente sem usar o construtor de consultas.</span><span class="sxs-lookup"><span data-stu-id="1b85e-166">Therefore, enter the above query directly in the textbox in the wizard without using the Query Builder.</span></span>

> [!NOTE]
> <span data-ttu-id="1b85e-167">Para obter mais informações sobre s NTILE e SQL Server 2005 outras funções de classificação, consulte [retornando resultados classificados com o Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) e o [seção funções de classificação](https://msdn.microsoft.com/library/ms189798.aspx) do [SQL Manuais Online do Server 2005](https://msdn.microsoft.com/library/ms189798.aspx).</span><span class="sxs-lookup"><span data-stu-id="1b85e-167">For more information on NTILE and SQL Server 2005 s other ranking functions, see [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) and the [Ranking Functions section](https://msdn.microsoft.com/library/ms189798.aspx) from the [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span></span>


<span data-ttu-id="1b85e-168">Depois de inserir o `SELECT` consulta e clique em Avançar, o assistente solicita que possamos fornecer um nome para o procedimento armazenado será criado.</span><span class="sxs-lookup"><span data-stu-id="1b85e-168">After entering the `SELECT` query and clicking Next, the wizard asks us to provide a name for the stored procedure it will create.</span></span> <span data-ttu-id="1b85e-169">Nomeie o novo procedimento armazenado `Products_SelectWithPriceQuartile` e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="1b85e-169">Name the new stored procedure `Products_SelectWithPriceQuartile` and click Next.</span></span>


<span data-ttu-id="1b85e-170">[![Nome do procedimento armazenado Products_SelectWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="1b85e-170">[![Name the Stored Procedure Products_SelectWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="1b85e-171">**Figura 5**: Nomeie o procedimento armazenado `Products_SelectWithPriceQuartile` ([clique para exibir a imagem em tamanho normal](adding-additional-datatable-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="1b85e-171">**Figure 5**: Name the Stored Procedure `Products_SelectWithPriceQuartile` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image15.png))</span></span>


<span data-ttu-id="1b85e-172">Por fim, podemos serão solicitados a nomear os métodos do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="1b85e-172">Lastly, we are prompted to name the TableAdapter methods.</span></span> <span data-ttu-id="1b85e-173">Deixe os dois o preenchimento uma DataTable e retornar uma DataTable de caixas de seleção marcadas e o nome os métodos `FillWithPriceQuartile` e `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="1b85e-173">Leave both the Fill a DataTable and Return a DataTable checkboxes checked and name the methods `FillWithPriceQuartile` and `GetProductsWithPriceQuartile`.</span></span>


<span data-ttu-id="1b85e-174">[![Os métodos TableAdapter s de nome e clique em Concluir](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="1b85e-174">[![Name the TableAdapter s Methods and Click Finish](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="1b85e-175">**Figura 6**: Nomeie os métodos do TableAdapter s e clique em Concluir ([clique para exibir a imagem em tamanho normal](adding-additional-datatable-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="1b85e-175">**Figure 6**: Name the TableAdapter s Methods and Click Finish ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image18.png))</span></span>


<span data-ttu-id="1b85e-176">Com o `SELECT` consulta especificada e o procedimento armazenado e métodos do TableAdapter nomeados, clique em Concluir para concluir o assistente.</span><span class="sxs-lookup"><span data-stu-id="1b85e-176">With the `SELECT` query specified and the stored procedure and TableAdapter methods named, click Finish to complete the wizard.</span></span> <span data-ttu-id="1b85e-177">Neste ponto você pode receber um aviso ou dois do Assistente de dizendo que o `OVER` instrução ou construção SQL não tem suporte.</span><span class="sxs-lookup"><span data-stu-id="1b85e-177">At this point you may get a warning or two from the wizard saying that The `OVER` SQL construct or statement is not supported.</span></span> <span data-ttu-id="1b85e-178">Esses avisos podem ser ignorados.</span><span class="sxs-lookup"><span data-stu-id="1b85e-178">These warnings can be ignored.</span></span>

<span data-ttu-id="1b85e-179">Depois de concluir o assistente, o TableAdapter deve incluir a `FillWithPriceQuartile` e `GetProductsWithPriceQuartile` métodos e o banco de dados devem incluir um procedimento armazenado denominado `Products_SelectWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="1b85e-179">After completing the wizard, the TableAdapter should include the `FillWithPriceQuartile` and `GetProductsWithPriceQuartile` methods and the database should include a stored procedure named `Products_SelectWithPriceQuartile`.</span></span> <span data-ttu-id="1b85e-180">Reserve um tempo para verificar que o TableAdapter, de fato, contém esse novo método e que o procedimento armazenado foi adicionado corretamente ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="1b85e-180">Take a moment to verify that the TableAdapter does indeed contain this new method and that the stored procedure has been correctly added to the database.</span></span> <span data-ttu-id="1b85e-181">Durante a verificação de banco de dados, se você não vir o procedimento armazenado try clicando com botão direito na pasta Stored Procedures e escolher atualizar.</span><span class="sxs-lookup"><span data-stu-id="1b85e-181">When checking the database, if you do not see the stored procedure try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>


![Verifique se que foi adicionado um novo método ao TableAdapter](adding-additional-datatable-columns-vb/_static/image19.png)

<span data-ttu-id="1b85e-183">**Figura 7**: Verifique se que foi adicionado um novo método ao TableAdapter</span><span class="sxs-lookup"><span data-stu-id="1b85e-183">**Figure 7**: Verify that a New Method Has Been Added to the TableAdapter</span></span>


<span data-ttu-id="1b85e-184">[![Certifique-se de que o banco de dados contém o Products_SelectWithPriceQuartile procedimento armazenado](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="1b85e-184">[![Ensure that the Database Contains the Products_SelectWithPriceQuartile Stored Procedure](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span></span>

<span data-ttu-id="1b85e-185">**Figura 8**: Certifique-se de que o banco de dados que contém o `Products_SelectWithPriceQuartile` procedimento armazenado ([clique para exibir a imagem em tamanho normal](adding-additional-datatable-columns-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="1b85e-185">**Figure 8**: Ensure that the Database Contains the `Products_SelectWithPriceQuartile` Stored Procedure ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="1b85e-186">Um dos benefícios do uso de procedimentos armazenados, em vez de instruções SQL ad hoc é que a executar novamente o Assistente de configuração do TableAdapter não modificará a coluna de lista de procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="1b85e-186">One of the benefits of using stored procedures instead of ad-hoc SQL statements is that re-running the TableAdapter Configuration wizard will not modify the stored procedures column lists.</span></span> <span data-ttu-id="1b85e-187">Verifique isso clicando duas vezes no TableAdapter, escolhendo a opção de configurar no menu de contexto para iniciar o assistente e, em seguida, clicando em Concluir para concluí-lo.</span><span class="sxs-lookup"><span data-stu-id="1b85e-187">Verify this by right-clicking on the TableAdapter, choosing the Configure option from the context-menu to start the wizard, and then clicking Finish to complete it.</span></span> <span data-ttu-id="1b85e-188">Em seguida, vá para o banco de dados e exibir o `Products_SelectWithPriceQuartile` procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="1b85e-188">Next, go to the database and view the `Products_SelectWithPriceQuartile` stored procedure.</span></span> <span data-ttu-id="1b85e-189">Observe que sua lista de colunas não foi modificada.</span><span class="sxs-lookup"><span data-stu-id="1b85e-189">Note that its column list has not been modified.</span></span> <span data-ttu-id="1b85e-190">Estavam estamos usando instruções SQL ad hoc, executar novamente o Assistente de configuração do TableAdapter seria revertida essa lista de colunas de consulta s para corresponder à lista de coluna da consulta principal, removendo, assim, a instrução de NTILE de consulta usada pelo `GetProductsWithPriceQuartile` método.</span><span class="sxs-lookup"><span data-stu-id="1b85e-190">Had we been using ad-hoc SQL statements, re-running the TableAdapter Configuration wizard would have reverted this query s column list to match the main query column list, thereby removing the NTILE statement from the query used by the `GetProductsWithPriceQuartile` method.</span></span>


<span data-ttu-id="1b85e-191">Quando a camada de acesso a dados s `GetProductsWithPriceQuartile` método é invocado, o TableAdapter executa o `Products_SelectWithPriceQuartile` procedimento armazenado e adiciona uma linha para o `ProductsDataTable` para cada registro de retorno.</span><span class="sxs-lookup"><span data-stu-id="1b85e-191">When the Data Access Layer s `GetProductsWithPriceQuartile` method is invoked, the TableAdapter executes the `Products_SelectWithPriceQuartile` stored procedure and adds a row to the `ProductsDataTable` for each returned record.</span></span> <span data-ttu-id="1b85e-192">Os campos de dados retornados pelo procedimento armazenado são mapeados para o `ProductsDataTable` colunas s.</span><span class="sxs-lookup"><span data-stu-id="1b85e-192">The data fields returned by the stored procedure are mapped to the `ProductsDataTable` s columns.</span></span> <span data-ttu-id="1b85e-193">Já que há um `PriceQuartile` campo de dados retornados pelo procedimento armazenado, seu valor é atribuído para o `ProductsDataTable` s `PriceQuartile` coluna.</span><span class="sxs-lookup"><span data-stu-id="1b85e-193">Since there is a `PriceQuartile` data field returned from the stored procedure, its value is assigned to the `ProductsDataTable` s `PriceQuartile` column.</span></span>

<span data-ttu-id="1b85e-194">Para esses métodos do TableAdapter cujas consultas não retornam um `PriceQuartile` campo de dados, o `PriceQuartile` o valor da coluna s é o valor especificado por seu `DefaultValue` propriedade.</span><span class="sxs-lookup"><span data-stu-id="1b85e-194">For those TableAdapter methods whose queries do not return a `PriceQuartile` data field, the `PriceQuartile` column s value is the value specified by its `DefaultValue` property.</span></span> <span data-ttu-id="1b85e-195">Como mostra a Figura 2, esse valor é definido como `DBNull`, o padrão.</span><span class="sxs-lookup"><span data-stu-id="1b85e-195">As Figure 2 shows, this value is set to `DBNull`, the default.</span></span> <span data-ttu-id="1b85e-196">Se você desejar um valor padrão diferente, basta definir o `DefaultValue` propriedade adequadamente.</span><span class="sxs-lookup"><span data-stu-id="1b85e-196">If you would prefer a different default value, simply set the `DefaultValue` property accordingly.</span></span> <span data-ttu-id="1b85e-197">Apenas certifique-se de que o `DefaultValue` o valor é válido, dada a coluna s `DataType` (ou seja, `System.Int32` para o `PriceQuartile` coluna).</span><span class="sxs-lookup"><span data-stu-id="1b85e-197">Just make sure that the `DefaultValue` value is valid given the column s `DataType` (i.e., `System.Int32` for the `PriceQuartile` column).</span></span>

<span data-ttu-id="1b85e-198">Neste ponto, fizemos as etapas necessárias para adicionar uma coluna adicional a um DataTable.</span><span class="sxs-lookup"><span data-stu-id="1b85e-198">At this point we have performed the necessary steps for adding an additional column to a DataTable.</span></span> <span data-ttu-id="1b85e-199">Para verificar se essa coluna adicional funciona conforme o esperado, deixe s criar uma página ASP.NET que exibe cada s nome do produto, preço e quartil de preço.</span><span class="sxs-lookup"><span data-stu-id="1b85e-199">To verify that this additional column works as expected, let s create an ASP.NET page that displays each product s name, price, and price quartile.</span></span> <span data-ttu-id="1b85e-200">Antes de fazer isso, no entanto, primeiro precisamos atualizar a camada de lógica de negócios para incluir um método que chama para baixo para o s DAL `GetProductsWithPriceQuartile` método.</span><span class="sxs-lookup"><span data-stu-id="1b85e-200">Before we do that, though, we first need to update the Business Logic Layer to include a method that calls down to the DAL s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="1b85e-201">Vamos atualizar a BLL, em seguida, na etapa 3 e, em seguida, criar a página ASP.NET na etapa 4.</span><span class="sxs-lookup"><span data-stu-id="1b85e-201">We will update the BLL next, in Step 3, and then create the ASP.NET page in Step 4.</span></span>

## <a name="step-3-augmenting-the-business-logic-layer"></a><span data-ttu-id="1b85e-202">Etapa 3: Aumentando a camada de lógica de negócios</span><span class="sxs-lookup"><span data-stu-id="1b85e-202">Step 3: Augmenting the Business Logic Layer</span></span>

<span data-ttu-id="1b85e-203">Antes de usarmos o novo `GetProductsWithPriceQuartile` método da camada de apresentação, podemos deve primeiro adicionar um método correspondente para a BLL.</span><span class="sxs-lookup"><span data-stu-id="1b85e-203">Before we use the new `GetProductsWithPriceQuartile` method from the Presentation Layer, we should first add a corresponding method to the BLL.</span></span> <span data-ttu-id="1b85e-204">Abra o `ProductsBLLWithSprocs` arquivo de classe e adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="1b85e-204">Open the `ProductsBLLWithSprocs` class file and add the following code:</span></span>


[!code-vb[Main](adding-additional-datatable-columns-vb/samples/sample2.vb)]

<span data-ttu-id="1b85e-205">Como os outros métodos de recuperação de dados no `ProductsBLLWithSprocs`, o `GetProductsWithPriceQuartile` método simplesmente chama o DAL s correspondente `GetProductsWithPriceQuartile` método e retorna os resultados.</span><span class="sxs-lookup"><span data-stu-id="1b85e-205">Like the other data retrieval methods in `ProductsBLLWithSprocs`, the `GetProductsWithPriceQuartile` method simply calls the DAL s corresponding `GetProductsWithPriceQuartile` method and returns its results.</span></span>

## <a name="step-4-displaying-the-price-quartile-information-in-an-aspnet-web-page"></a><span data-ttu-id="1b85e-206">Etapa 4: Exibindo as informações de preço quartil em uma página da Web</span><span class="sxs-lookup"><span data-stu-id="1b85e-206">Step 4: Displaying the Price Quartile Information in an ASP.NET Web Page</span></span>

<span data-ttu-id="1b85e-207">Com a adição de BLL conclua, está pronto para criar uma página ASP.NET que mostra o quartil de preço para cada produto.</span><span class="sxs-lookup"><span data-stu-id="1b85e-207">With the BLL addition complete we re ready to create an ASP.NET page that shows the price quartile for each product.</span></span> <span data-ttu-id="1b85e-208">Abra o `AddingColumns.aspx` página na `AdvancedDAL` pasta e arraste um controle GridView da caixa de ferramentas para o Designer, definindo seu `ID` propriedade para `Products`.</span><span class="sxs-lookup"><span data-stu-id="1b85e-208">Open the `AddingColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="1b85e-209">Da GridView s marca inteligente, associá-lo a um novo ObjectDataSource chamado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1b85e-209">From the GridView s smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="1b85e-210">Configurar o ObjectDataSource para usar o `ProductsBLLWithSprocs` classe s `GetProductsWithPriceQuartile` método.</span><span class="sxs-lookup"><span data-stu-id="1b85e-210">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="1b85e-211">Já que isso será uma grade somente leitura, defina as listas suspensas na atualização, inserção e excluir guias como (nenhum).</span><span class="sxs-lookup"><span data-stu-id="1b85e-211">Since this will be a read-only grid, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="1b85e-212">[![Configurar o ObjectDataSource para usar a classe ProductsBLLWithSprocs](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="1b85e-212">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span></span>

<span data-ttu-id="1b85e-213">**Figura 9**: Configurar o ObjectDataSource para usar o `ProductsBLLWithSprocs` classe ([clique para exibir a imagem em tamanho normal](adding-additional-datatable-columns-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="1b85e-213">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image25.png))</span></span>


<span data-ttu-id="1b85e-214">[![Recuperar informações de produto do método GetProductsWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="1b85e-214">[![Retrieve Product Information from the GetProductsWithPriceQuartile Method](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span></span>

<span data-ttu-id="1b85e-215">**Figura 10**: Recuperar informações de produto a `GetProductsWithPriceQuartile` método ([clique para exibir a imagem em tamanho normal](adding-additional-datatable-columns-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="1b85e-215">**Figure 10**: Retrieve Product Information from the `GetProductsWithPriceQuartile` Method ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image28.png))</span></span>


<span data-ttu-id="1b85e-216">Depois de concluir o Assistente Configurar fonte de dados, o Visual Studio adicionará automaticamente um BoundField ou CheckBoxField a GridView para cada um dos campos de dados retornados pelo método.</span><span class="sxs-lookup"><span data-stu-id="1b85e-216">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the data fields returned by the method.</span></span> <span data-ttu-id="1b85e-217">Um desses campos de dados é `PriceQuartile`, que é a coluna são adicionadas a `ProductsDataTable` na etapa 1.</span><span class="sxs-lookup"><span data-stu-id="1b85e-217">One of these data fields is `PriceQuartile`, which is the column we added to the `ProductsDataTable` in Step 1.</span></span>

<span data-ttu-id="1b85e-218">Edite os campos de s GridView, remoção de tudo, exceto os `ProductName`, `UnitPrice`, e `PriceQuartile` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="1b85e-218">Edit the GridView s fields, removing all but the `ProductName`, `UnitPrice`, and `PriceQuartile` BoundFields.</span></span> <span data-ttu-id="1b85e-219">Configurar o `UnitPrice` BoundField para formatar seu valor como uma moeda e ter o `UnitPrice` e `PriceQuartile` BoundFields e center alinhado à direita, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="1b85e-219">Configure the `UnitPrice` BoundField to format its value as a currency and have the `UnitPrice` and `PriceQuartile` BoundFields right- and center-aligned, respectively.</span></span> <span data-ttu-id="1b85e-220">Por fim, atualize o BoundFields restantes `HeaderText` propriedades para o produto, preço e preço quartil, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="1b85e-220">Finally, update the remaining BoundFields `HeaderText` properties to Product, Price, and Price Quartile, respectively.</span></span> <span data-ttu-id="1b85e-221">Além disso, verifique a caixa de seleção Habilitar classificação da marca inteligente s GridView.</span><span class="sxs-lookup"><span data-stu-id="1b85e-221">Also, check the Enable Sorting checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="1b85e-222">Após essas modificações, GridView e ObjectDataSource s marcação declarativa deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="1b85e-222">After these modifications, the GridView and ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-additional-datatable-columns-vb/samples/sample3.aspx)]

<span data-ttu-id="1b85e-223">Figura 11 mostra essa página quando acessadas por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="1b85e-223">Figure 11 shows this page when visited through a browser.</span></span> <span data-ttu-id="1b85e-224">Observe que, inicialmente, os produtos são ordenados por seu preço em ordem decrescente com cada produto atribuído apropriado `PriceQuartile` valor.</span><span class="sxs-lookup"><span data-stu-id="1b85e-224">Note that, initially, the products are ordered by their price in descending order with each product assigned an appropriate `PriceQuartile` value.</span></span> <span data-ttu-id="1b85e-225">É claro esses dados podem ser classificados por outros critérios com o valor da coluna preço quartil ainda refletindo a classificação de produto s em relação ao preço (veja a Figura 12).</span><span class="sxs-lookup"><span data-stu-id="1b85e-225">Of course this data can be sorted by other criteria with the Price Quartile column value still reflecting the product s ranking with respect to price (see Figure 12).</span></span>


<span data-ttu-id="1b85e-226">[![Os produtos são ordenados por seus preços](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="1b85e-226">[![The Products are Ordered by their Prices](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span></span>

<span data-ttu-id="1b85e-227">**Figura 11**: Os produtos são ordenados por seus preços ([clique para exibir a imagem em tamanho normal](adding-additional-datatable-columns-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="1b85e-227">**Figure 11**: The Products are Ordered by their Prices ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image31.png))</span></span>


<span data-ttu-id="1b85e-228">[![Os produtos são ordenados por seus nomes](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="1b85e-228">[![The Products are Ordered by their Names](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span></span>

<span data-ttu-id="1b85e-229">**Figura 12**: Os produtos são ordenados por seus nomes ([clique para exibir a imagem em tamanho normal](adding-additional-datatable-columns-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="1b85e-229">**Figure 12**: The Products are Ordered by their Names ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image34.png))</span></span>


> [!NOTE]
> <span data-ttu-id="1b85e-230">Com algumas linhas de código nós poderia ampliamos o GridView, de modo que ele coloridos as linhas de produto com base em suas `PriceQuartile` valor.</span><span class="sxs-lookup"><span data-stu-id="1b85e-230">With a few lines of code we could augment the GridView so that it colored the product rows based on their `PriceQuartile` value.</span></span> <span data-ttu-id="1b85e-231">Podemos pode colorir os produtos em que o primeiro quartil uma luz verde, aqueles em que o segundo quartil um amarelo-claro e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="1b85e-231">We might color those products in the first quartile a light green, those in the second quartile a light yellow, and so forth.</span></span> <span data-ttu-id="1b85e-232">Eu recomendo que você reserve um tempo para adicionar essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="1b85e-232">I encourage you to take a moment to add this functionality.</span></span> <span data-ttu-id="1b85e-233">Se você precisar de um lembrete sobre a formatação de um GridView, consulte o [formatação com base em dados personalizados](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="1b85e-233">If you need a refresher on formatting a GridView, consult the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>


## <a name="an-alternative-approach---creating-another-tableadapter"></a><span data-ttu-id="1b85e-234">Uma abordagem alternativa - criando outro TableAdapter</span><span class="sxs-lookup"><span data-stu-id="1b85e-234">An Alternative Approach - Creating Another TableAdapter</span></span>

<span data-ttu-id="1b85e-235">Como vimos neste tutorial, quando adicionar um método para um TableAdapter que retorna os campos de dados que não sejam aqueles indicados claramente pela consulta principal, podemos adicionar colunas correspondentes à DataTable.</span><span class="sxs-lookup"><span data-stu-id="1b85e-235">As we saw in this tutorial, when adding a method to a TableAdapter that returns data fields other than those spelled out by the main query, we can add corresponding columns to the DataTable.</span></span> <span data-ttu-id="1b85e-236">Essa abordagem, entretanto, funciona bem apenas se há um pequeno número de métodos no TableAdapter que retornam campos de dados diferentes e se esses campos de dados alternativo não variam muito da consulta principal.</span><span class="sxs-lookup"><span data-stu-id="1b85e-236">Such an approach, however, works well only if there are a small number of methods in the TableAdapter that return different data fields and if those alternate data fields do not vary too much from the main query.</span></span>

<span data-ttu-id="1b85e-237">Em vez de adicionar colunas à tabela de dados, você pode adicionar outro TableAdapter ao conjunto de dados que contém os métodos do TableAdapter primeiro que retornam campos de dados diferentes.</span><span class="sxs-lookup"><span data-stu-id="1b85e-237">Rather than adding columns to the DataTable, you can instead add another TableAdapter to the DataSet that contains the methods from the first TableAdapter that return different data fields.</span></span> <span data-ttu-id="1b85e-238">Para este tutorial, em vez de adicionar o `PriceQuartile` coluna para o `ProductsDataTable` (onde ele é usado somente pela `GetProductsWithPriceQuartile` método), poderia que adicionamos um TableAdapter adicional ao conjunto de dados denominado `ProductsWithPriceQuartileTableAdapter` que é usado o `Products_SelectWithPriceQuartile` armazenados procedimento como sua consulta principal.</span><span class="sxs-lookup"><span data-stu-id="1b85e-238">For this tutorial, rather than add the `PriceQuartile` column to the `ProductsDataTable` (where it is only used by the `GetProductsWithPriceQuartile` method), we could have added an additional TableAdapter to the DataSet named `ProductsWithPriceQuartileTableAdapter` that used the `Products_SelectWithPriceQuartile` stored procedure as its main query.</span></span> <span data-ttu-id="1b85e-239">Páginas ASP.NET que são necessárias para obter informações sobre o produto com o quartil preço seriam usar a `ProductsWithPriceQuartileTableAdapter`, enquanto aqueles que não foi possível continuar a usar o `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="1b85e-239">ASP.NET pages that needed to get product information with the price quartile would use the `ProductsWithPriceQuartileTableAdapter`, while those that did not could continue to use the `ProductsTableAdapter`.</span></span>

<span data-ttu-id="1b85e-240">Adicionando um novo TableAdapter, as tabelas de dados permanecem untarnished e suas colunas refletem com precisão os campos de dados retornados por seus métodos do TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="1b85e-240">By adding a new TableAdapter, the DataTables remain untarnished and their columns precisely mirror the data fields returned by their TableAdapter s methods.</span></span> <span data-ttu-id="1b85e-241">No entanto, TableAdapters adicionais pode apresentar funcionalidade e as tarefas repetitivas.</span><span class="sxs-lookup"><span data-stu-id="1b85e-241">However, additional TableAdapters can introduce repetitive tasks and functionality.</span></span> <span data-ttu-id="1b85e-242">Por exemplo, se esses de páginas ASP.NET que é exibido o `PriceQuartile` coluna também necessário para fornecer a inserção, atualização e exclusão suporte, o `ProductsWithPriceQuartileTableAdapter` precisaria ter seu `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades corretamente configurado.</span><span class="sxs-lookup"><span data-stu-id="1b85e-242">For example, if those ASP.NET pages that displayed the `PriceQuartile` column also needed to provide insert, update, and delete support, the `ProductsWithPriceQuartileTableAdapter` would need to have its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties properly configured.</span></span> <span data-ttu-id="1b85e-243">Embora essas propriedades espelharia o `ProductsTableAdapter` s, essa configuração apresenta uma etapa extra.</span><span class="sxs-lookup"><span data-stu-id="1b85e-243">While these properties would mirror the `ProductsTableAdapter` s, this configuration introduces an extra step.</span></span> <span data-ttu-id="1b85e-244">Além disso, agora há duas maneiras de atualizar, excluir ou adicionar um produto no banco de dados - por meio de `ProductsTableAdapter` e `ProductsWithPriceQuartileTableAdapter` classes.</span><span class="sxs-lookup"><span data-stu-id="1b85e-244">Moreover, there are now two ways to update, delete, or add a product to the database - through the `ProductsTableAdapter` and `ProductsWithPriceQuartileTableAdapter` classes.</span></span>

<span data-ttu-id="1b85e-245">O download para este tutorial inclui um `ProductsWithPriceQuartileTableAdapter` classe o `NorthwindWithSprocs` conjunto de dados que ilustra essa abordagem alternativa.</span><span class="sxs-lookup"><span data-stu-id="1b85e-245">The download for this tutorial includes a `ProductsWithPriceQuartileTableAdapter` class in the `NorthwindWithSprocs` DataSet that illustrates this alternative approach.</span></span>

## <a name="summary"></a><span data-ttu-id="1b85e-246">Resumo</span><span class="sxs-lookup"><span data-stu-id="1b85e-246">Summary</span></span>

<span data-ttu-id="1b85e-247">Na maioria dos cenários, todos os métodos em um TableAdapter retornará o mesmo conjunto de campos de dados, mas há vezes quando um método específico ou dois podem precisar retornar um campo adicional.</span><span class="sxs-lookup"><span data-stu-id="1b85e-247">In most scenarios, all of the methods in a TableAdapter will return the same set of data fields, but there are times when a particular method or two may need to return an additional field.</span></span> <span data-ttu-id="1b85e-248">Por exemplo, no [mestre/detalhes usando uma lista com marcadores de registros de mestre com um DataList de detalhes](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial adicionamos um método para o `CategoriesTableAdapter` que, além dos campos de dados de consulta principal s retornados um `NumberOfProducts` campo que relatou o número de produtos associados a cada categoria.</span><span class="sxs-lookup"><span data-stu-id="1b85e-248">For example, in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that, in addition to the main query s data fields, returned a `NumberOfProducts` field that reported the number of products associated with each category.</span></span> <span data-ttu-id="1b85e-249">Neste tutorial vimos adicionando um método na `ProductsTableAdapter` que retornou um `PriceQuartile` campo além dos campos de dados de consulta principal s.</span><span class="sxs-lookup"><span data-stu-id="1b85e-249">In this tutorial we looked at adding a method in the `ProductsTableAdapter` that returned a `PriceQuartile` field in addition to the main query s data fields.</span></span> <span data-ttu-id="1b85e-250">Para capturar dados adicionais campos retornados pelos métodos TableAdapter s, precisamos adicionar colunas correspondentes à DataTable.</span><span class="sxs-lookup"><span data-stu-id="1b85e-250">To capture additional data fields returned by the TableAdapter s methods we need to add corresponding columns to the DataTable.</span></span>

<span data-ttu-id="1b85e-251">Se você planeja manualmente adicionando colunas à tabela de dados, é recomendável que o TableAdapter usar procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="1b85e-251">If you plan on manually adding columns to the DataTable, it is recommended that the TableAdapter use stored procedures.</span></span> <span data-ttu-id="1b85e-252">Se o TableAdapter usa instruções SQL ad hoc, sempre que o Assistente de configuração do TableAdapter é executado todos os métodos de listas de campo de dados é revertido para os campos de dados retornados pela consulta principal.</span><span class="sxs-lookup"><span data-stu-id="1b85e-252">If the TableAdapter uses ad-hoc SQL statements, any time the TableAdapter Configuration wizard is run all of the methods data field lists revert to the data fields returned by the main query.</span></span> <span data-ttu-id="1b85e-253">Esse problema não se estende aos procedimentos armazenados, por isso, eles são recomendados e foram usados neste tutorial.</span><span class="sxs-lookup"><span data-stu-id="1b85e-253">This problem does not extend to stored procedures, which is why they are recommended and were used in this tutorial.</span></span>

<span data-ttu-id="1b85e-254">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="1b85e-254">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="1b85e-255">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="1b85e-255">About the Author</span></span>

<span data-ttu-id="1b85e-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="1b85e-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1b85e-257">Scott funciona como um consultor independente, instrutor e escritor.</span><span class="sxs-lookup"><span data-stu-id="1b85e-257">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1b85e-258">Seu livro mais recente é [ *Sams Teach por conta própria ASP.NET 2.0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="1b85e-258">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1b85e-259">Ele pode ser contatado pelo [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1b85e-259">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1b85e-260">ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="1b85e-260">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="1b85e-261">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="1b85e-261">Special Thanks To</span></span>

<span data-ttu-id="1b85e-262">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="1b85e-262">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="1b85e-263">Revisores líder para este tutorial foram Randy Schmidt, Goor Jacky, Bernadette Leigh e Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="1b85e-263">Lead reviewers for this tutorial were Randy Schmidt, Jacky Goor, Bernadette Leigh, and Hilton Giesenow.</span></span> <span data-ttu-id="1b85e-264">Você está interessado na revisão Meus próximos artigos do MSDN?</span><span class="sxs-lookup"><span data-stu-id="1b85e-264">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="1b85e-265">Nesse caso, me descartar uma linha na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1b85e-265">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1b85e-266">[Anterior](updating-the-tableadapter-to-use-joins-vb.md)
> [Próximo](working-with-computed-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="1b85e-266">[Previous](updating-the-tableadapter-to-use-joins-vb.md)
[Next](working-with-computed-columns-vb.md)</span></span>
