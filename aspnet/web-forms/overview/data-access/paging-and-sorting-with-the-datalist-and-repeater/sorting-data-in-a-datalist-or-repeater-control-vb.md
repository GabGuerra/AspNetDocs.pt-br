---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-vb
title: Classificando dados em um controle DataList ou Repeater (VB) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, examinaremos como incluir a classificação de suporte no DataList e Repeater, bem como construir um DataList ou Repeater cujos dados podem...
ms.author: riande
ms.date: 11/13/2006
ms.assetid: 97c13898-0741-45f9-b3fa-7540ab1679e6
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-vb
msc.type: authoredcontent
ms.openlocfilehash: ad940afd03b66c17a4d8b1e5c727c317022fbc0a
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57040973"
---
<a name="sorting-data-in-a-datalist-or-repeater-control-vb"></a><span data-ttu-id="5f5ab-103">Classificação de dados em um controle DataList ou Repeater (VB)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-103">Sorting Data in a DataList or Repeater Control (VB)</span></span>
====================
<span data-ttu-id="5f5ab-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5f5ab-105">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_VB.exe) ou [baixar PDF](sorting-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial45vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_VB.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial45vb1.pdf)</span></span>

> <span data-ttu-id="5f5ab-106">Neste tutorial, examinaremos como incluir a classificação de suporte no DataList e Repeater, bem como construir um DataList ou Repeater cujos dados podem ser paginados e classificados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>


## <a name="introduction"></a><span data-ttu-id="5f5ab-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="5f5ab-107">Introduction</span></span>

<span data-ttu-id="5f5ab-108">No [tutorial anterior](paging-report-data-in-a-datalist-or-repeater-control-vb.md) , examinamos como adicionar suporte à paginação para uma DataList.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-vb.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="5f5ab-109">Criamos um novo método na `ProductsBLL` classe (`GetProductsAsPagedDataSource`) que retornou um `PagedDataSource` objeto.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="5f5ab-110">Quando associado a um DataList ou Repeater, o DataList ou Repeater exibiria apenas a página solicitada de dados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="5f5ab-111">Essa técnica é semelhante ao que é usado internamente pelos controles GridView, DetailsView e FormView para fornecer a funcionalidade de paginação internos padrão.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="5f5ab-112">Além de oferecer suporte à paginação, GridView também inclui fora da caixa de suporte à classificação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="5f5ab-113">Nem o DataList nem Repeater fornece funcionalidade interna de classificação; No entanto, os recursos de classificação pode ser adicionado com um pouco de código.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="5f5ab-114">Neste tutorial, examinaremos como incluir a classificação de suporte no DataList e Repeater, bem como construir um DataList ou Repeater cujos dados podem ser paginados e classificados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="5f5ab-115">Uma revisão de classificação</span><span class="sxs-lookup"><span data-stu-id="5f5ab-115">A Review of Sorting</span></span>

<span data-ttu-id="5f5ab-116">Como vimos na [paginação e classificação de dados do relatório](../paging-and-sorting/paging-and-sorting-report-data-vb.md) tutorial, o controle GridView fornece fora da caixa de suporte à classificação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-vb.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="5f5ab-117">Cada campo de GridView pode ter um tipo de `SortExpression`, que indica o campo de dados pela qual classificar os dados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="5f5ab-118">Quando o s GridView `AllowSorting` estiver definida como `true`, cada campo de GridView que tem um `SortExpression` valor da propriedade tem seu cabeçalho renderizado como um LinkButton.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="5f5ab-119">Quando um usuário clica em um cabeçalho de s de campo específico do GridView, ocorre um postback e os dados são classificados de acordo com o campo clicado s `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="5f5ab-120">O controle GridView possui um `SortExpression` propriedade também, que armazena o `SortExpression` do campo de GridView, os dados são classificados por.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="5f5ab-121">Além disso, um `SortDirection` propriedade indica se os dados são seja classificada em ordem crescente ou decrescente (se um usuário clica em um determinado link de cabeçalho de campo s GridView duas vezes em sucessão, a ordem de classificação é alternado).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="5f5ab-122">Quando o GridView está associado a seu controle de fonte de dados, ele transmite sua `SortExpression` e `SortDirection` propriedades aos dados de controle de origem.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="5f5ab-123">O controle de fonte de dados recupera os dados e, em seguida, classifica-o acordo com os fornecidos `SortExpression` e `SortDirection` propriedades.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="5f5ab-124">Depois de classificar os dados, o controle de fonte de dados retorna-a GridView.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="5f5ab-125">Para replicar essa funcionalidade com os controles DataList ou Repeater, devemos:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="5f5ab-126">Criar uma interface de classificação</span><span class="sxs-lookup"><span data-stu-id="5f5ab-126">Create a sorting interface</span></span>
- <span data-ttu-id="5f5ab-127">Lembre-se o campo de dados para classificar por e se deve classificar em ordem crescente ou decrescente</span><span class="sxs-lookup"><span data-stu-id="5f5ab-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="5f5ab-128">Instrua o ObjectDataSource para classificar os dados por um campo de dados específico</span><span class="sxs-lookup"><span data-stu-id="5f5ab-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="5f5ab-129">Que abordaremos esses três tarefas nas etapas 3 e 4.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="5f5ab-130">Depois disso, vamos examinar como incluir tanto de paginação e classificação de suporte em um DataList ou Repeater.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="5f5ab-131">Etapa 2: Exibindo os produtos em um repetidor</span><span class="sxs-lookup"><span data-stu-id="5f5ab-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="5f5ab-132">Antes de nos preocupamos implementar qualquer uma das funcionalidades relacionadas à classificação, deixe s começar listando os produtos em um controle Repeater.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="5f5ab-133">Comece abrindo o `Sorting.aspx` página o `PagingSortingDataListRepeater` pasta.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="5f5ab-134">Adicionar um controle Repeater para a página da web, definindo sua `ID` propriedade para `SortableProducts`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="5f5ab-135">De marca inteligente Repeater s, crie um novo ObjectDataSource denominado `ProductsDataSource` e configurá-lo para recuperar dados, o `ProductsBLL` classe s `GetProducts()` método.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="5f5ab-136">Selecione a que opção das listas suspensas nas guias de INSERT, UPDATE e DELETE (nenhum).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>


<span data-ttu-id="5f5ab-137">[![Criar um ObjectDataSource e configurá-lo para usar o método GetProductsAsPagedDataSource()](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)</span></span>

<span data-ttu-id="5f5ab-138">**Figura 1**: Criar um ObjectDataSource e configurá-lo para usar o `GetProductsAsPagedDataSource()` método ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image3.png))</span></span>


<span data-ttu-id="5f5ab-139">[![Defina a lista suspensa na atualização, inserção e excluir guias como (nenhum)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image4.png)</span></span>

<span data-ttu-id="5f5ab-140">**Figura 2**: Defina a lista suspensa na atualização, inserção e excluir guias como (nenhum) ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image6.png))</span></span>


<span data-ttu-id="5f5ab-141">Ao contrário de com DataList, o Visual Studio não cria automaticamente um `ItemTemplate` para o controle Repeater depois de associá-lo a uma fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="5f5ab-142">Além disso, devemos adicionar isso `ItemTemplate` declarativamente, como a marca inteligente do repetidor controle s não tem a opção de editar modelos encontrada no DataList s.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="5f5ab-143">Let s usam o mesmo `ItemTemplate` no tutorial anterior, a que é exibido o nome do produto s, fornecedor e categoria.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="5f5ab-144">Depois de adicionar o `ItemTemplate`, Repeater e ObjectDataSource s marcação declarativa deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample1.aspx)]

<span data-ttu-id="5f5ab-145">Figura 3 mostra essa página quando visualizado por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-145">Figure 3 shows this page when viewed through a browser.</span></span>


<span data-ttu-id="5f5ab-146">[![Cada produto s nome, categoria e fornecedor é exibido](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span></span>

<span data-ttu-id="5f5ab-147">**Figura 3**: Cada nome de produto, fornecedor e categoria é exibida ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span></span>


## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="5f5ab-148">Etapa 3: Instruindo o ObjectDataSource para classificar os dados</span><span class="sxs-lookup"><span data-stu-id="5f5ab-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="5f5ab-149">Para classificar os dados exibidos no repetidor, precisamos informar o ObjectDataSource da expressão de classificação pelo qual os dados devem ser classificados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="5f5ab-150">Antes do ObjectDataSource recupera seus dados, primeiro acionará seu [ `Selecting` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), que fornece uma oportunidade especificar uma expressão de classificação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="5f5ab-151">O `Selecting` manipulador de eventos recebe um objeto do tipo [ `ObjectDataSourceSelectingEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), que tem uma propriedade chamada [ `Arguments` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) do tipo [ `DataSourceSelectArguments` ](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="5f5ab-152">O `DataSourceSelectArguments` classe foi projetada para passar as solicitações relacionadas a dados de um consumidor de dados para o controle de fonte de dados e inclui um [ `SortExpression` propriedade](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="5f5ab-153">Para passar informações de classificação da página ASP.NET para o ObjectDataSource, crie um manipulador de eventos para o `Selecting` evento e use o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample2.vb)]

<span data-ttu-id="5f5ab-154">O *sortExpression* valor deve ser atribuído como o nome do campo de dados para classificar os dados por (como ProductName).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="5f5ab-155">Não há nenhuma propriedade relacionada a direção de classificação, portanto, se você quiser classificar os dados em ordem decrescente, acrescente a cadeia de caracteres DESC para o *sortExpression* valor (como ProductName DESC).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="5f5ab-156">Vá em frente e experimente alguns valores embutidos diferentes para *sortExpression* e testar os resultados em um navegador.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="5f5ab-157">Como mostra a Figura 4, ao usar ProductName DESC como o *sortExpression*, os produtos são classificados por nome em ordem alfabética inversa.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>


<span data-ttu-id="5f5ab-158">[![Os produtos são classificados por nome em ordem alfabética inversa](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span></span>

<span data-ttu-id="5f5ab-159">**Figura 4**: Os produtos são classificados por nome em ordem alfabética inversa ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span></span>


## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="5f5ab-160">Etapa 4: Criando a Interface de classificação e lembrar-se a expressão de classificação e a direção</span><span class="sxs-lookup"><span data-stu-id="5f5ab-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="5f5ab-161">Ativar o suporte de GridView de classificação converte o texto do cabeçalho cada campo classificável s em um LinkButton que, quando clicado, classifica os dados adequadamente.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="5f5ab-162">Uma interface desse tipo classificação faz sentido para o GridView, onde seus dados é claramente dispostos em colunas.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="5f5ab-163">Para os controles DataList e Repeater, no entanto, é necessária uma interface de classificação diferente.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="5f5ab-164">Uma interface comum de classificação para obter uma lista de dados (em vez de uma grade de dados), é uma lista suspensa que fornece os campos pelos quais os dados podem ser classificados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="5f5ab-165">Deixe o s implementar uma interface desse tipo para este tutorial.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="5f5ab-166">Adicionar um controle DropDownList da Web acima a `SortableProducts` Repeater e defina seu `ID` propriedade `SortBy`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="5f5ab-167">Na janela Propriedades, clique nas reticências no `Items` propriedade para transferir anterior o Editor de coleção ListItem.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="5f5ab-168">Adicione `ListItem` s para classificar os dados pela `ProductName`, `CategoryName`, e `SupplierName` campos.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="5f5ab-169">Adicione também um `ListItem` para classificar os produtos por seu nome em ordem alfabética inversa.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="5f5ab-170">O `ListItem` `Text` propriedades podem ser definidas para qualquer valor (como nome), mas o `Value` propriedades devem ser definidas para o nome do campo de dados (como ProductName).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="5f5ab-171">Para classificar os resultados em ordem decrescente, acrescente a cadeia de caracteres DESC para o nome do campo de dados, como ProductName DESC.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>


![Adicionar um item de lista para cada um dos campos de dados classificável](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image13.png)

<span data-ttu-id="5f5ab-173">**Figura 5**: Adicionar um `ListItem` para cada um dos campos de dados classificável</span><span class="sxs-lookup"><span data-stu-id="5f5ab-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>


<span data-ttu-id="5f5ab-174">Finalmente, adicione um controle da Web de botão à direita da DropDownList.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="5f5ab-175">Defina suas `ID` para `RefreshRepeater` e seu `Text` propriedade para a atualização.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="5f5ab-176">Depois de criar o `ListItem` s e adicionar o botão de atualização, a sintaxe declarativa de s do DropDownList e botão deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample3.aspx)]

<span data-ttu-id="5f5ab-177">Com a classificação DropDownList completa, em seguida precisamos atualizar o s ObjectDataSource `Selecting` manipulador de eventos, por isso que ele usa o selecionado `SortBy``ListItem` s `Value` propriedade em vez de uma expressão de classificação embutido em código.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample4.vb)]

<span data-ttu-id="5f5ab-178">Neste ponto, quando o primeiro visitando a página de produtos inicialmente serão classificados pela `ProductName` campo de dados, como ela s a `SortBy` `ListItem` selecionada por padrão (veja a Figura 6).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="5f5ab-179">Selecionando a opção, como a categoria de classificação um diferentes e você clicar em atualizar, fazer com que um postback e reclassifica os dados pelo nome da categoria, como mostra a Figura 7.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>


<span data-ttu-id="5f5ab-180">[![Os produtos são inicialmente classificadas por seu nome](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)</span></span>

<span data-ttu-id="5f5ab-181">**Figura 6**: Os produtos são inicialmente classificadas por seu nome ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image16.png))</span></span>


<span data-ttu-id="5f5ab-182">[![Os produtos são agora são classificados por categoria](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)</span></span>

<span data-ttu-id="5f5ab-183">**Figura 7**: Os produtos são agora são classificados por categoria ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="5f5ab-184">Clicar no botão de atualização faz com que os dados automaticamente sejam classificados novamente porque o estado de exibição do repetidor s foi desabilitado, causando assim o Repeater reassociar a fonte de dados em cada postagem.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="5f5ab-185">Se você ve deixado o estado de exibição do repetidor s habilitado, alterar a classificação de lista suspensa lista ganhou um t tenha qualquer efeito sobre a ordem de classificação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won t have any affect on the sort order.</span></span> <span data-ttu-id="5f5ab-186">Para corrigir isso, crie um manipulador de eventos para o botão Atualizar s `Click` reassociar o Repeater para sua fonte de dados e eventos (chamando o Repeater s `DataBind()` método).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>


## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="5f5ab-187">Lembrar-se a expressão de classificação e a direção</span><span class="sxs-lookup"><span data-stu-id="5f5ab-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="5f5ab-188">Ao criar um classificável DataList ou Repeater em uma página em que o não-classificação relacionados a postbacks podem ocorrer, ele imperativa de s que a expressão de classificação e a direção ser lembrados entre postbacks.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="5f5ab-189">Por exemplo, imagine que atualizamos o Repeater neste tutorial para incluir um botão Excluir em cada produto.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="5f5ab-190">Quando o usuário clica no botão Excluir d executamos algum código para excluir o produto selecionado e, em seguida, associar novamente os dados a serem Repetidor.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="5f5ab-191">Se os detalhes de classificação não são persistidos em postback, os dados exibidos na tela serão revertido para a ordem de classificação originais.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="5f5ab-192">Para este tutorial, DropDownList implicitamente salva a classificação expressão e direção em seu estado de exibição para nós.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="5f5ab-193">Se estivéssemos usando uma interface de classificação diferente, uma com, digamos, de LinkButtons que forneceu as várias opções de classificação d é necessário tomar cuidado para lembrar a ordem de classificação entre postbacks.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="5f5ab-194">Isso pode ser feito ao armazenar os parâmetros de classificação no estado de exibição de página s, incluindo o parâmetro de classificação na querystring, ou por meio de alguma outra técnica de persistência de estado.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="5f5ab-195">Futuras exemplos neste tutorial exploram como manter os detalhes de classificação no estado de exibição de s de página.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="5f5ab-196">Etapa 5: Adicionando suporte à classificação para uma DataList que usa paginação padrão</span><span class="sxs-lookup"><span data-stu-id="5f5ab-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="5f5ab-197">No [tutorial anterior](paging-report-data-in-a-datalist-or-repeater-control-vb.md) , examinamos como implementar a paginação padrão com um DataList.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-vb.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="5f5ab-198">Deixe o s estender este exemplo anterior para incluir a capacidade de classificar os dados paginados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="5f5ab-199">Comece abrindo o `SortingWithDefaultPaging.aspx` e `Paging.aspx` páginas no `PagingSortingDataListRepeater` pasta.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="5f5ab-200">Do `Paging.aspx` , clique no botão fonte para exibir a marcação declarativa de s de página.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="5f5ab-201">Copie o texto selecionado (consulte a Figura 8) e cole-o na marcação declarativa de `SortingWithDefaultPaging.aspx` entre o `<asp:Content>` marcas.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>


<span data-ttu-id="5f5ab-202">[![Replicar a marcação declarativa na &lt;asp: Content&gt; marcas de Paging.aspx para SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)</span></span>

<span data-ttu-id="5f5ab-203">**Figura 8**: Replicar a marcação declarativa na `<asp:Content>` marcas da `Paging.aspx` ao `SortingWithDefaultPaging.aspx` ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image22.png))</span></span>


<span data-ttu-id="5f5ab-204">Depois de copiar a marcação declarativa, copie os métodos e propriedades na `Paging.aspx` página de classe code-behind de s para a classe code-behind para `SortingWithDefaultPaging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="5f5ab-205">Em seguida, reserve um tempo para exibir o `SortingWithDefaultPaging.aspx` página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="5f5ab-206">Ele deve exibir a mesma funcionalidade e a mesma aparência que `Paging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="5f5ab-207">Aprimorando ProductsBLL para incluir um padrão de paginação e classificação de método</span><span class="sxs-lookup"><span data-stu-id="5f5ab-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="5f5ab-208">No tutorial anterior, criamos uma `GetProductsAsPagedDataSource(pageIndex, pageSize)` método na `ProductsBLL` classe que retornou um `PagedDataSource` objeto.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="5f5ab-209">Isso `PagedDataSource` objeto foi preenchido com *todas as* dos produtos (via o s BLL `GetProducts()` método), mas quando associado à DataList somente os registros correspondentes especificado *pageIndex* e *pageSize* parâmetros de entrada foram exibidos.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="5f5ab-210">Neste tutorial, adicionamos suporte à classificação, especificando a expressão de classificação de s ObjectDataSource `Selecting` manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="5f5ab-211">Isso funciona bem quando o ObjectDataSource é retornado um objeto que pode ser classificado, como o `ProductsDataTable` retornado pelo `GetProducts()` método.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="5f5ab-212">No entanto, o `PagedDataSource` objeto retornado pelo `GetProductsAsPagedDataSource` método não dá suporte a classificação de fonte de dados interna.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="5f5ab-213">Em vez disso, é necessário classificar os resultados retornados do `GetProducts()` método *antes de* colocamos no `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="5f5ab-214">Para fazer isso, crie um novo método na `ProductsBLL` classe, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="5f5ab-215">Para classificar os `ProductsDataTable` retornado pelo `GetProducts()` método, especifique a `Sort` propriedade do seu padrão `DataTableView`:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample5.vb)]

<span data-ttu-id="5f5ab-216">O `GetProductsSortedAsPagedDataSource` método difere apenas ligeiramente do `GetProductsAsPagedDataSource` método criado no tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="5f5ab-217">Em particular, `GetProductsSortedAsPagedDataSource` aceita um parâmetro de entrada adicional `sortExpression` e atribui esse valor para o `Sort` propriedade o `ProductDataTable` s `DefaultView`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="5f5ab-218">Algumas linhas de código mais tarde, o `PagedDataSource` s fonte de dados de objeto é atribuído a `ProductDataTable` s `DefaultView`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="5f5ab-219">Chamar o método GetProductsSortedAsPagedDataSource e especificando o valor para o parâmetro de entrada SortExpression</span><span class="sxs-lookup"><span data-stu-id="5f5ab-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="5f5ab-220">Com o `GetProductsSortedAsPagedDataSource` método completo, a próxima etapa é fornecer o valor para esse parâmetro.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="5f5ab-221">O ObjectDataSource na `SortingWithDefaultPaging.aspx` está configurado para chamar o `GetProductsAsPagedDataSource` método e passa em dois parâmetros de entrada por meio de seus dois `QueryStringParameters`, que são especificados o `SelectParameters` coleção.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="5f5ab-222">Essas duas `QueryStringParameters` indicar que a origem para o `GetProductsAsPagedDataSource` método s *pageIndex* e *pageSize* parâmetros vêm os campos de cadeia de consulta `pageIndex` e `pageSize`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="5f5ab-223">Atualizar o s ObjectDataSource `SelectMethod` propriedade para que ele chama o novo `GetProductsSortedAsPagedDataSource` método.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="5f5ab-224">Em seguida, adicione um novo `QueryStringParameter` para que o *sortExpression* parâmetro de entrada é acessado no campo querystring `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="5f5ab-225">Defina as `QueryStringParameter` s `DefaultValue` para ProductName.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="5f5ab-226">Após essas alterações, a marcação declarativa do ObjectDataSource s deve ser semelhante:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample6.aspx)]

<span data-ttu-id="5f5ab-227">Neste ponto, o `SortingWithDefaultPaging.aspx` página será classificar seus resultados em ordem alfabética pelo nome do produto (veja a Figura 9).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="5f5ab-228">Isso ocorre porque, por padrão, um valor de ProductName é passado como o `GetProductsSortedAsPagedDataSource` método s *sortExpression* parâmetro.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>


<span data-ttu-id="5f5ab-229">[![Por padrão, os resultados são classificados por ProductName](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)</span></span>

<span data-ttu-id="5f5ab-230">**Figura 9**: Por padrão, os resultados são classificados por `ProductName` ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image25.png))</span></span>


<span data-ttu-id="5f5ab-231">Se você adicionar manualmente uma `sortExpression` campo de cadeia de consulta, como `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` os resultados serão classificados pelo `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="5f5ab-232">No entanto, isso `sortExpression` parâmetro não está incluído na querystring ao mudar para uma página de dados diferente.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="5f5ab-233">Na verdade, clicando na página do próximo ou último botões usa nós de volta para `Paging.aspx`!</span><span class="sxs-lookup"><span data-stu-id="5f5ab-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="5f5ab-234">Além disso, s há atualmente nenhuma classificação de interface.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="5f5ab-235">É a única maneira de que um usuário pode alterar a ordem de classificação dos dados paginados pela manipulação de cadeia de consulta diretamente.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="5f5ab-236">Criando a Interface de classificação</span><span class="sxs-lookup"><span data-stu-id="5f5ab-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="5f5ab-237">Primeiro, precisamos atualizar o `RedirectUser` método para enviar ao usuário `SortingWithDefaultPaging.aspx` (em vez de `Paging.aspx`) e incluir o `sortExpression` valor na cadeia de consulta.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="5f5ab-238">Podemos também deve adicionar um somente leitura, nível de página chamado `SortExpression` propriedade.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="5f5ab-239">Essa propriedade, semelhante à `PageIndex` e `PageSize` propriedades criadas no tutorial anterior, retorna o valor da `sortExpression` querystring campo se ele existir e o padrão de valor (ProductName) caso contrário.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="5f5ab-240">Atualmente, o `RedirectUser` método aceita apenas um único parâmetro de entrada de índice da página para exibir.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="5f5ab-241">No entanto, pode haver ocasiões em que é útil para redirecionar o usuário para uma determinada página de dados usando uma expressão de classificação que não seja o que é especificado na cadeia de consulta.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="5f5ab-242">Em alguns instantes, criaremos a interface de classificação para essa página, que inclui uma série de controles da Web de botão para classificar os dados por uma coluna especificada.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="5f5ab-243">Quando um desses botões é clicado, queremos que redirecionará o usuário passando o valor da expressão de classificação apropriado.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="5f5ab-244">Para fornecer essa funcionalidade, crie duas versões do `RedirectUser` método.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="5f5ab-245">O primeiro deles deverá aceitar apenas o índice de página para exibir, enquanto o segundo é aceita a expressão de índice e de classificação de página.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample7.vb)]

<span data-ttu-id="5f5ab-246">No primeiro exemplo neste tutorial, criamos uma interface de classificação usando DropDownList.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="5f5ab-247">Neste exemplo, let s usar três controles da Web de botão posicionados acima uma DataList para classificar por `ProductName`, um para `CategoryName`e outro para `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="5f5ab-248">Adicione três controles da Web de botão, definindo sua `ID` e `Text` propriedades adequadamente:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample8.aspx)]

<span data-ttu-id="5f5ab-249">Em seguida, crie um `Click` manipulador de eventos para cada um.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="5f5ab-250">Os manipuladores de eventos deverá chamar o `RedirectUser` método, retornando o usuário para a primeira página usando a expressão de classificação apropriado.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample9.vb)]

<span data-ttu-id="5f5ab-251">Quando o primeiro visitando a página, os dados são classificados em ordem alfabética pelo nome do produto (consulte novamente a Figura 9).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="5f5ab-252">Clique no botão Avançar para Avançar para a segunda página de dados e clique na classificação por botão de categoria.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="5f5ab-253">Isso retorna nós para a primeira página de dados, classificados por nome de categoria (consulte a Figura 10).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="5f5ab-254">Da mesma forma, clicando em Classificar por botão de fornecedor classifica os dados por fornecedor a partir da primeira página de dados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="5f5ab-255">A opção de classificação será lembrada conforme os dados são paginados por meio do.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="5f5ab-256">Figura 11 mostra a página após a classificação por categoria e, em seguida, avançando para a décimo terceiro página de dados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>


<span data-ttu-id="5f5ab-257">[![Os produtos são classificados por categoria](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)</span></span>

<span data-ttu-id="5f5ab-258">**Figura 10**: Os produtos são classificados por categoria ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image28.png))</span></span>


<span data-ttu-id="5f5ab-259">[![A expressão de classificação é lembrada quando paginação por meio de dados do](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image29.png)</span></span>

<span data-ttu-id="5f5ab-260">**Figura 11**: A expressão de classificação é lembrada quando paginação por meio de dados do ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image31.png))</span></span>


## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="5f5ab-261">Etapa 6: Paginação personalizada por meio de registros em um repetidor</span><span class="sxs-lookup"><span data-stu-id="5f5ab-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="5f5ab-262">O exemplo de DataList examinados na etapa 5 páginas por meio de seus dados usando a técnica de paginação padrão ineficiente.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="5f5ab-263">Quando a paginação por meio de suficientemente grandes quantidades de dados, é imperativo que a paginação personalizada seja usado.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="5f5ab-264">Volta a [com eficiência por meio de grandes quantidades de dados de paginação](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) e [classificando dados paginados personalizado](../paging-and-sorting/sorting-custom-paged-data-vb.md) tutoriais, examinamos as diferenças entre padrão e a paginação personalizada e métodos criados na BLL para utilizando personalizado de paginação e classificação personalizados dados paginados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-vb.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="5f5ab-265">Em particular, esses dois tutoriais anteriores, adicionamos três métodos a seguir para o `ProductsBLL` classe:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="5f5ab-266">`GetProductsPaged(startRowIndex, maximumRows)` Retorna um subconjunto específico de registros começando *startRowIndex* e não excedendo *maximumRows*.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="5f5ab-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` Retorna um subconjunto específico de registros classificados pela especificado *sortExpression* parâmetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="5f5ab-268">`TotalNumberOfProducts()` fornece o número total de registros no `Products` tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="5f5ab-269">Esses métodos podem ser usados com eficiência, página e classificar dados usando um controle DataList ou Repeater.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="5f5ab-270">Para ilustrar isso, deixe s comece criando um controle Repeater com suporte à paginação personalizada; em seguida, vamos adicionar recursos de classificação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="5f5ab-271">Abra o `SortingWithCustomPaging.aspx` página na `PagingSortingDataListRepeater` pasta e adicione um repetidor para a página, definindo seu `ID` propriedade para `Products`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="5f5ab-272">De marca inteligente Repeater s, crie um novo ObjectDataSource chamado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="5f5ab-273">Configurá-lo para selecionar seus dados a partir de `ProductsBLL` classe s `GetProductsPaged` método.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>


<span data-ttu-id="5f5ab-274">[![Configurar o ObjectDataSource para usar o método de GetProductsPaged ProductsBLL classe s](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image32.png)</span></span>

<span data-ttu-id="5f5ab-275">**Figura 12**: Configurar o ObjectDataSource para usar o `ProductsBLL` classe s `GetProductsPaged` método ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image34.png))</span></span>


<span data-ttu-id="5f5ab-276">Defina as listas suspensas na atualização, inserção e excluir guias como (nenhum) e, em seguida, clique no botão Avançar.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="5f5ab-277">O Assistente Configurar fonte de dados agora solicita as fontes do `GetProductsPaged` método s *startRowIndex* e *maximumRows* parâmetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="5f5ab-278">Na realidade, esses parâmetros de entrada são ignorados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="5f5ab-279">Em vez disso, o *startRowIndex* e *maximumRows* valores serão passados por meio de `Arguments` propriedade em s ObjectDataSource `Selecting` manipulador de eventos, assim como como especificamos o *sortExpression* nesta demonstração de tutorial s primeiro.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="5f5ab-280">Portanto, deixe a fonte de parâmetro nas listas suspensas no assistente definido em nenhum.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>


<span data-ttu-id="5f5ab-281">[![Deixe o conjunto de fontes de parâmetros como None](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image35.png)</span></span>

<span data-ttu-id="5f5ab-282">**Figura 13**: Deixe as fontes de parâmetro definido como None ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image37.png))</span></span>


> [!NOTE]
> <span data-ttu-id="5f5ab-283">Fazer *não* definir o s ObjectDataSource `EnablePaging` propriedade `true`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="5f5ab-284">Isso fará com que o ObjectDataSource incluir automaticamente seu próprio *startRowIndex* e *maximumRows* parâmetros para o `SelectMethod` s lista existente de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="5f5ab-285">O `EnablePaging` propriedade é útil quando a associação personalizada porque esses controles esperam que o comportamento específico do ObjectDataSource que s de dados a um controle GridView, DetailsView ou FormView paginados disponível apenas quando `EnablePaging` é de propriedade `true`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="5f5ab-286">Já que temos que adicionar manualmente o suporte de paginação para o DataList e Repeater, deixe essa propriedade definida como `false` (o padrão), como vai inserir na funcionalidade necessária diretamente em nossa página do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>


<span data-ttu-id="5f5ab-287">Finalmente, defina o Repeater s `ItemTemplate` para que o nome do produto s, categoria e fornecedor são mostrados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="5f5ab-288">Após essas alterações, a sintaxe de declarativa Repeater e ObjectDataSource s deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample10.aspx)]

<span data-ttu-id="5f5ab-289">Reserve um tempo para visitar a página por meio de um navegador e observe que os registros não são retornados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="5f5ab-290">Isso ocorre porque estamos ve ainda para especificar o *startRowIndex* e *maximumRows* valores de parâmetros; portanto, os valores de 0 estão sendo passados para ambos.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="5f5ab-291">Para especificar esses valores, crie um manipulador de eventos para o s ObjectDataSource `Selecting` eventos e definir esses parâmetros de valores de programaticamente para valores codificados de 0 a 5, respectivamente:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample11.vb)]

<span data-ttu-id="5f5ab-292">Com essa alteração, a página, quando visualizado por meio de um navegador, mostra os cinco primeiros produtos.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>


<span data-ttu-id="5f5ab-293">[![Os cinco primeiros registros são exibidos](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image38.png)</span></span>

<span data-ttu-id="5f5ab-294">**Figura 14**: Os cinco primeiros registros são exibidos ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image40.png))</span></span>


> [!NOTE]
> <span data-ttu-id="5f5ab-295">Os produtos listados na Figura 14 acontecem seja classificada por nome do produto, porque o `GetProductsPaged` procedimento armazenado que executa a consulta de paginação personalizada eficiente ordena os resultados por `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>


<span data-ttu-id="5f5ab-296">Para permitir que o usuário percorrer as páginas, é necessário controlar o índice de linha de início e o número máximo de linhas e lembre-se esses valores em postagens.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="5f5ab-297">No exemplo de paginação padrão, usamos os campos de cadeia de consulta para manter esses valores; para esta demonstração, deixe s manter essas informações no estado de exibição de s de página.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="5f5ab-298">Crie as duas propriedades a seguir:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-298">Create the following two properties:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample12.vb)]

<span data-ttu-id="5f5ab-299">Em seguida, atualize o código no manipulador de eventos de seleção para que ele use o `StartRowIndex` e `MaximumRows` propriedades em vez dos valores embutidos de 0 a 5:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample13.vb)]

<span data-ttu-id="5f5ab-300">Neste momento, nossa página ainda mostra apenas os cinco primeiros registros.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="5f5ab-301">No entanto, com essas propriedades em vigor, podemos está pronto para criar nossa interface de paginação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="5f5ab-302">Adicionando a Interface de paginação</span><span class="sxs-lookup"><span data-stu-id="5f5ab-302">Adding the Paging Interface</span></span>

<span data-ttu-id="5f5ab-303">Use s permitem que o mesmo primeiro, anterior, Avançar, paginação de última interface usada no exemplo de paginação padrão, incluindo a Web de rótulo de controle que exibe qual página de dados estiver sendo exibido e o número total de páginas existem.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="5f5ab-304">Adicione os quatro controles da Web de botão e o rótulo abaixo Repetidor.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-304">Add the four Button Web controls and Label below the Repeater.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample14.aspx)]

<span data-ttu-id="5f5ab-305">Em seguida, crie `Click` manipuladores de eventos para os quatro botões.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="5f5ab-306">Quando um desses botões é clicado, precisamos atualizar o `StartRowIndex` e associar novamente os dados a serem Repetidor.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="5f5ab-307">O código para os botões First, anterior e próxima é bastante simple, mas para o último botão como podemos determinar o índice de linha de início para a última página de dados?</span><span class="sxs-lookup"><span data-stu-id="5f5ab-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="5f5ab-308">Para esse índice, bem como ser capaz de determinar que se os botões Próximo e último devem ser habilitados precisamos saber quantos registros no total estão sendo paginados por meio de computação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="5f5ab-309">Podemos determinar isso chamando o `ProductsBLL` classe s `TotalNumberOfProducts()` método.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="5f5ab-310">Let s criar uma propriedade somente leitura, o nível de página chamada `TotalRowCount` que retorna os resultados do `TotalNumberOfProducts()` método:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample15.vb)]

<span data-ttu-id="5f5ab-311">Com essa propriedade agora podemos determinar o último índice de linha de início s de página.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="5f5ab-312">Especificamente, ele s o resultado de inteiro do `TotalRowCount` menos 1 dividido por `MaximumRows`, multiplicado pelo `MaximumRows`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="5f5ab-313">Agora podemos escrever a `Click` manipuladores de eventos para os quatro botões de interface de paginação:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample16.vb)]

<span data-ttu-id="5f5ab-314">Por fim, precisamos desabilitar os botões de primeiro e anterior na interface de paginação ao exibir a primeira página de dados e os botões Próximo e último ao exibir a última página.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="5f5ab-315">Para fazer isso, adicione o seguinte código para o s ObjectDataSource `Selecting` manipulador de eventos:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample17.vb)]

<span data-ttu-id="5f5ab-316">Depois de adicionar essas `Click` manipuladores de eventos e o código para habilitar ou desabilitar os elementos de interface de paginação com base no índice de linha de início atual, a página de teste em um navegador.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="5f5ab-317">Como a Figura 15 ilustra ao primeiro visitar a página na primeira e botões anterior serão estão desabilitados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="5f5ab-318">Clicar em Avançar mostra a segunda página de dados, enquanto clicar em último exibe a última página (consulte as figuras de 16 e 17).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="5f5ab-319">Ao exibir a última página de dados de botões de próximo e último estão desabilitados.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>


<span data-ttu-id="5f5ab-320">[![Os botões anterior e último estão desabilitadas ao exibir a primeira página de produtos](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image41.png)</span></span>

<span data-ttu-id="5f5ab-321">**Figura 15**: Os botões anterior e último estão desabilitadas ao exibir a primeira página de produtos ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image43.png))</span></span>


<span data-ttu-id="5f5ab-322">[![A segunda página de produtos estão sendo exibida](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-322">[![The Second Page of Products are Dispalyed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image44.png)</span></span>

<span data-ttu-id="5f5ab-323">**Figura 16**: A segunda página de produtos estão sendo exibida ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-323">**Figure 16**: The Second Page of Products are Dispalyed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image46.png))</span></span>


<span data-ttu-id="5f5ab-324">[![Clicar em último exibirá a página Final de dados](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image47.png)</span></span>

<span data-ttu-id="5f5ab-325">**Figura 17**: Clicar em último exibe a página de dados Final ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image49.png))</span></span>


## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="5f5ab-326">Etapa 7: Incluindo a classificação de suporte com personalizado paginável Repeater</span><span class="sxs-lookup"><span data-stu-id="5f5ab-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="5f5ab-327">Agora que a paginação personalizada tiver sido implementada, oferecemos está pronto para incluir a classificação de suporte.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="5f5ab-328">O `ProductsBLL` classe s `GetProductsPagedAndSorted` método tem o mesmo *startRowIndex* e *maximumRows* parâmetros como de entrada `GetProductsPaged`, mas permite que mais  *sortExpression* parâmetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="5f5ab-329">Para usar o `GetProductsPagedAndSorted` método de `SortingWithCustomPaging.aspx`, é necessário executar as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="5f5ab-330">Alterar o s ObjectDataSource `SelectMethod` propriedade de `GetProductsPaged` para `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="5f5ab-331">Adicionar um *sortExpression* `Parameter` objeto para o s ObjectDataSource `SelectParameters` coleção.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="5f5ab-332">Criar uma privada, o nível de página `SortExpression` propriedade que persiste seu valor em postagens por meio do estado de exibição de página s.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="5f5ab-333">Atualizar o s ObjectDataSource `Selecting` manipulador de eventos para atribuir o s ObjectDataSource *sortExpression* parâmetro o valor do nível de página `SortExpression` propriedade.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="5f5ab-334">Crie a interface de classificação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-334">Create the sorting interface.</span></span>

<span data-ttu-id="5f5ab-335">Comece atualizando o s ObjectDataSource `SelectMethod` propriedade e a adição de um *sortExpression* `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="5f5ab-336">Certifique-se de que o *sortExpression* `Parameter` s `Type` estiver definida como `String`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="5f5ab-337">Depois de concluir essas duas primeiras tarefas, a marcação declarativa do ObjectDataSource s deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample18.aspx)]

<span data-ttu-id="5f5ab-338">Em seguida, precisamos de um nível de página `SortExpression` propriedade cujo valor é serializado no estado de exibição.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="5f5ab-339">Se nenhum valor de expressão de classificação tiver sido definido, use ProductName como o padrão:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-339">If no sort expression value has been set, use ProductName as the default:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample19.vb)]

<span data-ttu-id="5f5ab-340">Antes do ObjectDataSource invoca o `GetProductsPagedAndSorted` método, precisamos definir o *sortExpression* `Parameter` para o valor da `SortExpression` propriedade.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="5f5ab-341">No `Selecting` manipulador de eventos, adicione a seguinte linha de código:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-341">In the `Selecting` event handler, add the following line of code:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample20.vb)]

<span data-ttu-id="5f5ab-342">Tudo o que resta é implementar a interface de classificação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="5f5ab-343">Como fizemos no último exemplo, permite que s tenham a interface de classificação implementada usando três controles da Web de botão que permitem ao usuário classificar os resultados por fornecedor, categoria ou nome do produto.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample21.aspx)]

<span data-ttu-id="5f5ab-344">Criar `Click` manipuladores de eventos para esses três controles de botão.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="5f5ab-345">No evento de redefinição de manipulador, o `StartRowIndex` como 0, defina o `SortExpression` para o valor apropriado e reassociar os dados a serem repetidor:</span><span class="sxs-lookup"><span data-stu-id="5f5ab-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>


[!code-vb[Main](sorting-data-in-a-datalist-or-repeater-control-vb/samples/sample22.vb)]

<span data-ttu-id="5f5ab-346">Tudo que s é a ele!</span><span class="sxs-lookup"><span data-stu-id="5f5ab-346">That s all there is to it!</span></span> <span data-ttu-id="5f5ab-347">Embora houvesse um número de etapas para obter a paginação personalizada e a classificação implementado, as etapas eram muito semelhantes àquelas necessárias para a paginação padrão.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="5f5ab-348">Figura 18 mostra os produtos ao exibir a última página de dados quando classificadas por categoria.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>


<span data-ttu-id="5f5ab-349">[![A última página de dados, a classificação por categoria, é exibido](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image50.png)</span></span>

<span data-ttu-id="5f5ab-350">**Figura 18**: A última página de dados, a classificação por categoria, é exibida ([clique para exibir a imagem em tamanho normal](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="5f5ab-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-vb/_static/image52.png))</span></span>


> [!NOTE]
> <span data-ttu-id="5f5ab-351">Nos exemplos anteriores, quando a classificação por fornecedor que NomeDoFornecedor foi usado como a expressão de classificação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="5f5ab-352">No entanto, para a implementação de paginação personalizada, precisamos usar CompanyName.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="5f5ab-353">Isso ocorre porque o procedimento armazenado responsável por implementar a paginação personalizada `GetProductsPagedAndSorted` passa a expressão de classificação para o `ROW_NUMBER()` palavra-chave, o `ROW_NUMBER()` palavra-chave requer o nome da coluna real em vez de um alias.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="5f5ab-354">Portanto, devemos usar `CompanyName` (o nome da coluna na `Suppliers` tabela) em vez do alias usado na `SELECT` consulta (`SupplierName`) para a expressão de classificação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>


## <a name="summary"></a><span data-ttu-id="5f5ab-355">Resumo</span><span class="sxs-lookup"><span data-stu-id="5f5ab-355">Summary</span></span>

<span data-ttu-id="5f5ab-356">Nem o DataList e Repeater oferecem suporte interno a classificação, mas com um pouco de código e uma interface de classificação personalizada, essa funcionalidade pode ser adicionada.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="5f5ab-357">Ao implementar a classificação, mas não de paginação, a expressão de classificação pode ser especificada por meio de `DataSourceSelectArguments` objeto passado para o s ObjectDataSource `Select` método.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="5f5ab-358">Isso `DataSourceSelectArguments` objeto s `SortExpression` propriedade pode ser atribuída em s ObjectDataSource `Selecting` manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="5f5ab-359">Para adicionar funcionalidades de classificação para um DataList ou Repeater que já oferece suporte à paginação, a abordagem mais fácil é personalizar a camada de lógica de negócios para incluir um método que aceita uma expressão de classificação.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="5f5ab-360">Essas informações, em seguida, podem ser passadas por meio de um parâmetro em s ObjectDataSource `SelectParameters`.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="5f5ab-361">Esse tutorial conclui nossa análise de paginação e classificação com os controles DataList e Repeater.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="5f5ab-362">Nosso próximo e último tutorial irá examinar como adicionar controles da Web de botão para os modelos de s DataList e Repeater para fornecer alguma funcionalidade personalizada, iniciada pelo usuário em uma base por item.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="5f5ab-363">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="5f5ab-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="5f5ab-364">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="5f5ab-364">About the Author</span></span>

<span data-ttu-id="5f5ab-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5f5ab-366">Scott funciona como um consultor independente, instrutor e escritor.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5f5ab-367">Seu livro mais recente é [ *Sams Teach por conta própria ASP.NET 2.0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5f5ab-368">Ele pode ser contatado pelo [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="5f5ab-369">ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="5f5ab-369">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="5f5ab-370">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="5f5ab-370">Special Thanks To</span></span>

<span data-ttu-id="5f5ab-371">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-371">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5f5ab-372">Revisor de avanço para este tutorial foi David Suru.</span><span class="sxs-lookup"><span data-stu-id="5f5ab-372">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="5f5ab-373">Você está interessado na revisão Meus próximos artigos do MSDN?</span><span class="sxs-lookup"><span data-stu-id="5f5ab-373">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5f5ab-374">Nesse caso, me descartar uma linha na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5f5ab-374">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="5f5ab-375">Anterior</span><span class="sxs-lookup"><span data-stu-id="5f5ab-375">Previous</span></span>](paging-report-data-in-a-datalist-or-repeater-control-vb.md)
