---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
title: Consultando dados com o controle SqlDataSource (VB) | Microsoft Docs
author: rick-anderson
description: Nos tutoriais anteriores, usamos o controle ObjectDataSource para separar totalmente a camada de apresentação da camada de acesso a dados. Iniciando com este tutorial...
ms.author: riande
ms.date: 02/20/2007
ms.assetid: b12f752d-3502-40a4-b695-fc7b7d08cfd3
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 9e2689e665c39fda15df27ba03f4dcd44e834bff
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65124552"
---
# <a name="querying-data-with-the-sqldatasource-control-vb"></a><span data-ttu-id="7a911-104">Consultar dados com o controle SqlDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="7a911-104">Querying Data with the SqlDataSource Control (VB)</span></span>

<span data-ttu-id="7a911-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7a911-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7a911-106">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe) ou [baixar PDF](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7a911-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe) or [Download PDF](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span></span>

> <span data-ttu-id="7a911-107">Nos tutoriais anteriores, usamos o controle ObjectDataSource para separar totalmente a camada de apresentação da camada de acesso a dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-107">In the preceding tutorials we used the ObjectDataSource control to fully separate the presentation layer from the Data Access layer.</span></span> <span data-ttu-id="7a911-108">Estamos começando com este tutorial, saiba como o controle SqlDataSource pode ser usado para aplicativos simples que não exigem uma rigorosa separação da apresentação e acesso a dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-108">Starting with this tutorial, we learn how the SqlDataSource control can be used for simple applications that do not require such a strict separation of presentation and data access.</span></span>

## <a name="introduction"></a><span data-ttu-id="7a911-109">Introdução</span><span class="sxs-lookup"><span data-stu-id="7a911-109">Introduction</span></span>

<span data-ttu-id="7a911-110">Todos os tutoriais, ve examinei até agora tem usado uma arquitetura em camadas que consiste de apresentação, lógica de negócios e as camadas de acesso a dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-110">All of the tutorials we ve examined so far have used a tiered architecture consisting of presentation, Business Logic, and Data Access layers.</span></span> <span data-ttu-id="7a911-111">A camada de acesso de dados (DAL) foi criado no primeiro tutorial ([criando uma camada de acesso de dados](../introduction/creating-a-data-access-layer-vb.md)) e a camada de lógica de negócios no segundo ([criando uma camada de lógica de negócios](../introduction/creating-a-business-logic-layer-vb.md)).</span><span class="sxs-lookup"><span data-stu-id="7a911-111">The Data Access Layer (DAL) was crafted in the first tutorial ([Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md)) and the Business Logic Layer in the second ([Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md)).</span></span> <span data-ttu-id="7a911-112">Começando com o [exibindo dados com o ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial vimos como usar o controle do ASP.NET 2.0 s novo ObjectDataSource para declarativamente a interface com a arquitetura da camada de apresentação.</span><span class="sxs-lookup"><span data-stu-id="7a911-112">Starting with the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, we saw how to use ASP.NET 2.0 s new ObjectDataSource control to declaratively interface with the architecture from the presentation layer.</span></span>

<span data-ttu-id="7a911-113">Embora todos os tutoriais até o momento tem usado a arquitetura para trabalhar com dados, também é possível acessar, inserir, atualizar e excluir dados de banco de dados diretamente de uma página ASP.NET, ignorando a arquitetura.</span><span class="sxs-lookup"><span data-stu-id="7a911-113">While all of the tutorials so far have used the architecture to work with data, it is also possible to access, insert, update, and delete database data directly from an ASP.NET page, bypassing the architecture.</span></span> <span data-ttu-id="7a911-114">Isso coloca as consultas de banco de dados específico e a lógica de negócios diretamente na página da web.</span><span class="sxs-lookup"><span data-stu-id="7a911-114">Doing so places the specific database queries and business logic directly in the web page.</span></span> <span data-ttu-id="7a911-115">Para aplicativos suficientemente grandes ou complexos, desenvolvendo, implementando e usando uma arquitetura em camadas são extremamente importante para o sucesso, a capacidade de atualização e a facilidade de manutenção do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="7a911-115">For sufficiently large or complex applications, designing, implementing, and using a tiered architecture is vitally important for the success, updatability, and maintainability of the application.</span></span> <span data-ttu-id="7a911-116">Desenvolver uma arquitetura robusta, no entanto, pode ser desnecessário durante a criação de aplicativos extremamente simples e únicos.</span><span class="sxs-lookup"><span data-stu-id="7a911-116">Developing a robust architecture, however, may be unnecessary when creating exceedingly simple, one-off applications.</span></span>

<span data-ttu-id="7a911-117">O ASP.NET 2.0 fornece controles de fonte de dados internos cinco [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), e [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="7a911-117">ASP.NET 2.0 provides five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span></span> <span data-ttu-id="7a911-118">O SqlDataSource pode ser usado para acessar e modificar dados diretamente de um banco de dados relacional, incluindo o Microsoft SQL Server, Microsoft Access, Oracle, MySQL e outros.</span><span class="sxs-lookup"><span data-stu-id="7a911-118">The SqlDataSource can be used to access and modify data directly from a relational database, including Microsoft SQL Server, Microsoft Access, Oracle, MySQL, and others.</span></span> <span data-ttu-id="7a911-119">Este tutorial e os próximos três, examinaremos como trabalhar com o controle SqlDataSource, explorar como consultar e filtrar dados do banco de dados, bem como usar o SqlDataSource para inserir, atualizar e excluir dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-119">In this tutorial and the next three, we'll examine how to work with the SqlDataSource control, exploring how to query and filter database data, as well as how to use the SqlDataSource to insert, update, and delete data.</span></span>

![O ASP.NET 2.0 inclui cinco controles de fonte de dados internos](querying-data-with-the-sqldatasource-control-vb/_static/image1.gif)

<span data-ttu-id="7a911-121">**Figura 1**: O ASP.NET 2.0 inclui cinco controles de fonte de dados internos</span><span class="sxs-lookup"><span data-stu-id="7a911-121">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>

## <a name="comparing-the-objectdatasource-and-sqldatasource"></a><span data-ttu-id="7a911-122">Comparação entre o ObjectDataSource e SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="7a911-122">Comparing the ObjectDataSource and SqlDataSource</span></span>

<span data-ttu-id="7a911-123">Conceitualmente, o ObjectDataSource e SqlDataSource controles são simplesmente os proxies aos dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-123">Conceptually, both the ObjectDataSource and SqlDataSource controls are simply proxies to data.</span></span> <span data-ttu-id="7a911-124">Conforme discutido na [exibindo dados com o ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, o ObjectDataSource tem propriedades que indicam o tipo de objeto que fornece os dados e os métodos para invocar para selecionar, inserir, atualizar e excluir dados do tipo de objeto subjacente.</span><span class="sxs-lookup"><span data-stu-id="7a911-124">As discussed in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, the ObjectDataSource has properties that indicate the object type that provides the data and the methods to invoke to select, insert, update, and delete data from the underlying object type.</span></span> <span data-ttu-id="7a911-125">Após configurar as propriedades de s ObjectDataSource, um controle de Web como um GridView, DetailsView ou DataList de dados podem ser associados ao controle, usando o s ObjectDataSource `Select()`, `Insert()`, `Delete()`, e `Update()` métodos para interagir com a arquitetura subjacente.</span><span class="sxs-lookup"><span data-stu-id="7a911-125">Once the ObjectDataSource s properties have been configured, a data Web control such as a GridView, DetailsView, or DataList can be bound to the control, using the ObjectDataSource s `Select()`, `Insert()`, `Delete()`, and `Update()` methods to interact with the underlying architecture.</span></span>

<span data-ttu-id="7a911-126">O SqlDataSource fornece a mesma funcionalidade, mas opera em relação a um banco de dados relacional em vez de uma biblioteca de objetos.</span><span class="sxs-lookup"><span data-stu-id="7a911-126">The SqlDataSource provides the same functionality, but operates against a relational database rather than an object library.</span></span> <span data-ttu-id="7a911-127">Com o SqlDataSource, podemos deve especificar a cadeia de caracteres de conexão de banco de dados e consultas SQL ad hoc ou procedimentos armazenados para executar para inserir, atualizar, excluir e recuperar dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-127">With the SqlDataSource, we must specify the database connection string and the ad-hoc SQL queries or stored procedures to execute to insert, update, delete, and retrieve data.</span></span> <span data-ttu-id="7a911-128">O s SqlDataSource `Select()`, `Insert()`, `Update()`, e `Delete()` métodos, quando invocada, conecte-se ao banco de dados especificado e emita a consulta SQL apropriada.</span><span class="sxs-lookup"><span data-stu-id="7a911-128">The SqlDataSource s `Select()`, `Insert()`, `Update()`, and `Delete()` methods, when invoked, connect to the specified database and issue the appropriate SQL query.</span></span> <span data-ttu-id="7a911-129">Como ilustra o diagrama a seguir, esses métodos fazem o trabalho pesado de se conectar a um banco de dados, emitindo uma consulta e retornar os resultados.</span><span class="sxs-lookup"><span data-stu-id="7a911-129">As the following diagram illustrates, the these methods do the grunt work of connecting to a database, issuing a query, and returning the results.</span></span>

![O SqlDataSource serve como um Proxy para o banco de dados](querying-data-with-the-sqldatasource-control-vb/_static/image2.gif)

<span data-ttu-id="7a911-131">**Figura 2**: O SqlDataSource serve como um Proxy para o banco de dados</span><span class="sxs-lookup"><span data-stu-id="7a911-131">**Figure 2**: The SqlDataSource Serves as a Proxy to the Database</span></span>

> [!NOTE]
> <span data-ttu-id="7a911-132">Neste tutorial, nos concentraremos na recuperação dos dados do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-132">In this tutorial we'll focus on retrieving data from the database.</span></span> <span data-ttu-id="7a911-133">No [inserindo, atualizando e excluindo dados com o controle SqlDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md) tutorial, veremos como configurar o SqlDataSource para dar suporte à inserção, atualização e exclusão.</span><span class="sxs-lookup"><span data-stu-id="7a911-133">In the [Inserting, Updating, and Deleting Data with the SqlDataSource Control](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md) tutorial, we'll see how to configure the SqlDataSource to support inserting, updating, and deleting.</span></span>

## <a name="the-sqldatasource-and-accessdatasource-controls"></a><span data-ttu-id="7a911-134">Os controles de AccessDataSource e SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="7a911-134">The SqlDataSource and AccessDataSource Controls</span></span>

<span data-ttu-id="7a911-135">Além do controle SqlDataSource, o ASP.NET 2.0 também inclui um controle AccessDataSource.</span><span class="sxs-lookup"><span data-stu-id="7a911-135">In addition to the SqlDataSource control, ASP.NET 2.0 also includes an AccessDataSource control.</span></span> <span data-ttu-id="7a911-136">Esses dois controles diferentes levam muitos desenvolvedores novos no ASP.NET 2.0 suspeitar que o controle AccessDataSource foi projetado para trabalhar exclusivamente com o Microsoft Access com o controle SqlDataSource projetado para trabalhar exclusivamente com o Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="7a911-136">These two different controls lead many developers new to ASP.NET 2.0 to suspect that the AccessDataSource control is designed to work exclusively with Microsoft Access with the SqlDataSource control designed to work exclusively with Microsoft SQL Server.</span></span> <span data-ttu-id="7a911-137">Enquanto o AccessDataSource foi projetado para trabalhar especificamente com o Microsoft Access, o controle SqlDataSource funciona com *qualquer* banco de dados relacional que pode ser acessado por meio do .NET.</span><span class="sxs-lookup"><span data-stu-id="7a911-137">While the AccessDataSource is designed to work specifically with Microsoft Access, the SqlDataSource control works with *any* relational database that can be accessed through .NET.</span></span> <span data-ttu-id="7a911-138">Isso inclui qualquer compatível com OLE DB ou ODBC armazenamentos de dados, como Microsoft Access, Microsoft SQL Server, Informix, Oracle, MySQL e PostgreSQL, entre muitas outras.</span><span class="sxs-lookup"><span data-stu-id="7a911-138">This includes any OleDb- or ODBC-compliant data stores, such as Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL, and PostgreSQL, among many others.</span></span>

<span data-ttu-id="7a911-139">A única diferença entre os controles AccessDataSource e SqlDataSource é como as informações de conexão de banco de dados são especificadas.</span><span class="sxs-lookup"><span data-stu-id="7a911-139">The sole difference between the AccessDataSource and SqlDataSource controls is how the database connection information is specified.</span></span> <span data-ttu-id="7a911-140">O controle AccessDataSource precisa apenas o caminho de arquivo para o arquivo de banco de dados do Access.</span><span class="sxs-lookup"><span data-stu-id="7a911-140">The AccessDataSource control needs just the file path to the Access database file.</span></span> <span data-ttu-id="7a911-141">O SqlDataSource, por outro lado, requer uma cadeia de conexão completa.</span><span class="sxs-lookup"><span data-stu-id="7a911-141">The SqlDataSource, on the other hand, requires a complete connection string.</span></span>

## <a name="step-1-creating-the-sqldatasource-web-pages"></a><span data-ttu-id="7a911-142">Etapa 1: Criando páginas da Web do SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="7a911-142">Step 1: Creating the SqlDataSource Web Pages</span></span>

<span data-ttu-id="7a911-143">Antes de começarmos a explorar como trabalhar diretamente com os dados do banco de dados usando o controle SqlDataSource, permitem que s levar alguns instantes para criar as páginas do ASP.NET em nosso projeto de site que precisaremos para este tutorial e os próximos três pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="7a911-143">Before we start exploring how to work directly with database data using the SqlDataSource control, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="7a911-144">Comece adicionando uma nova pasta chamada `SqlDataSource`.</span><span class="sxs-lookup"><span data-stu-id="7a911-144">Start by adding a new folder named `SqlDataSource`.</span></span> <span data-ttu-id="7a911-145">Em seguida, adicione as seguintes páginas do ASP.NET para essa pasta, certificando-se de associar cada página com o `Site.master` página mestra:</span><span class="sxs-lookup"><span data-stu-id="7a911-145">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Querying.aspx`
- `ParameterizedQueries.aspx`
- `InsertUpdateDelete.aspx`
- `OptimisticConcurrency.aspx`

![Adicione as páginas do ASP.NET para que os tutoriais relacionados SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image3.gif)

<span data-ttu-id="7a911-147">**Figura 3**: Adicione as páginas do ASP.NET para que os tutoriais relacionados SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="7a911-147">**Figure 3**: Add the ASP.NET Pages for the SqlDataSource-Related Tutorials</span></span>

<span data-ttu-id="7a911-148">Como em outras pastas `Default.aspx` no `SqlDataSource` pasta listará os tutoriais em sua seção.</span><span class="sxs-lookup"><span data-stu-id="7a911-148">Like in the other folders, `Default.aspx` in the `SqlDataSource` folder will list the tutorials in its section.</span></span> <span data-ttu-id="7a911-149">Lembre-se de que o `SectionLevelTutorialListing.ascx` controle de usuário fornece essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="7a911-149">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="7a911-150">Portanto, adicionar esse controle de usuário `Default.aspx` arrastando-no Gerenciador de soluções para a página de exibição de Design de s.</span><span class="sxs-lookup"><span data-stu-id="7a911-150">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="7a911-151">[![Adicionar o controle de usuário SectionLevelTutorialListing.ascx para default. aspx](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span><span class="sxs-lookup"><span data-stu-id="7a911-151">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span></span>

<span data-ttu-id="7a911-152">**Figura 4**: Adicione a `SectionLevelTutorialListing.ascx` controle de usuário `Default.aspx` ([clique para exibir a imagem em tamanho normal](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span><span class="sxs-lookup"><span data-stu-id="7a911-152">**Figure 4**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span></span>

<span data-ttu-id="7a911-153">Por fim, adicione esses quatro páginas como entradas para o `Web.sitemap` arquivo.</span><span class="sxs-lookup"><span data-stu-id="7a911-153">Lastly, add these four pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="7a911-154">Especificamente, adicione a seguinte marcação após o personalizado adicionando botões à DataList e Repeater `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="7a911-154">Specifically, add the following markup after the Adding Custom Buttons to the DataList and Repeater `<siteMapNode>`:</span></span>

[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample1.sql)]

<span data-ttu-id="7a911-155">Depois de atualizar `Web.sitemap`, reserve um tempo para exibir o site de tutoriais através de um navegador.</span><span class="sxs-lookup"><span data-stu-id="7a911-155">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="7a911-156">No menu à esquerda agora inclui itens para a edição, inserindo e excluindo tutoriais.</span><span class="sxs-lookup"><span data-stu-id="7a911-156">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![O mapa do Site agora inclui entradas para os tutoriais do SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image7.gif)

<span data-ttu-id="7a911-158">**Figura 5**: O mapa do Site agora inclui entradas para os tutoriais do SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="7a911-158">**Figure 5**: The Site Map Now Includes Entries for the SqlDataSource Tutorials</span></span>

## <a name="step-2-adding-and-configuring-the-sqldatasource-control"></a><span data-ttu-id="7a911-159">Etapa 2: Adicionando e configurando o controle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="7a911-159">Step 2: Adding and Configuring the SqlDataSource Control</span></span>

<span data-ttu-id="7a911-160">Comece abrindo o `Querying.aspx` página o `SqlDataSource` pasta e alterne para a exibição de Design.</span><span class="sxs-lookup"><span data-stu-id="7a911-160">Start by opening the `Querying.aspx` page in the `SqlDataSource` folder and switch to Design view.</span></span> <span data-ttu-id="7a911-161">Arraste um controle SqlDataSource Toolbox para o Designer e defina suas `ID` para `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="7a911-161">Drag a SqlDataSource control from the Toolbox onto the Designer and set its `ID` to `ProductsDataSource`.</span></span> <span data-ttu-id="7a911-162">Assim como acontece com o ObjectDataSource, SqlDataSource não produza qualquer saída renderizada e, portanto, é exibido como uma caixa cinza na superfície de design.</span><span class="sxs-lookup"><span data-stu-id="7a911-162">As with the ObjectDataSource, the SqlDataSource does not produce any rendered output and therefore appears as a gray box on the design surface.</span></span> <span data-ttu-id="7a911-163">Para configurar o SqlDataSource, clique no link configurar fonte de dados da marca inteligente SqlDataSource s.</span><span class="sxs-lookup"><span data-stu-id="7a911-163">To configure the SqlDataSource, click on the Configure Data Source link from the SqlDataSource s smart tag.</span></span>

![Clique em de configurar o vínculo da fonte de dados da marca inteligente s SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image8.gif)

<span data-ttu-id="7a911-165">**Figura 6**: Clique em de configurar o vínculo da fonte de dados da marca inteligente s SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="7a911-165">**Figure 6**: Click on the Configure Data Source Link from the SqlDataSource s Smart Tag</span></span>

<span data-ttu-id="7a911-166">Isso abre o Assistente para configurar a fonte de dados do SqlDataSource controle s.</span><span class="sxs-lookup"><span data-stu-id="7a911-166">This brings up the SqlDataSource control s Configure Data Source wizard.</span></span> <span data-ttu-id="7a911-167">Embora as etapas do assistente s seja diferente do controle ObjectDataSource s, o objetivo final é o mesmo para fornecer os detalhes sobre como recuperar, inserir, atualizar e excluir dados por meio da fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-167">While the wizard s steps differ from the ObjectDataSource control s, the end goal is the same to provide the details on how to retrieve, insert, update, and delete data through the data source.</span></span> <span data-ttu-id="7a911-168">Para o SqlDataSource isso envolve a especificação de um banco de dados subjacente para usar e fornecendo as instruções SQL ad hoc ou procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="7a911-168">For the SqlDataSource this entails specifying the underlying database to use and providing the ad-hoc SQL statements or stored procedures.</span></span>

<span data-ttu-id="7a911-169">A primeira etapa do assistente nos solicita o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-169">The first wizard step prompts us for the database.</span></span> <span data-ttu-id="7a911-170">A lista suspensa inclui esses bancos de dados encontrados em web application s `App_Data` pasta e aqueles que foram adicionados para o nó de conexões de dados no Gerenciador de servidores.</span><span class="sxs-lookup"><span data-stu-id="7a911-170">The drop-down list includes those databases found in the web application s `App_Data` folder and those that have been added to the Data Connections node in the Server Explorer.</span></span> <span data-ttu-id="7a911-171">Desde que criamos já adicionou uma cadeia de caracteres de conexão para o `NORTHWIND.MDF` banco de dados de `App_Data` pasta para nosso projeto s `Web.config` arquivo, a lista suspensa inclui uma referência a essa cadeia de caracteres de conexão, `NORTHWINDConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="7a911-171">Since we ve already added a connection string for the `NORTHWIND.MDF` database in the `App_Data` folder to our project s `Web.config` file, the drop-down list includes a reference to that connection string, `NORTHWINDConnectionString`.</span></span> <span data-ttu-id="7a911-172">Escolha este item na lista suspensa e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="7a911-172">Choose this item from the drop-down list and click Next.</span></span>

![Escolha o NORTHWINDConnectionString na lista suspensa](querying-data-with-the-sqldatasource-control-vb/_static/image9.gif)

<span data-ttu-id="7a911-174">**Figura 7**: Escolha o `NORTHWINDConnectionString` na lista suspensa</span><span class="sxs-lookup"><span data-stu-id="7a911-174">**Figure 7**: Choose the `NORTHWINDConnectionString` from the Drop-Down List</span></span>

<span data-ttu-id="7a911-175">Depois de escolher o banco de dados, o assistente solicita a consulta retornar dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-175">After choosing the database, the wizard asks for the query to return data.</span></span> <span data-ttu-id="7a911-176">Podemos pode especificar as colunas de uma tabela ou exibição para retornar ou pode inserir uma instrução SQL personalizada ou especificar um procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="7a911-176">We can either specify the columns of a table or view to return or can enter a custom SQL statement or specify a stored procedure.</span></span> <span data-ttu-id="7a911-177">Você pode alternar entre essa escolha por meio de especificar uma instrução SQL personalizada ou procedimento armazenado e especificar colunas de uma tabela ou exibir botões de opção.</span><span class="sxs-lookup"><span data-stu-id="7a911-177">You can toggle between this choice through the Specify a custom SQL statement or stored procedure and Specify columns from a table or view radio buttons.</span></span>

> [!NOTE]
> <span data-ttu-id="7a911-178">Para este primeiro exemplo, deixe s use as especificar colunas de uma opção de tabela ou exibição.</span><span class="sxs-lookup"><span data-stu-id="7a911-178">For this first example, let s use the Specify columns from a table or view option.</span></span> <span data-ttu-id="7a911-179">Vamos voltar ao Assistente posteriormente no tutorial e explorar a especificar uma opção de procedimento armazenado ou uma instrução SQL personalizada.</span><span class="sxs-lookup"><span data-stu-id="7a911-179">We'll return to the wizard later in this tutorial and explore the Specify a custom SQL statement or stored procedure option.</span></span>

<span data-ttu-id="7a911-180">Figura 8 mostra o configurar a tela de instrução Select quando as especificar colunas de um botão de opção de tabela ou exibição está selecionada.</span><span class="sxs-lookup"><span data-stu-id="7a911-180">Figure 8 shows the Configure the Select Statement screen when the Specify columns from a table or view radio button is selected.</span></span> <span data-ttu-id="7a911-181">A lista suspensa contém o conjunto de tabelas e exibições no banco de dados Northwind, com a tabela selecionada ou colunas de exibição de s exibidas na lista de caixa de seleção abaixo.</span><span class="sxs-lookup"><span data-stu-id="7a911-181">The drop-down list contains the set of tables and views in the Northwind database, with the selected table or view s columns displayed in the checkbox list below.</span></span> <span data-ttu-id="7a911-182">Neste exemplo, let s retornar os `ProductID`, `ProductName`, e `UnitPrice` colunas do `Products` tabela.</span><span class="sxs-lookup"><span data-stu-id="7a911-182">For this example, let s return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table.</span></span> <span data-ttu-id="7a911-183">Como mostra a Figura 8, depois de fazer essas seleções o assistente mostra a instrução SQL resultante `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span><span class="sxs-lookup"><span data-stu-id="7a911-183">As Figure 8 shows, after making these selections the wizard shows the resulting SQL statement `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span></span>

![Retornar dados da tabela produtos](querying-data-with-the-sqldatasource-control-vb/_static/image10.gif)

<span data-ttu-id="7a911-185">**Figura 8**: Retornar dados do `Products` tabela</span><span class="sxs-lookup"><span data-stu-id="7a911-185">**Figure 8**: Return Data from the `Products` Table</span></span>

<span data-ttu-id="7a911-186">Depois de configurar o Assistente para retornar o `ProductID`, `ProductName`, e `UnitPrice` colunas para o `Products` da tabela, clique no botão Avançar.</span><span class="sxs-lookup"><span data-stu-id="7a911-186">Once you have configured the wizard to return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table, click the Next button.</span></span> <span data-ttu-id="7a911-187">Essa tela final fornece uma oportunidade para examinar os resultados da consulta configurada na etapa anterior.</span><span class="sxs-lookup"><span data-stu-id="7a911-187">This final screen provides an opportunity to examine the results of the query configured from the previous step.</span></span> <span data-ttu-id="7a911-188">Clicar no botão consulta de teste executa configurado `SELECT` instrução e exibe os resultados em uma grade.</span><span class="sxs-lookup"><span data-stu-id="7a911-188">Clicking the Test Query button executes the configured `SELECT` statement and displays the results in a grid.</span></span>

![Clique no botão de consulta de teste para examinar a consulta SELECT](querying-data-with-the-sqldatasource-control-vb/_static/image11.gif)

<span data-ttu-id="7a911-190">**Figura 9**: Clique no botão de consulta de teste para revisar seu `SELECT` consulta</span><span class="sxs-lookup"><span data-stu-id="7a911-190">**Figure 9**: Click the Test Query Button to Review Your `SELECT` Query</span></span>

<span data-ttu-id="7a911-191">Para concluir o assistente, clique em Concluir.</span><span class="sxs-lookup"><span data-stu-id="7a911-191">To complete the wizard, click Finish.</span></span>

<span data-ttu-id="7a911-192">Como com o ObjectDataSource, o Assistente de s SqlDataSource simplesmente atribui valores às propriedades do controle s, ou seja, o [ `ConnectionString` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) e [ `SelectCommand` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) propriedades.</span><span class="sxs-lookup"><span data-stu-id="7a911-192">Like with the ObjectDataSource, the SqlDataSource s wizard merely assigns values to the control s properties, namely the [`ConnectionString`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) and [`SelectCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) properties.</span></span> <span data-ttu-id="7a911-193">Depois de concluir o assistente, sua marcação declarativa de s de controle SqlDataSource deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="7a911-193">After completing the wizard, your SqlDataSource control s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample2.aspx)]

<span data-ttu-id="7a911-194">O `ConnectionString` propriedade fornece informações sobre como conectar-se ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-194">The `ConnectionString` property provides information on how to connect to the database.</span></span> <span data-ttu-id="7a911-195">Esta propriedade pode ser atribuída um valor de cadeia de conexão completa embutido em código, ou pode apontar para uma cadeia de caracteres de conexão no `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="7a911-195">This property can be assigned a complete, hard-coded connection string value or can point to a connection string in `Web.config`.</span></span> <span data-ttu-id="7a911-196">Para fazer referência a um valor de cadeia de caracteres de conexão em Web. config, use a sintaxe `<%$ expressionPrefix:expressionValue %>`.</span><span class="sxs-lookup"><span data-stu-id="7a911-196">To reference a connection string value in Web.config, use the syntax `<%$ expressionPrefix:expressionValue %>`.</span></span> <span data-ttu-id="7a911-197">Normalmente, *expressionPrefix* é ConnectionStrings e *expressionValue* é o nome da cadeia de caracteres de conexão no `Web.config` [ `<connectionStrings>` seção](https://msdn.microsoft.com/library/bf7sd233.aspx).</span><span class="sxs-lookup"><span data-stu-id="7a911-197">Typically, *expressionPrefix* is ConnectionStrings and *expressionValue* is the name of the connect string in the `Web.config` [`<connectionStrings>` section](https://msdn.microsoft.com/library/bf7sd233.aspx).</span></span> <span data-ttu-id="7a911-198">No entanto, a sintaxe pode ser usada para referência `<appSettings>` elementos ou conteúdo dos arquivos de recurso.</span><span class="sxs-lookup"><span data-stu-id="7a911-198">However, the syntax can be used to reference `<appSettings>` elements or content from resource files.</span></span> <span data-ttu-id="7a911-199">Ver [visão geral do ASP.NET expressões](https://msdn.microsoft.com/library/d5bd1tad.aspx) para obter mais informações sobre essa sintaxe.</span><span class="sxs-lookup"><span data-stu-id="7a911-199">See [ASP.NET Expressions Overview](https://msdn.microsoft.com/library/d5bd1tad.aspx) for more on this syntax.</span></span>

<span data-ttu-id="7a911-200">O `SelectCommand` propriedade especifica a instrução de SQL ad hoc ou o procedimento armazenado a ser executada para retornar os dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-200">The `SelectCommand` property specifies the ad-hoc SQL statement or stored procedure to execute to return the data.</span></span>

## <a name="step-3-adding-a-data-web-control-and-binding-it-to-the-sqldatasource"></a><span data-ttu-id="7a911-201">Etapa 3: Adicionando um controle de Web de dados e associá-lo ao SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="7a911-201">Step 3: Adding a Data Web Control and Binding it to the SqlDataSource</span></span>

<span data-ttu-id="7a911-202">Depois que o SqlDataSource tiver sido configurado, ele pode ser ligado a um controle da Web, como um GridView ou DetailsView de dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-202">Once the SqlDataSource has been configured, it can be bound to a data Web control, such as a GridView or DetailsView.</span></span> <span data-ttu-id="7a911-203">Para este tutorial, deixe s exibir os dados em um GridView.</span><span class="sxs-lookup"><span data-stu-id="7a911-203">For this tutorial, let s display the data in a GridView.</span></span> <span data-ttu-id="7a911-204">Na caixa de ferramentas, arraste um controle GridView à página e associá-lo para o `ProductsDataSource` SqlDataSource escolhendo-se a fonte de dados na lista suspensa na marca inteligente s GridView.</span><span class="sxs-lookup"><span data-stu-id="7a911-204">From the Toolbox, drag a GridView onto the page and bind it to the `ProductsDataSource` SqlDataSource by choosing the data source from the drop-down list in the GridView s smart tag.</span></span>

<span data-ttu-id="7a911-205">[![Adicionar um controle GridView e associá-lo para o controle SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span><span class="sxs-lookup"><span data-stu-id="7a911-205">[![Add a GridView and Bind it to the SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span></span>

<span data-ttu-id="7a911-206">**Figura 10**: Adicionar um controle GridView e associá-lo para o controle SqlDataSource ([clique para exibir a imagem em tamanho normal](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span><span class="sxs-lookup"><span data-stu-id="7a911-206">**Figure 10**: Add a GridView and Bind it to the SqlDataSource Control ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span></span>

<span data-ttu-id="7a911-207">Depois que você tiver selecionado o controle SqlDataSource na lista suspensa na marca inteligente s GridView, Visual Studio adicionará automaticamente um BoundField ou CheckBoxField a GridView para cada uma das colunas retornadas pelo controle de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-207">Once you ve selected the SqlDataSource control from the drop-down list in the GridView s smart tag, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the columns returned by the data source control.</span></span> <span data-ttu-id="7a911-208">Como o SqlDataSource retorna três colunas de banco de dados `ProductID`, `ProductName`, e `UnitPrice` há três campos em GridView.</span><span class="sxs-lookup"><span data-stu-id="7a911-208">Since the SqlDataSource returns three database columns `ProductID`, `ProductName`, and `UnitPrice` there are three fields in the GridView.</span></span>

<span data-ttu-id="7a911-209">Reserve um tempo para configurar o s GridView três BoundFields.</span><span class="sxs-lookup"><span data-stu-id="7a911-209">Take a moment to configure the GridView s three BoundFields.</span></span> <span data-ttu-id="7a911-210">Alterar o `ProductName` campo s `HeaderText` propriedade para o nome do produto e o `UnitPrice` s de campo ao preço.</span><span class="sxs-lookup"><span data-stu-id="7a911-210">Change the `ProductName` field s `HeaderText` property to Product Name and the `UnitPrice` field s to Price.</span></span> <span data-ttu-id="7a911-211">Também formatar o `UnitPrice` campo como uma moeda.</span><span class="sxs-lookup"><span data-stu-id="7a911-211">Also format the `UnitPrice` field as a currency.</span></span> <span data-ttu-id="7a911-212">Depois de fazer essas modificações, sua marcação declarativa do GridView s deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="7a911-212">After making these modifications, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample3.aspx)]

<span data-ttu-id="7a911-213">Visite esta página por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="7a911-213">Visit this page through a browser.</span></span> <span data-ttu-id="7a911-214">Como mostra a Figura 11, GridView lista cada produto s `ProductID`, `ProductName`, e `UnitPrice` valores.</span><span class="sxs-lookup"><span data-stu-id="7a911-214">As Figure 11 shows, the GridView lists each product s `ProductID`, `ProductName`, and `UnitPrice` values.</span></span>

<span data-ttu-id="7a911-215">[![O GridView exibe cada produto s ProductID, ProductName e valores de UnitPrice](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span><span class="sxs-lookup"><span data-stu-id="7a911-215">[![The GridView Displays Each Product s ProductID, ProductName, and UnitPrice Values](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span></span>

<span data-ttu-id="7a911-216">**Figura 11**: S o GridView exibe cada produto `ProductID`, `ProductName`, e `UnitPrice` valores ([clique para exibir a imagem em tamanho normal](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span><span class="sxs-lookup"><span data-stu-id="7a911-216">**Figure 11**: The GridView Displays Each Product s `ProductID`, `ProductName`, and `UnitPrice` Values ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span></span>

<span data-ttu-id="7a911-217">Quando a página é visitada GridView invoca seu controle de fonte de dados s `Select()` método.</span><span class="sxs-lookup"><span data-stu-id="7a911-217">When the page is visited the GridView invokes its data source control s `Select()` method.</span></span> <span data-ttu-id="7a911-218">Quando estávamos usando o controle ObjectDataSource, isso chama o `ProductsBLL` classe s `GetProducts()` método.</span><span class="sxs-lookup"><span data-stu-id="7a911-218">When we were using the ObjectDataSource control, this called the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="7a911-219">Com o SqlDataSource, no entanto, o `Select()` método estabelece uma conexão para o banco de dados especificado e os problemas a `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, neste exemplo).</span><span class="sxs-lookup"><span data-stu-id="7a911-219">With the SqlDataSource, however, the `Select()` method establishes a connection to the specified database and issues the `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, in this example).</span></span> <span data-ttu-id="7a911-220">O SqlDataSource retorna seus resultados que o GridView, em seguida, enumera, criando uma linha em um GridView para cada registro de banco de dados retornado.</span><span class="sxs-lookup"><span data-stu-id="7a911-220">The SqlDataSource returns its results which the GridView then enumerates, creating a row in the GridView for each database record returned.</span></span>

## <a name="the-built-in-data-web-control-features-and-the-sqldatasource-control"></a><span data-ttu-id="7a911-221">Os recursos de controle de Web de dados interno e o controle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="7a911-221">The Built-In Data Web Control Features and the SqlDataSource Control</span></span>

<span data-ttu-id="7a911-222">Em geral, os recursos inerentes aos dados de que controles da Web de paginação, classificação, editar, excluir, inserir e assim por diante são específicas para o controle de Web de dados em não são dependentes do controle de fonte de dados usado.</span><span class="sxs-lookup"><span data-stu-id="7a911-222">In general, the features inherent to the data Web controls paging, sorting, editing, deleting, inserting, and so on are specific to the data Web control and are not dependent on the data source control used.</span></span> <span data-ttu-id="7a911-223">Ou seja, o GridView pode utilizar seu interno de paginação, classificação, editando e excluindo se ele está associado a um ObjectDataSource ou um SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="7a911-223">That is, the GridView can utilize its built-in paging, sorting, editing, and deleting whether it is bound to an ObjectDataSource or a SqlDataSource.</span></span> <span data-ttu-id="7a911-224">No entanto, certos recursos de controle da Web de dados são confidenciais para o controle de fonte de dados que está sendo usado ou para a configuração de s de controle de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-224">However, certain data Web control features are sensitive to the data source control being used or to the data source control s configuration.</span></span>

<span data-ttu-id="7a911-225">Por exemplo, nos [com eficiência por meio de grandes quantidades de dados de paginação](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial discutimos como, por padrão, a lógica de paginação para os dados da Web controla ingenuamente retorna *todos os* registros da subjacente fonte de dados e, em seguida, exibe somente o subconjunto apropriado de registros, considerando o índice da página atual e o número de registros a serem exibidos por página.</span><span class="sxs-lookup"><span data-stu-id="7a911-225">For example, in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial we discussed how, by default, the paging logic for the data Web controls naively returns *all* records from the underlying data source and then displays only the appropriate subset of records given the current page index and the number of records to display per page.</span></span> <span data-ttu-id="7a911-226">Esse modelo é muito ineficiente quando a paginação por meio de conjuntos de resultados grande o suficiente.</span><span class="sxs-lookup"><span data-stu-id="7a911-226">This model is highly inefficient when paging through sufficiently large result sets.</span></span> <span data-ttu-id="7a911-227">Felizmente, o ObjectDataSource pode ser configurado para dar suporte a paginação personalizada, que retorna somente o subconjunto exato de registros a serem exibidos.</span><span class="sxs-lookup"><span data-stu-id="7a911-227">Fortunately, the ObjectDataSource can be configured to support custom paging, which returns only the precise subset of records to display.</span></span> <span data-ttu-id="7a911-228">O controle SqlDataSource, no entanto, não tem as propriedades para implementar a paginação personalizada.</span><span class="sxs-lookup"><span data-stu-id="7a911-228">The SqlDataSource control, however, lacks the properties for implementing custom paging.</span></span>

<span data-ttu-id="7a911-229">Surge outra sutileza com paginação e classificação com o SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="7a911-229">Another subtlety with paging and sorting arises with the SqlDataSource.</span></span> <span data-ttu-id="7a911-230">Por padrão, os dados retornados de um SqlDataSource podem ser paginados ou classificados por meio de GridView.</span><span class="sxs-lookup"><span data-stu-id="7a911-230">By default, the data returned from a SqlDataSource can be paged or sorted through the GridView.</span></span> <span data-ttu-id="7a911-231">Para demonstrar isso, verifique as opções de habilitar a paginação e habilitar a classificação na marca inteligente s GridView no `Querying.aspx` e verifique se que isso funciona conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="7a911-231">To demonstrate this, check the Enable Paging and Enable Sorting options in the GridView s smart tag in `Querying.aspx` and verify that this works as expected.</span></span>

<span data-ttu-id="7a911-232">Classificação e paginação funcionam porque o SqlDataSource recupera os dados do banco de dados em um conjunto de dados com tipagem.</span><span class="sxs-lookup"><span data-stu-id="7a911-232">Sorting and paging works because the SqlDataSource retrieves the database data into a loosely-typed DataSet.</span></span> <span data-ttu-id="7a911-233">O número total de registros retornados pela consulta um aspecto essencial para implementação da paginação pode ser determinado no conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-233">The total number of records returned by the query an essential aspect to implementing paging can be ascertained from the DataSet.</span></span> <span data-ttu-id="7a911-234">Além disso, os resultados do conjunto de dados s podem ser classificados por meio de um DataView.</span><span class="sxs-lookup"><span data-stu-id="7a911-234">Additionally, the DataSet s results can be sorted through a DataView.</span></span> <span data-ttu-id="7a911-235">Esses recursos são usados automaticamente pelo SqlDataSource quando as solicitações de GridView paginada ou dados classificados.</span><span class="sxs-lookup"><span data-stu-id="7a911-235">These capabilities are automatically used by the SqlDataSource when the GridView requests paged or sorted data.</span></span>

<span data-ttu-id="7a911-236">O SqlDataSource pode ser configurado para retornar um DataReader, em vez de um conjunto de dados alterando sua [ `DataSourceMode` propriedade](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) de `DataSet` (o padrão) para `DataReader`.</span><span class="sxs-lookup"><span data-stu-id="7a911-236">The SqlDataSource can be configured to return a DataReader instead of a DataSet by changing its [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) from `DataSet` (the default) to `DataReader`.</span></span> <span data-ttu-id="7a911-237">Usando um DataReader pode ser preferencial em situações ao passar os resultados de s SqlDataSource para código existente que espera um DataReader.</span><span class="sxs-lookup"><span data-stu-id="7a911-237">Using a DataReader might be preferred in situations when passing the SqlDataSource s results to existing code that expects a DataReader.</span></span> <span data-ttu-id="7a911-238">Além disso, como DataReaders são consideravelmente mais simples objetos de conjuntos de dados, eles oferecem melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="7a911-238">Furthermore, since DataReaders are considerably simpler objects than DataSets, they offer better performance.</span></span> <span data-ttu-id="7a911-239">Se você fizer essa alteração, no entanto, o controle de Web de dados não pode classificar nem página, pois o SqlDataSource não pode determinar quantos registros é retornado pela consulta, nem o DataReader oferecem qualquer técnicas para classificar os dados retornados.</span><span class="sxs-lookup"><span data-stu-id="7a911-239">If you make this change, however, the data Web control can neither sort nor page since the SqlDataSource cannot ascertain how many records are returned by the query, nor does the DataReader offer any techniques for sorting the returned data.</span></span>

## <a name="step-4-using-a-custom-sql-statement-or-stored-procedure"></a><span data-ttu-id="7a911-240">Etapa 4: Usando uma instrução SQL personalizada ou procedimento armazenado</span><span class="sxs-lookup"><span data-stu-id="7a911-240">Step 4: Using a Custom SQL Statement or Stored Procedure</span></span>

<span data-ttu-id="7a911-241">Ao configurar o controle SqlDataSource, a consulta usada para retornar dados pode ser especificada em uma das duas abordagens, como uma instrução SQL personalizada ou procedimento armazenado, ou colunas de uma tabela ou exibição existente.</span><span class="sxs-lookup"><span data-stu-id="7a911-241">When configuring the SqlDataSource control, the query used to return data can be specified in one of two approaches as a custom SQL statement or stored procedure, or as columns from an existing table or view.</span></span> <span data-ttu-id="7a911-242">Na etapa 2, examinamos selecionando colunas do `Products` tabela.</span><span class="sxs-lookup"><span data-stu-id="7a911-242">In Step 2 we examined selecting columns from the `Products` table.</span></span> <span data-ttu-id="7a911-243">Deixe o s examinar o uso de uma instrução SQL personalizada.</span><span class="sxs-lookup"><span data-stu-id="7a911-243">Let s look at using a custom SQL statement.</span></span>

<span data-ttu-id="7a911-244">Adicione outro controle GridView para o `Querying.aspx` página e optar por criar uma nova fonte de dados na lista suspensa na marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="7a911-244">Add another GridView control to the `Querying.aspx` page and choose to create a new data source from the drop-down list in the smart tag.</span></span> <span data-ttu-id="7a911-245">Em seguida, indique que os dados serão extraídos de um banco de dados Isso criará um novo controle SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="7a911-245">Next, indicate that the data will be pulled from a database this will create a new SqlDataSource control.</span></span> <span data-ttu-id="7a911-246">Nomeie o controle `ProductsWithCategoryInfoDataSource`.</span><span class="sxs-lookup"><span data-stu-id="7a911-246">Name the control `ProductsWithCategoryInfoDataSource`.</span></span>

![Criar um novo controle SqlDataSource chamado ProductsWithCategoryInfoDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image18.gif)

<span data-ttu-id="7a911-248">**Figura 12**: Criar um novo controle SqlDataSource chamado `ProductsWithCategoryInfoDataSource`</span><span class="sxs-lookup"><span data-stu-id="7a911-248">**Figure 12**: Create a New SqlDataSource Control Named `ProductsWithCategoryInfoDataSource`</span></span>

<span data-ttu-id="7a911-249">A próxima tela pergunta para especificar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-249">The next screen asks us to specify the database.</span></span> <span data-ttu-id="7a911-250">Como fizemos na Figura 7, selecione o `NORTHWINDConnectionString` na lista suspensa lista e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="7a911-250">As we did back in Figure 7, select the `NORTHWINDConnectionString` from the drop-down list and click Next.</span></span> <span data-ttu-id="7a911-251">Em configurar a tela de instrução Select, escolha a especificar uma instrução SQL personalizada ou um botão de opção de procedimento armazenado e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="7a911-251">In the Configure the Select Statement screen, choose the Specify a custom SQL statement or stored procedure radio button and click Next.</span></span> <span data-ttu-id="7a911-252">Isso abrirá a tela definir instruções personalizadas ou procedimentos armazenados, que oferece guias rotulada como SELECT, UPDATE, INSERT e DELETE.</span><span class="sxs-lookup"><span data-stu-id="7a911-252">This will bring up the Define Custom Statements or Stored Procedures screen, which offers tabs labeled SELECT, UPDATE, INSERT, and DELETE.</span></span> <span data-ttu-id="7a911-253">Em cada guia, você pode inserir uma instrução SQL personalizada na caixa de texto ou escolha um procedimento armazenado na lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="7a911-253">In each tab you can enter a custom SQL statement into the textbox or choose a stored procedure from the drop-down list.</span></span> <span data-ttu-id="7a911-254">Neste tutorial veremos inserir uma instrução SQL personalizada; o próximo tutorial inclui um exemplo que usa um procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="7a911-254">In this tutorial we will look at entering a custom SQL statement; the next tutorial includes an example that uses a stored procedure.</span></span>

![Insira uma instrução SQL personalizada ou escolha um procedimento armazenado](querying-data-with-the-sqldatasource-control-vb/_static/image19.gif)

<span data-ttu-id="7a911-256">**Figura 13**: Insira uma instrução SQL personalizada ou escolha um procedimento armazenado</span><span class="sxs-lookup"><span data-stu-id="7a911-256">**Figure 13**: Enter a Custom SQL Statement or Pick a Stored Procedure</span></span>

<span data-ttu-id="7a911-257">A instrução SQL personalizada pode ser inserida manualmente na caixa de texto ou pode ser construída graficamente clicando no botão Construtor de consultas.</span><span class="sxs-lookup"><span data-stu-id="7a911-257">The custom SQL statement can be entered by hand into the textbox or can be constructed graphically by clicking the Query Builder button.</span></span> <span data-ttu-id="7a911-258">O construtor de consultas ou a caixa de texto, use a seguinte consulta para retornar os `ProductID` e `ProductName` campos da `Products` tabela usando um `JOIN` para recuperar o produto s `CategoryName` do `Categories` tabela:</span><span class="sxs-lookup"><span data-stu-id="7a911-258">From either the Query Builder or the textbox, use the following query to return the `ProductID` and `ProductName` fields from the `Products` table using a `JOIN` to retrieve the product s `CategoryName` from the `Categories` table:</span></span>

[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample4.sql)]

![Você pode graficamente construir a consulta usando o construtor de consultas](querying-data-with-the-sqldatasource-control-vb/_static/image20.gif)

<span data-ttu-id="7a911-260">**Figura 14**: Você pode graficamente construir a consulta usando o construtor de consultas</span><span class="sxs-lookup"><span data-stu-id="7a911-260">**Figure 14**: You can Graphically Construct the Query Using the Query Builder</span></span>

<span data-ttu-id="7a911-261">Depois de especificar a consulta, clique em Avançar para prosseguir para a tela de consulta de teste.</span><span class="sxs-lookup"><span data-stu-id="7a911-261">After specifying the query, click Next to proceed to the Test Query screen.</span></span> <span data-ttu-id="7a911-262">Clique em Concluir para concluir o assistente SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="7a911-262">Click Finish to complete the SqlDataSource wizard.</span></span>

<span data-ttu-id="7a911-263">Depois de concluir o assistente, o GridView terá três BoundFields adicionados a ele exibindo o `ProductID`, `ProductName`, e `CategoryName` colunas retornados da consulta e resultante na marcação declarativa a seguir:</span><span class="sxs-lookup"><span data-stu-id="7a911-263">After completing the wizard, the GridView will have three BoundFields added to it displaying the `ProductID`, `ProductName`, and `CategoryName` columns returned from the query and resulting in the following declarative markup:</span></span>

[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample5.aspx)]

<span data-ttu-id="7a911-264">[![O GridView mostra cada ID de produto s, o nome da categoria e o nome associado](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span><span class="sxs-lookup"><span data-stu-id="7a911-264">[![The GridView Shows Each Product s ID, Name, and Associated Category Name](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span></span>

<span data-ttu-id="7a911-265">**Figura 15**: O ID do GridView mostra cada produto, nome e nome da categoria associada ([clique para exibir a imagem em tamanho normal](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span><span class="sxs-lookup"><span data-stu-id="7a911-265">**Figure 15**: The GridView Shows Each Product s ID, Name, and Associated Category Name ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span></span>

## <a name="summary"></a><span data-ttu-id="7a911-266">Resumo</span><span class="sxs-lookup"><span data-stu-id="7a911-266">Summary</span></span>

<span data-ttu-id="7a911-267">Neste tutorial vimos como consultar e exibir dados usando o controle SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="7a911-267">In this tutorial we saw how to query and display data using the SqlDataSource control.</span></span> <span data-ttu-id="7a911-268">Como o ObjectDataSource, SqlDataSource serve como um proxy, fornecendo uma abordagem declarativa para acessar os dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-268">Like the ObjectDataSource, the SqlDataSource serves as a proxy, providing a declarative approach to accessing data.</span></span> <span data-ttu-id="7a911-269">Especificam de suas propriedades para se conectar ao banco de dados e o SQL `SELECT` consultar para executar; elas podem ser especificadas na janela Propriedades ou usando o Assistente Configurar fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="7a911-269">Its properties specify the database to connect to and the SQL `SELECT` query to execute; they can be specified through the Properties window or by using the Configure DataSource wizard.</span></span>

<span data-ttu-id="7a911-270">O `SELECT` , examinamos neste tutorial de exemplos de consulta retornados todos os registros da consulta especificada.</span><span class="sxs-lookup"><span data-stu-id="7a911-270">The `SELECT` query examples we examined in this tutorial returned all of the records from the specified query.</span></span> <span data-ttu-id="7a911-271">No entanto, o controle SqlDataSource, pode incluir um `WHERE` cláusula com parâmetros cujos valores são atribuídos por meio de programação ou automaticamente são extraídos de uma origem especificada.</span><span class="sxs-lookup"><span data-stu-id="7a911-271">The SqlDataSource control, however, can include a `WHERE` clause with parameters whose values are assigned programmatically or are automatically pulled from a specified source.</span></span> <span data-ttu-id="7a911-272">Vamos examinar como criar e usar consultas parametrizadas no próximo tutorial!</span><span class="sxs-lookup"><span data-stu-id="7a911-272">We'll examine how to create and use parameterized queries in the next tutorial!</span></span>

<span data-ttu-id="7a911-273">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="7a911-273">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="7a911-274">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="7a911-274">Further Reading</span></span>

<span data-ttu-id="7a911-275">Para obter mais informações sobre os tópicos abordados neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="7a911-275">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="7a911-276">Acessando dados do banco de dados relacional</span><span class="sxs-lookup"><span data-stu-id="7a911-276">Accessing Relational Database Data</span></span>](http://aspnet.4guysfromrolla.com/articles/022206-1.aspx)
- [<span data-ttu-id="7a911-277">Visão geral do controle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="7a911-277">SqlDataSource Control Overview</span></span>](https://msdn.microsoft.com/library/dz12d98w.aspx)
- [<span data-ttu-id="7a911-278">Tutoriais de início rápido do ASP.NET: O controle SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="7a911-278">ASP.NET Quickstart Tutorials: The SqlDataSource Control</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/sqldatasource.aspx)
- [<span data-ttu-id="7a911-279">O Web. config `<connectionStrings>` elemento</span><span class="sxs-lookup"><span data-stu-id="7a911-279">The Web.config `<connectionStrings>` Element</span></span>](https://msdn.microsoft.com/library/bf7sd233.aspx)
- [<span data-ttu-id="7a911-280">Referência de cadeia de caracteres de Conexão de banco de dados</span><span class="sxs-lookup"><span data-stu-id="7a911-280">Database Connection String Reference</span></span>](http://www.connectionstrings.com/)

## <a name="about-the-author"></a><span data-ttu-id="7a911-281">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="7a911-281">About the Author</span></span>

<span data-ttu-id="7a911-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="7a911-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7a911-283">Scott funciona como um consultor independente, instrutor e escritor.</span><span class="sxs-lookup"><span data-stu-id="7a911-283">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7a911-284">Seu livro mais recente é [ *Sams Teach por conta própria ASP.NET 2.0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="7a911-284">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7a911-285">Ele pode ser contatado pelo [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7a911-285">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="7a911-286">ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="7a911-286">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="7a911-287">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="7a911-287">Special Thanks To</span></span>

<span data-ttu-id="7a911-288">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="7a911-288">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="7a911-289">Os revisores de avanço para este tutorial foram Connery Susan, Bernadette Leigh e David Suru.</span><span class="sxs-lookup"><span data-stu-id="7a911-289">Lead reviewers for this tutorial were Susan Connery, Bernadette Leigh, and David Suru.</span></span> <span data-ttu-id="7a911-290">Você está interessado na revisão Meus próximos artigos do MSDN?</span><span class="sxs-lookup"><span data-stu-id="7a911-290">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="7a911-291">Nesse caso, me descartar uma linha na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7a911-291">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7a911-292">[Anterior](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
> [Próximo](using-parameterized-queries-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="7a911-292">[Previous](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
[Next](using-parameterized-queries-with-the-sqldatasource-vb.md)</span></span>
