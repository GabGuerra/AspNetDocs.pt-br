---
uid: web-forms/overview/data-access/working-with-binary-files/uploading-files-cs
title: Carregando arquivos (c#) | Microsoft Docs
author: rick-anderson
description: Saiba como permitir que usuários carreguem arquivos binários (como documentos do Word ou PDF) para seu site da Web onde eles podem ser armazenados no sistema de arquivos do servidor...
ms.author: riande
ms.date: 03/27/2007
ms.assetid: b381b1da-feb3-4776-bc1b-75db53eb90ab
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/uploading-files-cs
msc.type: authoredcontent
ms.openlocfilehash: 450c6fa2532061f1abe43db8df77f61f8bbe914a
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65119535"
---
# <a name="uploading-files-c"></a><span data-ttu-id="e8f11-103">Carregar arquivos (C#)</span><span class="sxs-lookup"><span data-stu-id="e8f11-103">Uploading Files (C#)</span></span>

<span data-ttu-id="e8f11-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e8f11-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e8f11-105">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_CS.exe) ou [baixar PDF](uploading-files-cs/_static/datatutorial54cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e8f11-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_CS.exe) or [Download PDF](uploading-files-cs/_static/datatutorial54cs1.pdf)</span></span>

> <span data-ttu-id="e8f11-106">Saiba como permitir que usuários carreguem arquivos binários (como documentos do Word ou PDF) para seu site da Web onde eles podem ser armazenados no sistema de arquivos do servidor ou o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-106">Learn how to allow users to upload binary files (such as Word or PDF documents) to your Web site where they may be stored in either the server's file system or the database.</span></span>

## <a name="introduction"></a><span data-ttu-id="e8f11-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="e8f11-107">Introduction</span></span>

<span data-ttu-id="e8f11-108">Todos os tutoriais, ve examinei até agora tenha trabalhado exclusivamente com dados de texto.</span><span class="sxs-lookup"><span data-stu-id="e8f11-108">All of the tutorials we ve examined so far have worked exclusively with text data.</span></span> <span data-ttu-id="e8f11-109">No entanto, muitos aplicativos têm modelos de dados que capturam o texto e dados binários.</span><span class="sxs-lookup"><span data-stu-id="e8f11-109">However, many applications have data models that capture both text and binary data.</span></span> <span data-ttu-id="e8f11-110">Um site de encontros online pode permitir que os usuários carreguem uma imagem para associar ao seu perfil.</span><span class="sxs-lookup"><span data-stu-id="e8f11-110">An online dating site might allow users to upload a picture to associate with their profile.</span></span> <span data-ttu-id="e8f11-111">Um site de recrutamento pode permitir que os usuários carregar seu resume como um documento do Microsoft Word ou PDF.</span><span class="sxs-lookup"><span data-stu-id="e8f11-111">A recruiting website might let users upload their resume as a Microsoft Word or PDF document.</span></span>

<span data-ttu-id="e8f11-112">Trabalhar com dados binários adiciona um novo conjunto de desafios.</span><span class="sxs-lookup"><span data-stu-id="e8f11-112">Working with binary data adds a new set of challenges.</span></span> <span data-ttu-id="e8f11-113">Devemos decidir como os dados binários são armazenados no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e8f11-113">We must decide how the binary data is stored in the application.</span></span> <span data-ttu-id="e8f11-114">A interface usada para inserir novos registros deve ser atualizado para permitir que o usuário carregue um arquivo de seu computador e etapas adicionais devem ser executadas para exibir ou fornecer um meio para fazer o download de um registro s associados a dados binários.</span><span class="sxs-lookup"><span data-stu-id="e8f11-114">The interface used for inserting new records has to be updated to allow the user to upload a file from their computer and extra steps must be taken to display or provide a means for downloading a record s associated binary data.</span></span> <span data-ttu-id="e8f11-115">Este tutorial e os próximos três, exploraremos como obstáculo esses desafios.</span><span class="sxs-lookup"><span data-stu-id="e8f11-115">In this tutorial and the next three we'll explore how to hurdle these challenges.</span></span> <span data-ttu-id="e8f11-116">No final desses tutoriais vai criamos um aplicativo totalmente funcional que associa uma imagem e um folheto PDF com cada categoria.</span><span class="sxs-lookup"><span data-stu-id="e8f11-116">At the end of these tutorials we'll have built a fully functional application that associates a picture and PDF brochure with each category.</span></span> <span data-ttu-id="e8f11-117">Neste tutorial específico vamos examinar as técnicas diferentes para armazenar dados binários e explore como habilitar usuários carregar um arquivo de seu computador e tiver salvo no sistema de arquivo do web server s.</span><span class="sxs-lookup"><span data-stu-id="e8f11-117">In this particular tutorial we'll look at different techniques for storing binary data and explore how to enable users to upload a file from their computer and have it saved on the web server s file system.</span></span>

> [!NOTE]
> <span data-ttu-id="e8f11-118">Dados binários que faz parte de um modelo de dados do aplicativo s às vezes são conhecidos como um [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), um acrônimo para objeto binário grande.</span><span class="sxs-lookup"><span data-stu-id="e8f11-118">Binary data that is part of an application s data model is sometimes referred to as a [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), an acronym for Binary Large OBject.</span></span> <span data-ttu-id="e8f11-119">Nesses tutoriais, escolhi usar os dados binários de terminologia, embora o termo BLOB é sinônimo.</span><span class="sxs-lookup"><span data-stu-id="e8f11-119">In these tutorials I have chosen to use the terminology binary data, although the term BLOB is synonymous.</span></span>

## <a name="step-1-creating-the-working-with-binary-data-web-pages"></a><span data-ttu-id="e8f11-120">Etapa 1: Criando o trabalho com páginas da Web de dados binários</span><span class="sxs-lookup"><span data-stu-id="e8f11-120">Step 1: Creating the Working with Binary Data Web Pages</span></span>

<span data-ttu-id="e8f11-121">Antes de começar a explorar os desafios associados com a adição de suporte para dados binários, permitem que s levar alguns instantes para criar as páginas do ASP.NET em nosso projeto de site que precisaremos para este tutorial e os próximos três pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="e8f11-121">Before we begin to explore the challenges associated with adding support for binary data, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="e8f11-122">Comece adicionando uma nova pasta chamada `BinaryData`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-122">Start by adding a new folder named `BinaryData`.</span></span> <span data-ttu-id="e8f11-123">Em seguida, adicione as seguintes páginas do ASP.NET para essa pasta, certificando-se de associar cada página com o `Site.master` página mestra:</span><span class="sxs-lookup"><span data-stu-id="e8f11-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `FileUpload.aspx`
- `DisplayOrDownloadData.aspx`
- `UploadInDetailsView.aspx`
- `UpdatingAndDeleting.aspx`

![Adicione as páginas do ASP.NET para que os tutoriais de binários e dados relacionados](uploading-files-cs/_static/image1.gif)

<span data-ttu-id="e8f11-125">**Figura 1**: Adicione as páginas do ASP.NET para que os tutoriais de binários e dados relacionados</span><span class="sxs-lookup"><span data-stu-id="e8f11-125">**Figure 1**: Add the ASP.NET Pages for the Binary Data-Related Tutorials</span></span>

<span data-ttu-id="e8f11-126">Como em outras pastas `Default.aspx` no `BinaryData` pasta listará os tutoriais em sua seção.</span><span class="sxs-lookup"><span data-stu-id="e8f11-126">Like in the other folders, `Default.aspx` in the `BinaryData` folder will list the tutorials in its section.</span></span> <span data-ttu-id="e8f11-127">Lembre-se de que o `SectionLevelTutorialListing.ascx` controle de usuário fornece essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="e8f11-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="e8f11-128">Portanto, adicionar esse controle de usuário `Default.aspx` arrastando-no Gerenciador de soluções para a página de exibição de Design de s.</span><span class="sxs-lookup"><span data-stu-id="e8f11-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="e8f11-129">[![Adicionar o controle de usuário SectionLevelTutorialListing.ascx para default. aspx](uploading-files-cs/_static/image2.gif)](uploading-files-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e8f11-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](uploading-files-cs/_static/image2.gif)](uploading-files-cs/_static/image1.png)</span></span>

<span data-ttu-id="e8f11-130">**Figura 2**: Adicione a `SectionLevelTutorialListing.ascx` controle de usuário `Default.aspx` ([clique para exibir a imagem em tamanho normal](uploading-files-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="e8f11-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](uploading-files-cs/_static/image2.png))</span></span>

<span data-ttu-id="e8f11-131">Por fim, adicione essas páginas como entradas para o `Web.sitemap` arquivo.</span><span class="sxs-lookup"><span data-stu-id="e8f11-131">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="e8f11-132">Especificamente, adicione a marcação a seguir após o Enhancing GridView `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="e8f11-132">Specifically, add the following markup after the Enhancing the GridView `<siteMapNode>`:</span></span>

[!code-xml[Main](uploading-files-cs/samples/sample1.xml)]

<span data-ttu-id="e8f11-133">Depois de atualizar `Web.sitemap`, reserve um tempo para exibir o site de tutoriais através de um navegador.</span><span class="sxs-lookup"><span data-stu-id="e8f11-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="e8f11-134">No menu à esquerda agora inclui itens para o trabalho com os tutoriais de dados binários.</span><span class="sxs-lookup"><span data-stu-id="e8f11-134">The menu on the left now includes items for the Working with Binary Data tutorials.</span></span>

![O mapa do Site agora inclui entradas para o trabalho com os tutoriais de dados binários](uploading-files-cs/_static/image3.gif)

<span data-ttu-id="e8f11-136">**Figura 3**: O mapa do Site agora inclui entradas para o trabalho com os tutoriais de dados binários</span><span class="sxs-lookup"><span data-stu-id="e8f11-136">**Figure 3**: The Site Map Now Includes Entries for the Working with Binary Data Tutorials</span></span>

## <a name="step-2-deciding-where-to-store-the-binary-data"></a><span data-ttu-id="e8f11-137">Etapa 2: Decidir onde Store os dados binários</span><span class="sxs-lookup"><span data-stu-id="e8f11-137">Step 2: Deciding Where to Store the Binary Data</span></span>

<span data-ttu-id="e8f11-138">Dados binários que está associados com o modelo de dados do aplicativo s podem ser armazenados em um dos dois locais: no sistema de arquivos de servidor s da web com uma referência para o arquivo armazenado no banco de dados; ou diretamente dentro do próprio banco de dados (veja a Figura 4).</span><span class="sxs-lookup"><span data-stu-id="e8f11-138">Binary data that is associated with the application s data model can be stored in one of two places: on the web server s file system with a reference to the file stored in the database; or directly within the database itself (see Figure 4).</span></span> <span data-ttu-id="e8f11-139">Cada abordagem tem seu próprio conjunto de prós e contras e merece uma discussão mais detalhada.</span><span class="sxs-lookup"><span data-stu-id="e8f11-139">Each approach has its own set of pros and cons and merits a more detailed discussion.</span></span>

<span data-ttu-id="e8f11-140">[![Dados binários podem ser armazenados no sistema de arquivos ou diretamente no banco de dados](uploading-files-cs/_static/image4.gif)](uploading-files-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="e8f11-140">[![Binary Data Can Be Stored On the File System or Directly in the Database](uploading-files-cs/_static/image4.gif)](uploading-files-cs/_static/image3.png)</span></span>

<span data-ttu-id="e8f11-141">**Figura 4**: Dados binários podem ser armazenados no sistema de arquivos ou diretamente no banco de dados ([clique para exibir a imagem em tamanho normal](uploading-files-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="e8f11-141">**Figure 4**: Binary Data Can Be Stored On the File System or Directly in the Database ([Click to view full-size image](uploading-files-cs/_static/image4.png))</span></span>

<span data-ttu-id="e8f11-142">Imagine que gostaríamos de estender o banco de dados Northwind para associar uma imagem de cada produto.</span><span class="sxs-lookup"><span data-stu-id="e8f11-142">Imagine that we wanted to extend the Northwind database to associate a picture with each product.</span></span> <span data-ttu-id="e8f11-143">Uma opção seria armazenar esses arquivos de imagem no sistema de arquivos da web do servidor s e registre o caminho no `Products` tabela.</span><span class="sxs-lookup"><span data-stu-id="e8f11-143">One option would be to store these image files on the web server s file system and record the path in the `Products` table.</span></span> <span data-ttu-id="e8f11-144">Com essa abordagem, d adicionamos uma `ImagePath` coluna para o `Products` tabela de tipo `varchar(200)`, talvez.</span><span class="sxs-lookup"><span data-stu-id="e8f11-144">With this approach, we d add an `ImagePath` column to the `Products` table of type `varchar(200)`, perhaps.</span></span> <span data-ttu-id="e8f11-145">Quando um usuário carregar uma imagem de Chai, essa imagem pode ser armazenada no sistema de arquivos de s do servidor web no `~/Images/Tea.jpg`, onde `~` representa o caminho físico do aplicativo s.</span><span class="sxs-lookup"><span data-stu-id="e8f11-145">When a user uploaded a picture for Chai, that picture might be stored on the web server s file system at `~/Images/Tea.jpg`, where `~` represents the application s physical path.</span></span> <span data-ttu-id="e8f11-146">Ou seja, se o site da web está enraizada no caminho físico `C:\Websites\Northwind\`, `~/Images/Tea.jpg` seria equivalente a `C:\Websites\Northwind\Images\Tea.jpg`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-146">That is, if the web site is rooted at the physical path `C:\Websites\Northwind\`, `~/Images/Tea.jpg` would be equivalent to `C:\Websites\Northwind\Images\Tea.jpg`.</span></span> <span data-ttu-id="e8f11-147">Depois de carregar o arquivo de imagem, d atualizamos o registro Chai na `Products` tabela, de modo que seu `ImagePath` coluna referenciada o caminho da nova imagem.</span><span class="sxs-lookup"><span data-stu-id="e8f11-147">After uploading the image file, we d update the Chai record in the `Products` table so that its `ImagePath` column referenced the path of the new image.</span></span> <span data-ttu-id="e8f11-148">Poderíamos usar `~/Images/Tea.jpg` ou apenas `Tea.jpg` se, decidimos que todas as imagens de produto devem ser colocadas em aplicativo s `Images` pasta.</span><span class="sxs-lookup"><span data-stu-id="e8f11-148">We could use `~/Images/Tea.jpg` or just `Tea.jpg` if we decided that all product images would be placed in the application s `Images` folder.</span></span>

<span data-ttu-id="e8f11-149">As principais vantagens de armazenar os dados binários no sistema de arquivos são:</span><span class="sxs-lookup"><span data-stu-id="e8f11-149">The main advantages of storing the binary data on the file system are:</span></span>

- <span data-ttu-id="e8f11-150">**Facilidade de implementação** como você verá em breve, armazenar e recuperar dados binários armazenados diretamente no banco de dados envolvem um pouco mais código que ao trabalhar com dados por meio do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="e8f11-150">**Ease of implementation** as we'll see shortly, storing and retrieving binary data stored directly within the database involves a bit more code than when working with data through the file system.</span></span> <span data-ttu-id="e8f11-151">Além disso, para que um usuário exibir ou baixar dados binários devem ser apresentada a eles uma URL para que os dados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-151">Additionally, in order for a user to view or download binary data they must be presented with a URL to that data.</span></span> <span data-ttu-id="e8f11-152">Se os dados residem no sistema de arquivo do web server s, a URL é simples.</span><span class="sxs-lookup"><span data-stu-id="e8f11-152">If the data resides on the web server s file system, the URL is straightforward.</span></span> <span data-ttu-id="e8f11-153">Se os dados são armazenados no banco de dados, no entanto, uma página da web precisa ser criado que irá recuperar e retornar os dados do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-153">If the data is stored in the database, however, a web page needs to be created that will retrieve and return the data from the database.</span></span>
- <span data-ttu-id="e8f11-154">**Acesso mais amplo aos dados binários** os dados binários talvez precise ser acessíveis a outros serviços ou aplicativos, os que não é possível efetuar pull dos dados do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-154">**Wider access to the binary data** the binary data may need to be accessible to other services or applications, ones that cannot pull the data from the database.</span></span> <span data-ttu-id="e8f11-155">Por exemplo, as imagens associadas a cada produto podem também precisam estar disponíveis aos usuários por meio [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), nesse caso, estamos d deseja armazenar os dados binários no sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="e8f11-155">For example, the images associated with each product might also need to be available to users through [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), in which case we d want to store the binary data on the file system.</span></span>
- <span data-ttu-id="e8f11-156">**Desempenho** se os dados binários são armazenados no sistema de arquivos, o congestionamento de rede e por demanda entre o servidor de banco de dados e o servidor web será menor se os dados binários são armazenados diretamente no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-156">**Performance** if the binary data is stored on the file system, the demand and network congestion between the database server and web server will be less than if the binary data is stored directly within the database.</span></span>

<span data-ttu-id="e8f11-157">A principal desvantagem de armazenar dados binários no sistema de arquivos é que ele separa os dados do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-157">The main disadvantage of storing binary data on the file system is that it decouples the data from the database.</span></span> <span data-ttu-id="e8f11-158">Se um registro é excluído do `Products` tabela, o arquivo associado no sistema de arquivos da web do servidor s não é excluída automaticamente.</span><span class="sxs-lookup"><span data-stu-id="e8f11-158">If a record is deleted from the `Products` table, the associated file on the web server s file system is not automatically deleted.</span></span> <span data-ttu-id="e8f11-159">Podemos deve gravar código extra para excluir o arquivo ou o sistema de arquivos será fiquem desorganizado com arquivos não utilizados, órfãos.</span><span class="sxs-lookup"><span data-stu-id="e8f11-159">We must write extra code to delete the file or the file system will become cluttered with unused, orphaned files.</span></span> <span data-ttu-id="e8f11-160">Além disso, ao fazer backup de banco de dados, podemos deve se certificar de fazer backups dos dados binários associados no sistema de arquivos, também.</span><span class="sxs-lookup"><span data-stu-id="e8f11-160">Furthermore, when backing up the database, we must make sure to make backups of the associated binary data on the file system, as well.</span></span> <span data-ttu-id="e8f11-161">Movendo o banco de dados para outro site ou servidor influenciarem semelhante.</span><span class="sxs-lookup"><span data-stu-id="e8f11-161">Moving the database to another site or server poses similar challenges.</span></span>

<span data-ttu-id="e8f11-162">Como alternativa, os dados binários podem ser armazenados diretamente em um banco de dados do Microsoft SQL Server 2005 com a criação de uma coluna do tipo `varbinary`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-162">Alternatively, binary data can be stored directly in a Microsoft SQL Server 2005 database by creating a column of type `varbinary`.</span></span> <span data-ttu-id="e8f11-163">Como com outros tipos de dados de comprimento variável, você pode especificar um comprimento máximo dos dados binários que podem ser mantidos nesta coluna.</span><span class="sxs-lookup"><span data-stu-id="e8f11-163">Like with other variable length data types, you can specify a maximum length of the binary data that can be held in this column.</span></span> <span data-ttu-id="e8f11-164">Por exemplo, para reservar no máximo 5.000 bytes usar `varbinary(5000)`; `varbinary(MAX)` permite que o tamanho máximo de armazenamento, cerca de 2 GB.</span><span class="sxs-lookup"><span data-stu-id="e8f11-164">For example, to reserve at most 5,000 bytes use `varbinary(5000)`; `varbinary(MAX)` allows for the maximum storage size, about 2 GB.</span></span>

<span data-ttu-id="e8f11-165">A principal vantagem de armazenar dados binários diretamente no banco de dados é o acoplamento rígido entre os dados binários e o registro de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-165">The main advantage of storing binary data directly in the database is the tight coupling between the binary data and the database record.</span></span> <span data-ttu-id="e8f11-166">Isso simplifica bastante a tarefas de administração de banco de dados, como backups ou mover o banco de dados para um site ou servidor diferente.</span><span class="sxs-lookup"><span data-stu-id="e8f11-166">This greatly simplifies database administration tasks, like backups or moving the database to a different site or server.</span></span> <span data-ttu-id="e8f11-167">Além disso, a exclusão de um registro automaticamente exclui os dados binários correspondentes.</span><span class="sxs-lookup"><span data-stu-id="e8f11-167">Also, deleting a record automatically deletes the corresponding binary data.</span></span> <span data-ttu-id="e8f11-168">Também há mais benefícios sutis de armazenar os dados binários no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-168">There are also more subtle benefits of storing the binary data in the database.</span></span> <span data-ttu-id="e8f11-169">Ver [armazenar binários arquivos diretamente no banco de dados usando o ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) para uma discussão mais detalhada.</span><span class="sxs-lookup"><span data-stu-id="e8f11-169">See [Storing Binary Files Directly in the Database Using ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) for a more in-depth discussion.</span></span>

> [!NOTE]
> <span data-ttu-id="e8f11-170">No Microsoft SQL Server 2000 e versões anteriores, o `varbinary` tipo de dados tem um limite máximo de 8.000 bytes.</span><span class="sxs-lookup"><span data-stu-id="e8f11-170">In Microsoft SQL Server 2000 and earlier versions, the `varbinary` data type had a maximum limit of 8,000 bytes.</span></span> <span data-ttu-id="e8f11-171">Para armazenar até 2 GB de dados binários a [ `image` tipo de dados](https://msdn.microsoft.com/library/ms187993.aspx) precisa ser usado em vez disso.</span><span class="sxs-lookup"><span data-stu-id="e8f11-171">To store up to 2 GB of binary data the [`image` data type](https://msdn.microsoft.com/library/ms187993.aspx) needs to be used instead.</span></span> <span data-ttu-id="e8f11-172">Com a adição de `MAX` no SQL Server 2005, no entanto, o `image` tipo de dados foi preterido.</span><span class="sxs-lookup"><span data-stu-id="e8f11-172">With the addition of `MAX` in SQL Server 2005, however, the `image` data type has been deprecated.</span></span> <span data-ttu-id="e8f11-173">-S ainda com compatibilidade, mas a Microsoft anunciou que o `image` tipo de dados será removido em uma versão futura do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e8f11-173">It s still supported for backwards compatibility, but Microsoft has announced that the `image` data type will be removed in a future version of SQL Server.</span></span>

<span data-ttu-id="e8f11-174">Se você estiver trabalhando com um modelo de dados mais antigo que você pode ver o `image` tipo de dados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-174">If you are working with an older data model you may see the `image` data type.</span></span> <span data-ttu-id="e8f11-175">O banco de dados Northwind s `Categories` a tabela tem um `Picture` coluna que pode ser usada para armazenar os dados binários de um arquivo de imagem para a categoria.</span><span class="sxs-lookup"><span data-stu-id="e8f11-175">The Northwind database s `Categories` table has a `Picture` column that can be used to store the binary data of an image file for the category.</span></span> <span data-ttu-id="e8f11-176">Como o banco de dados Northwind tem suas raízes no Microsoft Access e versões anteriores do SQL Server, essa coluna é do tipo `image`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-176">Since the Northwind database has its roots in Microsoft Access and earlier versions of SQL Server, this column is of type `image`.</span></span>

<span data-ttu-id="e8f11-177">Para este tutorial e os próximos três, vamos usar ambas as abordagens.</span><span class="sxs-lookup"><span data-stu-id="e8f11-177">For this tutorial and the next three, we'll use both approaches.</span></span> <span data-ttu-id="e8f11-178">O `Categories` tabela já tem um `Picture` coluna para armazenar o conteúdo binário de uma imagem para a categoria.</span><span class="sxs-lookup"><span data-stu-id="e8f11-178">The `Categories` table already has a `Picture` column for storing the binary content of an image for the category.</span></span> <span data-ttu-id="e8f11-179">Vamos adicionar uma coluna adicional, `BrochurePath`, para armazenar um caminho para um PDF no sistema de arquivos s do servidor web que pode ser usado para fornecer uma visão geral de qualidade de impressão e sofisticada da categoria.</span><span class="sxs-lookup"><span data-stu-id="e8f11-179">We'll add an additional column, `BrochurePath`, to store a path to a PDF on the web server s file system that can be used to provide a print-quality, polished overview of the category.</span></span>

## <a name="step-3-adding-thebrochurepathcolumn-to-thecategoriestable"></a><span data-ttu-id="e8f11-180">Etapa 3: Adicionando o`BrochurePath`coluna para o`Categories`tabela</span><span class="sxs-lookup"><span data-stu-id="e8f11-180">Step 3: Adding the`BrochurePath`Column to the`Categories`Table</span></span>

<span data-ttu-id="e8f11-181">Atualmente, a tabela de categorias tem apenas quatro colunas: `CategoryID`, `CategoryName`, `Description`, e `Picture`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-181">Currently the Categories table has only four columns: `CategoryID`, `CategoryName`, `Description`, and `Picture`.</span></span> <span data-ttu-id="e8f11-182">Além desses campos, precisamos adicionar um novo que irá apontar para o folheto categoria s (se houver).</span><span class="sxs-lookup"><span data-stu-id="e8f11-182">In addition to these fields, we need to add a new one that will point to the category s brochure (if one exists).</span></span> <span data-ttu-id="e8f11-183">Para adicionar essa coluna, vá para o Gerenciador de servidores, fazer uma busca detalhada nas tabelas, clique com botão direito no `Categories` da tabela e escolha Abrir definição de tabela (consulte a Figura 5).</span><span class="sxs-lookup"><span data-stu-id="e8f11-183">To add this column, go to the Server Explorer, drill down into the Tables, right-click on the `Categories` table and choose Open Table Definition (see Figure 5).</span></span> <span data-ttu-id="e8f11-184">Se você não vir o Gerenciador de servidores, ativá-la selecionando a opção de Gerenciador de servidores, no menu Exibir, ou pressione Ctrl + Alt + S.</span><span class="sxs-lookup"><span data-stu-id="e8f11-184">If you do not see the Server Explorer, bring it up by selecting the Server Explorer option from the View menu, or hit Ctrl+Alt+S.</span></span>

<span data-ttu-id="e8f11-185">Adicione um novo `varchar(200)` coluna para o `Categories` tabela denominada `BrochurePath` e permite `NULL` s e clique no ícone Salvar (ou pressione Ctrl + S).</span><span class="sxs-lookup"><span data-stu-id="e8f11-185">Add a new `varchar(200)` column to the `Categories` table that is named `BrochurePath` and allows `NULL` s and click the Save icon (or hit Ctrl+S).</span></span>

<span data-ttu-id="e8f11-186">[![Adicionar uma coluna de BrochurePath à tabela de categorias](uploading-files-cs/_static/image5.gif)](uploading-files-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e8f11-186">[![Add a BrochurePath Column to the Categories Table](uploading-files-cs/_static/image5.gif)](uploading-files-cs/_static/image5.png)</span></span>

<span data-ttu-id="e8f11-187">**Figura 5**: Adicionar um `BrochurePath` coluna para o `Categories` tabela ([clique para exibir a imagem em tamanho normal](uploading-files-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e8f11-187">**Figure 5**: Add a `BrochurePath` Column to the `Categories` Table ([Click to view full-size image](uploading-files-cs/_static/image6.png))</span></span>

## <a name="step-4-updating-the-architecture-to-use-thepictureandbrochurepathcolumns"></a><span data-ttu-id="e8f11-188">Etapa 4: Atualizando a arquitetura para usar o`Picture`e`BrochurePath`colunas</span><span class="sxs-lookup"><span data-stu-id="e8f11-188">Step 4: Updating the Architecture to Use the`Picture`and`BrochurePath`Columns</span></span>

<span data-ttu-id="e8f11-189">O `CategoriesDataTable` na camada de acesso a dados (DAL) atualmente tem quatro `DataColumn` s definidas: `CategoryID`, `CategoryName`, `Description`, e `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-189">The `CategoriesDataTable` in the Data Access Layer (DAL) currently has four `DataColumn` s defined: `CategoryID`, `CategoryName`, `Description`, and `NumberOfProducts`.</span></span> <span data-ttu-id="e8f11-190">Quando projetamos originalmente essa DataTable na [criando uma camada de acesso de dados](../introduction/creating-a-data-access-layer-cs.md) tutorial, o `CategoriesDataTable` tinha apenas as três primeiras colunas; o `NumberOfProducts` coluna foi adicionada no [mestre/detalhes usando um com marcadores Lista de registros mestre com um DataList de detalhes](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="e8f11-190">When we originally designed this DataTable in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial, the `CategoriesDataTable` only had the first three columns; the `NumberOfProducts` column was added in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial.</span></span>

<span data-ttu-id="e8f11-191">Conforme discutido em *criando uma camada de acesso a dados*, tabelas de dados no conjunto de dados tipado compõem os objetos de negócios.</span><span class="sxs-lookup"><span data-stu-id="e8f11-191">As discussed in *Creating a Data Access Layer*, the DataTables in the Typed DataSet make up the business objects.</span></span> <span data-ttu-id="e8f11-192">Os TableAdapters são responsáveis por comunicar-se com o banco de dados e preencher os objetos de negócios com os resultados da consulta.</span><span class="sxs-lookup"><span data-stu-id="e8f11-192">The TableAdapters are responsible for communicating with the database and populating the business objects with the query results.</span></span> <span data-ttu-id="e8f11-193">O `CategoriesDataTable` é preenchida pelo `CategoriesTableAdapter`, que tem três métodos de recuperação de dados:</span><span class="sxs-lookup"><span data-stu-id="e8f11-193">The `CategoriesDataTable` is populated by the `CategoriesTableAdapter`, which has three data retrieval methods:</span></span>

- <span data-ttu-id="e8f11-194">`GetCategories()` executa a consulta principal do TableAdapter s e retorna o `CategoryID`, `CategoryName`, e `Description` campos de todos os registros no `Categories` tabela.</span><span class="sxs-lookup"><span data-stu-id="e8f11-194">`GetCategories()` executes the TableAdapter s main query and returns the `CategoryID`, `CategoryName`, and `Description` fields of all records in the `Categories` table.</span></span> <span data-ttu-id="e8f11-195">A consulta principal é o que é usado pelo geradas automaticamente `Insert` e `Update` métodos.</span><span class="sxs-lookup"><span data-stu-id="e8f11-195">The main query is what is used by the auto-generated `Insert` and `Update` methods.</span></span>
- <span data-ttu-id="e8f11-196">`GetCategoryByCategoryID(categoryID)` Retorna o `CategoryID`, `CategoryName`, e `Description` campos da categoria cujas `CategoryID` é igual a *categoryID*.</span><span class="sxs-lookup"><span data-stu-id="e8f11-196">`GetCategoryByCategoryID(categoryID)` returns the `CategoryID`, `CategoryName`, and `Description` fields of the category whose `CategoryID` equals *categoryID*.</span></span>
- <span data-ttu-id="e8f11-197">`GetCategoriesAndNumberOfProducts()` -Retorna o `CategoryID`, `CategoryName`, e `Description` campos para todos os registros no `Categories` tabela.</span><span class="sxs-lookup"><span data-stu-id="e8f11-197">`GetCategoriesAndNumberOfProducts()` - returns the `CategoryID`, `CategoryName`, and `Description` fields for all records in the `Categories` table.</span></span> <span data-ttu-id="e8f11-198">Também usa uma subconsulta para retornar o número de produtos associados a cada categoria.</span><span class="sxs-lookup"><span data-stu-id="e8f11-198">Also uses a subquery to return the number of products associated with each category.</span></span>

<span data-ttu-id="e8f11-199">Observe que nenhuma dessas consultas retornam os `Categories` tabela s `Picture` ou `BrochurePath` colunas; nem faz a `CategoriesDataTable` fornecer `DataColumn` s para esses campos.</span><span class="sxs-lookup"><span data-stu-id="e8f11-199">Notice that none of these queries return the `Categories` table s `Picture` or `BrochurePath` columns; nor does the `CategoriesDataTable` provide `DataColumn` s for these fields.</span></span> <span data-ttu-id="e8f11-200">Para trabalhar com a imagem e `BrochurePath` propriedades, precisamos primeiro adicioná-los para o `CategoriesDataTable` e, em seguida, atualize o `CategoriesTableAdapter` classe para retornar essas colunas.</span><span class="sxs-lookup"><span data-stu-id="e8f11-200">In order to work with the Picture and `BrochurePath` properties, we need to first add them to the `CategoriesDataTable` and then update the `CategoriesTableAdapter` class to return these columns.</span></span>

## <a name="adding-thepictureandbrochurepathdatacolumn-s"></a><span data-ttu-id="e8f11-201">Adicionando o`Picture`e`BrochurePath``DataColumn` s</span><span class="sxs-lookup"><span data-stu-id="e8f11-201">Adding the`Picture`and`BrochurePath``DataColumn` s</span></span>

<span data-ttu-id="e8f11-202">Comece por adicionar essas duas colunas para o `CategoriesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-202">Start by adding these two columns to the `CategoriesDataTable`.</span></span> <span data-ttu-id="e8f11-203">Clique com botão direito no `CategoriesDataTable` cabeçalho s, selecione Adicionar no menu de contexto e, em seguida, escolha a opção de coluna.</span><span class="sxs-lookup"><span data-stu-id="e8f11-203">Right-click on the `CategoriesDataTable` s header, select Add from the context menu and then choose the Column option.</span></span> <span data-ttu-id="e8f11-204">Isso criará um novo `DataColumn` na DataTable chamado `Column1`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-204">This will create a new `DataColumn` in the DataTable named `Column1`.</span></span> <span data-ttu-id="e8f11-205">Renomeie esta coluna como `Picture`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-205">Rename this column to `Picture`.</span></span> <span data-ttu-id="e8f11-206">Na janela Propriedades, defina as `DataColumn` s `DataType` propriedade `System.Byte[]` (isso não é uma opção na lista suspensa; você precisa digitá-lo em).</span><span class="sxs-lookup"><span data-stu-id="e8f11-206">From the Properties window, set the `DataColumn` s `DataType` property to `System.Byte[]` (this is not an option in the drop-down list; you need to type it in).</span></span>

<span data-ttu-id="e8f11-207">[![Criar uma imagem chamada DataColumn cujo tipo de dados é [System]](uploading-files-cs/_static/image6.gif)](uploading-files-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e8f11-207">[![Create a DataColumn Named Picture whose DataType is System.Byte[]](uploading-files-cs/_static/image6.gif)](uploading-files-cs/_static/image7.png)</span></span>

<span data-ttu-id="e8f11-208">**Figura 6**: Criar uma `DataColumn` nomeado `Picture` cuja `DataType` é `System.Byte[]` ([clique para exibir a imagem em tamanho normal](uploading-files-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="e8f11-208">**Figure 6**: Create a `DataColumn` Named `Picture` whose `DataType` is `System.Byte[]` ([Click to view full-size image](uploading-files-cs/_static/image8.png))</span></span>

<span data-ttu-id="e8f11-209">Adicione outro `DataColumn` para DataTable, nomeando- `BrochurePath` usando o padrão `DataType` valor (`System.String`).</span><span class="sxs-lookup"><span data-stu-id="e8f11-209">Add another `DataColumn` to the DataTable, naming it `BrochurePath` using the default `DataType` value (`System.String`).</span></span>

## <a name="returning-thepictureandbrochurepathvalues-from-the-tableadapter"></a><span data-ttu-id="e8f11-210">Retornando o`Picture`e`BrochurePath`valores do TableAdapter</span><span class="sxs-lookup"><span data-stu-id="e8f11-210">Returning the`Picture`and`BrochurePath`Values from the TableAdapter</span></span>

<span data-ttu-id="e8f11-211">Com esses dois `DataColumn` s adicionado para o `CategoriesDataTable`, podemos está pronto para atualizar o `CategoriesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-211">With these two `DataColumn` s added to the `CategoriesDataTable`, we re ready to update the `CategoriesTableAdapter`.</span></span> <span data-ttu-id="e8f11-212">Poderíamos ter ambos os valores de coluna retornados na consulta principal do TableAdapter, mas isso seria trazer de volta os dados binários sempre o `GetCategories()` método foi invocado.</span><span class="sxs-lookup"><span data-stu-id="e8f11-212">We could have both of these column values returned in the main TableAdapter query, but this would bring back the binary data every time the `GetCategories()` method was invoked.</span></span> <span data-ttu-id="e8f11-213">Em vez disso, let s atualize a consulta principal do TableAdapter para trazer de volta `BrochurePath` e crie um método de recuperação de dados adicionais que retorna uma determinada categoria s `Picture` coluna.</span><span class="sxs-lookup"><span data-stu-id="e8f11-213">Instead, let s update the main TableAdapter query to bring back `BrochurePath` and create an additional data retrieval method that returns a particular category s `Picture` column.</span></span>

<span data-ttu-id="e8f11-214">Para atualizar a consulta do TableAdapter principal, clique com botão direito no `CategoriesTableAdapter` cabeçalho s e escolha a opção de configurar o menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="e8f11-214">To update the main TableAdapter query, right-click on the `CategoriesTableAdapter` s header and choose the Configure option from the context menu.</span></span> <span data-ttu-id="e8f11-215">Isso abre o Assistente de configuração do adaptador de tabela, que podemos ve visto em vários tutoriais anteriores.</span><span class="sxs-lookup"><span data-stu-id="e8f11-215">This brings up the Table Adapter Configuration Wizard, which we ve seen in a number of past tutorials.</span></span> <span data-ttu-id="e8f11-216">Atualize a consulta para trazer de volta a `BrochurePath` e clique em Concluir.</span><span class="sxs-lookup"><span data-stu-id="e8f11-216">Update the query to bring back the `BrochurePath` and click Finish.</span></span>

<span data-ttu-id="e8f11-217">[![Atualizar a lista de colunas na instrução SELECT para retornar também BrochurePath](uploading-files-cs/_static/image7.gif)](uploading-files-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="e8f11-217">[![Update the Column List in the SELECT Statement to Also Return BrochurePath](uploading-files-cs/_static/image7.gif)](uploading-files-cs/_static/image9.png)</span></span>

<span data-ttu-id="e8f11-218">**Figura 7**: Atualizar a lista de colunas na `SELECT` instrução para retornar também `BrochurePath` ([clique para exibir a imagem em tamanho normal](uploading-files-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="e8f11-218">**Figure 7**: Update the Column List in the `SELECT` Statement to Also Return `BrochurePath` ([Click to view full-size image](uploading-files-cs/_static/image10.png))</span></span>

<span data-ttu-id="e8f11-219">Ao usar instruções SQL ad hoc para o TableAdapter, atualizando a lista de colunas na consulta principal atualiza a lista de colunas para todos os `SELECT` métodos TableAdapter de consulta.</span><span class="sxs-lookup"><span data-stu-id="e8f11-219">When using ad-hoc SQL statements for the TableAdapter, updating the column list in the main query updates the column list for all of the `SELECT` query methods in the TableAdapter.</span></span> <span data-ttu-id="e8f11-220">Isso significa que o `GetCategoryByCategoryID(categoryID)` método foi atualizado para retornar o `BrochurePath` coluna, que pode ser o que podemos pretendia.</span><span class="sxs-lookup"><span data-stu-id="e8f11-220">That means the `GetCategoryByCategoryID(categoryID)` method has been updated to return the `BrochurePath` column, which might be what we intended.</span></span> <span data-ttu-id="e8f11-221">No entanto, ela também atualizada a lista de colunas no `GetCategoriesAndNumberOfProducts()` método, remover a subconsulta que retorna o número de produtos para cada categoria!</span><span class="sxs-lookup"><span data-stu-id="e8f11-221">However, it also updated the column list in the `GetCategoriesAndNumberOfProducts()` method, removing the subquery that returns the number of products for each category!</span></span> <span data-ttu-id="e8f11-222">Portanto, precisamos atualizar esse método s `SELECT` consulta.</span><span class="sxs-lookup"><span data-stu-id="e8f11-222">Therefore, we need to update this method s `SELECT` query.</span></span> <span data-ttu-id="e8f11-223">Clique com botão direito no `GetCategoriesAndNumberOfProducts()` método, escolha Configure e reverter a `SELECT` consulta de volta para seu valor original:</span><span class="sxs-lookup"><span data-stu-id="e8f11-223">Right-click on the `GetCategoriesAndNumberOfProducts()` method, choose Configure, and revert the `SELECT` query back to its original value:</span></span>

[!code-sql[Main](uploading-files-cs/samples/sample2.sql)]

<span data-ttu-id="e8f11-224">Em seguida, crie um novo método do TableAdapter que retorna uma determinada categoria s `Picture` valor da coluna.</span><span class="sxs-lookup"><span data-stu-id="e8f11-224">Next, create a new TableAdapter method that returns a particular category s `Picture` column value.</span></span> <span data-ttu-id="e8f11-225">Clique com botão direito no `CategoriesTableAdapter` cabeçalho s e escolha a opção Add Query para iniciar o Assistente de configuração de consulta do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e8f11-225">Right-click on the `CategoriesTableAdapter` s header and choose the Add Query option to launch the TableAdapter Query Configuration Wizard.</span></span> <span data-ttu-id="e8f11-226">A primeira etapa deste assistente pergunta que se quisermos para consultar dados usando uma instrução de SQL ad hoc, um novo procedimento armazenado, ou um existente.</span><span class="sxs-lookup"><span data-stu-id="e8f11-226">The first step of this wizard asks us if we want to query data using an ad-hoc SQL statement, a new stored procedure, or an existing one.</span></span> <span data-ttu-id="e8f11-227">Selecione usar instruções SQL e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="e8f11-227">Select Use SQL statements and click Next.</span></span> <span data-ttu-id="e8f11-228">Como podemos será retornada uma linha, escolha o SELECT que retorna a opção de linhas da segunda etapa.</span><span class="sxs-lookup"><span data-stu-id="e8f11-228">Since we will be returning a row, choose the SELECT which returns rows option from the second step.</span></span>

<span data-ttu-id="e8f11-229">[![Selecione as opção Use SQL statements](uploading-files-cs/_static/image8.gif)](uploading-files-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="e8f11-229">[![Select the Use SQL statements Option](uploading-files-cs/_static/image8.gif)](uploading-files-cs/_static/image11.png)</span></span>

<span data-ttu-id="e8f11-230">**Figura 8**: Selecione as opção Use SQL statements ([clique para exibir a imagem em tamanho normal](uploading-files-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e8f11-230">**Figure 8**: Select the Use SQL statements Option ([Click to view full-size image](uploading-files-cs/_static/image12.png))</span></span>

<span data-ttu-id="e8f11-231">[![Uma vez que a consulta retornará um registro da tabela de categorias, escolha SELECT que retorna linhas](uploading-files-cs/_static/image9.gif)](uploading-files-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e8f11-231">[![Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows](uploading-files-cs/_static/image9.gif)](uploading-files-cs/_static/image13.png)</span></span>

<span data-ttu-id="e8f11-232">**Figura 9**: Uma vez que a consulta retornará um registro da tabela de categorias, escolha Selecionar que retorna linhas ([clique para exibir a imagem em tamanho normal](uploading-files-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="e8f11-232">**Figure 9**: Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows ([Click to view full-size image](uploading-files-cs/_static/image14.png))</span></span>

<span data-ttu-id="e8f11-233">Na terceira etapa, insira a seguinte consulta SQL e clique em Avançar:</span><span class="sxs-lookup"><span data-stu-id="e8f11-233">In the third step, enter the following SQL query and click Next:</span></span>

[!code-sql[Main](uploading-files-cs/samples/sample3.sql)]

<span data-ttu-id="e8f11-234">A última etapa é escolher o nome para o novo método.</span><span class="sxs-lookup"><span data-stu-id="e8f11-234">The last step is to choose the name for the new method.</span></span> <span data-ttu-id="e8f11-235">Use `FillCategoryWithBinaryDataByCategoryID` e `GetCategoryWithBinaryDataByCategoryID` para o preenchimento uma DataTable e retornar uma DataTable padrões, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="e8f11-235">Use `FillCategoryWithBinaryDataByCategoryID` and `GetCategoryWithBinaryDataByCategoryID` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span> <span data-ttu-id="e8f11-236">Clique em Concluir para concluir o assistente.</span><span class="sxs-lookup"><span data-stu-id="e8f11-236">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="e8f11-237">[![Escolha os nomes dos métodos do TableAdapter s](uploading-files-cs/_static/image10.gif)](uploading-files-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="e8f11-237">[![Choose the Names for the TableAdapter s Methods](uploading-files-cs/_static/image10.gif)](uploading-files-cs/_static/image15.png)</span></span>

<span data-ttu-id="e8f11-238">**Figura 10**: Escolha os nomes para os métodos do TableAdapter s ([clique para exibir a imagem em tamanho normal](uploading-files-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="e8f11-238">**Figure 10**: Choose the Names for the TableAdapter s Methods ([Click to view full-size image](uploading-files-cs/_static/image16.png))</span></span>

> [!NOTE]
> <span data-ttu-id="e8f11-239">Depois de concluir o Assistente de configuração de consulta de adaptador de tabela, você poderá ver uma caixa de diálogo informando que o novo texto de comando retorna dados com esquema diferente do esquema da consulta principal.</span><span class="sxs-lookup"><span data-stu-id="e8f11-239">After completing the Table Adapter Query Configuration Wizard you may see a dialog box informing you that the new command text returns data with schema different from the schema of the main query.</span></span> <span data-ttu-id="e8f11-240">Em resumo, o assistente é observar que a consulta principal do TableAdapter s `GetCategories()` retorna um esquema diferente daquele que acabamos de criar.</span><span class="sxs-lookup"><span data-stu-id="e8f11-240">In short, the wizard is noting that the TableAdapter s main query `GetCategories()` returns a different schema than the one we just created.</span></span> <span data-ttu-id="e8f11-241">Mas isso é o que queremos, portanto, você pode ignorar essa mensagem.</span><span class="sxs-lookup"><span data-stu-id="e8f11-241">But this is what we want, so you can disregard this message.</span></span>

<span data-ttu-id="e8f11-242">Além disso, tenha em mente que se você estiver usando instruções SQL ad hoc e use o Assistente para alterar a consulta principal do TableAdapter s em algum momento posterior no tempo, ele modificará o `GetCategoryWithBinaryDataByCategoryID` método s `SELECT` lista de colunas de instrução s para incluir apenas as colunas das consulta principal (ou seja, ele removerá o `Picture` coluna da consulta).</span><span class="sxs-lookup"><span data-stu-id="e8f11-242">Also, keep in mind that if you are using ad-hoc SQL statements and use the wizard to change the TableAdapter s main query at some later point in time, it will modify the `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement s column list to include just those columns from the main query (that is, it will remove the `Picture` column from the query).</span></span> <span data-ttu-id="e8f11-243">Você terá que atualizar manualmente a lista de colunas para retornar os `Picture` coluna, semelhante ao que fizemos com o `GetCategoriesAndNumberOfProducts()` método no início desta etapa.</span><span class="sxs-lookup"><span data-stu-id="e8f11-243">You will have to manually update the column list to return the `Picture` column, similar to what we did with the `GetCategoriesAndNumberOfProducts()` method earlier in this step.</span></span>

<span data-ttu-id="e8f11-244">Depois de adicionar os dois `DataColumn` s para o `CategoriesDataTable` e o `GetCategoryWithBinaryDataByCategoryID` método para o `CategoriesTableAdapter`, essas classes no Designer de conjunto de dados tipado devem se parecer com a captura de tela na Figura 11.</span><span class="sxs-lookup"><span data-stu-id="e8f11-244">After adding the two `DataColumn` s to the `CategoriesDataTable` and the `GetCategoryWithBinaryDataByCategoryID` method to the `CategoriesTableAdapter`, these classes in the Typed DataSet Designer should look like the screenshot in Figure 11.</span></span>

![O Designer de conjunto de dados inclui as novas colunas e o método](uploading-files-cs/_static/image11.gif)

<span data-ttu-id="e8f11-246">**Figura 11**: O Designer de conjunto de dados inclui as novas colunas e o método</span><span class="sxs-lookup"><span data-stu-id="e8f11-246">**Figure 11**: The DataSet Designer Includes the New Columns and Method</span></span>

## <a name="updating-the-business-logic-layer-bll"></a><span data-ttu-id="e8f11-247">Atualizando a camada de lógica de negócios (BLL)</span><span class="sxs-lookup"><span data-stu-id="e8f11-247">Updating the Business Logic Layer (BLL)</span></span>

<span data-ttu-id="e8f11-248">Com a DAL atualizada, tudo o que resta é aumentar os negócios lógica BLL (camada) para incluir um método para o novo `CategoriesTableAdapter` método.</span><span class="sxs-lookup"><span data-stu-id="e8f11-248">With the DAL updated, all that remains is to augment the Business Logic Layer (BLL) to include a method for the new `CategoriesTableAdapter` method.</span></span> <span data-ttu-id="e8f11-249">Adicione o seguinte método para o `CategoriesBLL` classe:</span><span class="sxs-lookup"><span data-stu-id="e8f11-249">Add the following method to the `CategoriesBLL` class:</span></span>

[!code-csharp[Main](uploading-files-cs/samples/sample4.cs)]

## <a name="step-5-uploading-a-file-from-the-client-to-the-web-server"></a><span data-ttu-id="e8f11-250">Etapa 5: Carregar um arquivo do cliente para o servidor Web</span><span class="sxs-lookup"><span data-stu-id="e8f11-250">Step 5: Uploading a File From the Client to the Web Server</span></span>

<span data-ttu-id="e8f11-251">Durante a coleta de dados binários, muitas vezes, esses dados são fornecidos por um usuário final.</span><span class="sxs-lookup"><span data-stu-id="e8f11-251">When collecting binary data, oftentimes this data is supplied by an end user.</span></span> <span data-ttu-id="e8f11-252">Para capturar essas informações, o usuário precisa ser capaz de carregar um arquivo de seu computador para o servidor web.</span><span class="sxs-lookup"><span data-stu-id="e8f11-252">To capture this information, the user needs to be able to upload a file from their computer to the web server.</span></span> <span data-ttu-id="e8f11-253">Os dados carregados, em seguida, precisam ser integrada com o modelo de dados, o que pode significar que salvar o arquivo para o sistema de arquivos do web server s e adicionar um caminho para o arquivo no banco de dados ou gravar o conteúdo binário diretamente no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-253">The uploaded data then needs to be integrated with the data model, which may mean saving the file to the web server s file system and adding a path to the file in the database, or writing the binary contents directly into the database.</span></span> <span data-ttu-id="e8f11-254">Nesta etapa, examinaremos como permitir que um usuário carrega arquivos do seu computador para o servidor.</span><span class="sxs-lookup"><span data-stu-id="e8f11-254">In this step we'll look at how to allow a user to upload files from their computer to the server.</span></span> <span data-ttu-id="e8f11-255">No próximo tutorial voltaremos nossa atenção para integrar o arquivo carregado com o modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-255">In the next tutorial we'll turn our attention to integrating the uploaded file with data model.</span></span>

<span data-ttu-id="e8f11-256">O ASP.NET 2.0 s novos [controle FileUpload Web](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) fornece um mecanismo para que os usuários enviem um arquivo de seu computador para o servidor web.</span><span class="sxs-lookup"><span data-stu-id="e8f11-256">ASP.NET 2.0 s new [FileUpload Web control](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) provides a mechanism for users to send a file from their computer to the web server.</span></span> <span data-ttu-id="e8f11-257">O controle FileUpload renderiza como um `<input>` elemento cujo `type` atributo é definido como o arquivo, que navegadores exibem como uma caixa de texto com um botão de procura.</span><span class="sxs-lookup"><span data-stu-id="e8f11-257">The FileUpload control renders as an `<input>` element whose `type` attribute is set to file, which browsers display as a textbox with a Browse button.</span></span> <span data-ttu-id="e8f11-258">Clique no botão Procurar abre uma caixa de diálogo na qual o usuário pode selecionar um arquivo.</span><span class="sxs-lookup"><span data-stu-id="e8f11-258">Clicking the Browse button brings up a dialog box from which the user can select a file.</span></span> <span data-ttu-id="e8f11-259">Quando o formulário é postado novamente, o conteúdo do arquivo selecionado s é enviado junto com o postback.</span><span class="sxs-lookup"><span data-stu-id="e8f11-259">When the form is posted back, the selected file s contents are sent along with the postback.</span></span> <span data-ttu-id="e8f11-260">No lado do servidor, informações sobre o arquivo carregado são acessíveis por meio das propriedades de s controle FileUpload.</span><span class="sxs-lookup"><span data-stu-id="e8f11-260">On the server-side, information about the uploaded file is accessible through the FileUpload control s properties.</span></span>

<span data-ttu-id="e8f11-261">Para demonstrar um carregamento de arquivos, abra o `FileUpload.aspx` página o `BinaryData` pasta, arraste um controle FileUpload da caixa de ferramentas para o Designer e defina o controle s `ID` propriedade para `UploadTest`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-261">To demonstrate uploading files, open the `FileUpload.aspx` page in the `BinaryData` folder, drag a FileUpload control from the Toolbox onto the Designer, and set the control s `ID` property to `UploadTest`.</span></span> <span data-ttu-id="e8f11-262">Em seguida, adicione um controle da Web de botão definindo sua `ID` e `Text` propriedades a serem `UploadButton` e carregue o arquivo selecionado, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="e8f11-262">Next, add a Button Web control setting its `ID` and `Text` properties to `UploadButton` and Upload Selected File, respectively.</span></span> <span data-ttu-id="e8f11-263">Por fim, coloque um controle de rótulo Web sob o botão Limpar seu `Text` propriedade e defina sua `ID` propriedade para `UploadDetails`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-263">Finally, place a Label Web control beneath the Button, clear out its `Text` property and set its `ID` property to `UploadDetails`.</span></span>

<span data-ttu-id="e8f11-264">[![Adicionar um controle FileUpload para a página ASP.NET](uploading-files-cs/_static/image12.gif)](uploading-files-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e8f11-264">[![Add a FileUpload Control to the ASP.NET Page](uploading-files-cs/_static/image12.gif)](uploading-files-cs/_static/image17.png)</span></span>

<span data-ttu-id="e8f11-265">**Figura 12**: Adicionar um controle FileUpload para a página ASP.NET ([clique para exibir a imagem em tamanho normal](uploading-files-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e8f11-265">**Figure 12**: Add a FileUpload Control to the ASP.NET Page ([Click to view full-size image](uploading-files-cs/_static/image18.png))</span></span>

<span data-ttu-id="e8f11-266">Figura 13 mostra essa página quando visualizado por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="e8f11-266">Figure 13 shows this page when viewed through a browser.</span></span> <span data-ttu-id="e8f11-267">Observe que clicar no botão Procurar abre uma caixa de diálogo de seleção de arquivo, permitindo que o usuário escolha um arquivo de seu computador.</span><span class="sxs-lookup"><span data-stu-id="e8f11-267">Note that clicking the Browse button brings up a file selection dialog box, allowing the user to pick a file from their computer.</span></span> <span data-ttu-id="e8f11-268">Depois que um arquivo tiver sido selecionado, clicar no botão carregar arquivo selecionado faz com que um postback que envia o conteúdo binário de s de arquivo selecionado para o servidor web.</span><span class="sxs-lookup"><span data-stu-id="e8f11-268">Once a file has been selected, clicking the Upload Selected File button causes a postback that sends the selected file s binary content to the web server.</span></span>

<span data-ttu-id="e8f11-269">[![O usuário pode selecionar um arquivo para carregar do seu computador ao servidor](uploading-files-cs/_static/image13.gif)](uploading-files-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e8f11-269">[![The User Can Select a File to Upload from their Computer to the Server](uploading-files-cs/_static/image13.gif)](uploading-files-cs/_static/image19.png)</span></span>

<span data-ttu-id="e8f11-270">**Figura 13**: O usuário pode selecionar um arquivo para Upload de seu computador ao servidor ([clique para exibir a imagem em tamanho normal](uploading-files-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="e8f11-270">**Figure 13**: The User Can Select a File to Upload from their Computer to the Server ([Click to view full-size image](uploading-files-cs/_static/image20.png))</span></span>

<span data-ttu-id="e8f11-271">No postback, o arquivo carregado pode ser salvo para o sistema de arquivos ou seus dados binários podem ser trabalhados diretamente por meio de um Stream.</span><span class="sxs-lookup"><span data-stu-id="e8f11-271">On postback, the uploaded file can be saved to the file system or its binary data can be worked with directly through a Stream.</span></span> <span data-ttu-id="e8f11-272">Neste exemplo, permitir que s criem um `~/Brochures` pasta e salve o arquivo carregado nela.</span><span class="sxs-lookup"><span data-stu-id="e8f11-272">For this example, let s create a `~/Brochures` folder and save the uploaded file there.</span></span> <span data-ttu-id="e8f11-273">Comece adicionando o `Brochures` pasta para o site como uma subpasta da pasta raiz.</span><span class="sxs-lookup"><span data-stu-id="e8f11-273">Start by adding the `Brochures` folder to the site as a subfolder of the root directory.</span></span> <span data-ttu-id="e8f11-274">Em seguida, crie um manipulador de eventos para o `UploadButton` s `Click` eventos e adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="e8f11-274">Next, create an event handler for the `UploadButton` s `Click` event and add the following code:</span></span>

[!code-csharp[Main](uploading-files-cs/samples/sample5.cs)]

<span data-ttu-id="e8f11-275">O controle FileUpload fornece uma variedade de propriedades para trabalhar com os dados carregados.</span><span class="sxs-lookup"><span data-stu-id="e8f11-275">The FileUpload control provides a variety of properties for working with the uploaded data.</span></span> <span data-ttu-id="e8f11-276">Por exemplo, o [ `HasFile` propriedade](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) indica se um arquivo foi carregado pelo usuário, enquanto o [ `FileBytes` propriedade](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) fornece acesso aos dados binários carregados como uma matriz de bytes.</span><span class="sxs-lookup"><span data-stu-id="e8f11-276">For instance, the [`HasFile` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) indicates whether a file was uploaded by the user, while the [`FileBytes` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) provides access to the uploaded binary data as an array of bytes.</span></span> <span data-ttu-id="e8f11-277">O `Click` manipulador de eventos é iniciado, garantindo que um arquivo foi carregado.</span><span class="sxs-lookup"><span data-stu-id="e8f11-277">The `Click` event handler starts by ensuring that a file has been uploaded.</span></span> <span data-ttu-id="e8f11-278">Se um arquivo tiver sido carregado, o rótulo mostra o nome do arquivo carregado, seu tamanho em bytes e seu tipo de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="e8f11-278">If a file has been uploaded, the Label shows the name of the uploaded file, its size in bytes, and its content-type.</span></span>

> [!NOTE]
> <span data-ttu-id="e8f11-279">Para garantir que o usuário carrega um arquivo que você pode verificar a `HasFile` propriedade e exibir um aviso se ele s `false`, ou você pode usar o [controle RequiredFieldValidator](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) em vez disso.</span><span class="sxs-lookup"><span data-stu-id="e8f11-279">To ensure that the user uploads a file you can check the `HasFile` property and display a warning if it s `false`, or you may use the [RequiredFieldValidator control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) instead.</span></span>

<span data-ttu-id="e8f11-280">O s FileUpload `SaveAs(filePath)` salva o arquivo carregado especificado *filePath*.</span><span class="sxs-lookup"><span data-stu-id="e8f11-280">The FileUpload s `SaveAs(filePath)` saves the uploaded file to the specified *filePath*.</span></span> <span data-ttu-id="e8f11-281">*filePath* deve ser um *caminho físico* (`C:\Websites\Brochures\SomeFile.pdf`) em vez de um *virtual* *caminho* (`/Brochures/SomeFile.pdf`).</span><span class="sxs-lookup"><span data-stu-id="e8f11-281">*filePath* must be a *physical path* (`C:\Websites\Brochures\SomeFile.pdf`) rather than a *virtual* *path* (`/Brochures/SomeFile.pdf`).</span></span> <span data-ttu-id="e8f11-282">O [ `Server.MapPath(virtPath)` método](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) toma um caminho virtual e retorna o caminho físico correspondente.</span><span class="sxs-lookup"><span data-stu-id="e8f11-282">The [`Server.MapPath(virtPath)` method](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) takes a virtual path and returns its corresponding physical path.</span></span> <span data-ttu-id="e8f11-283">Aqui, é o caminho virtual `~/Brochures/fileName`, onde *fileName* é o nome do arquivo carregado.</span><span class="sxs-lookup"><span data-stu-id="e8f11-283">Here, the virtual path is `~/Brochures/fileName`, where *fileName* is the name of the uploaded file.</span></span> <span data-ttu-id="e8f11-284">Ver [usando o Server. MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) para obter mais informações sobre caminhos virtuais e físicos e usar `Server.MapPath`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-284">See [Using Server.MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) for more information on virtual and physical paths and using `Server.MapPath`.</span></span>

<span data-ttu-id="e8f11-285">Depois de concluir o `Click` manipulador de eventos, reserve um tempo para testar a página em um navegador.</span><span class="sxs-lookup"><span data-stu-id="e8f11-285">After completing the `Click` event handler, take a moment to test out the page in a browser.</span></span> <span data-ttu-id="e8f11-286">Clique no botão Procurar e selecionar um arquivo de disco rígido e, em seguida, clique no botão de carregar o arquivo selecionado.</span><span class="sxs-lookup"><span data-stu-id="e8f11-286">Click the Browse button and select a file from your hard drive and then click the Upload Selected File button.</span></span> <span data-ttu-id="e8f11-287">O postback enviará o conteúdo do arquivo selecionado para o servidor web, que, em seguida, exibe informações sobre o arquivo antes de salvá-lo para o `~/Brochures` pasta.</span><span class="sxs-lookup"><span data-stu-id="e8f11-287">The postback will send the contents of the selected file to the web server, which will then display information about the file before saving it to the `~/Brochures` folder.</span></span> <span data-ttu-id="e8f11-288">Depois de carregar o arquivo, retorne ao Visual Studio e clique no botão Atualizar no Gerenciador de soluções.</span><span class="sxs-lookup"><span data-stu-id="e8f11-288">After uploading the file, return to Visual Studio and click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="e8f11-289">Você deve ver o arquivo que você acabou de carregar na pasta ~/Brochures!</span><span class="sxs-lookup"><span data-stu-id="e8f11-289">You should see the file you just uploaded in the ~/Brochures folder!</span></span>

<span data-ttu-id="e8f11-290">[![EvolutionValley.jpg o arquivo foi carregado para o servidor Web](uploading-files-cs/_static/image14.gif)](uploading-files-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="e8f11-290">[![The File EvolutionValley.jpg Has Been Uploaded to the Web Server](uploading-files-cs/_static/image14.gif)](uploading-files-cs/_static/image21.png)</span></span>

<span data-ttu-id="e8f11-291">**Figura 14**: O arquivo `EvolutionValley.jpg` foi carregado para o servidor Web ([clique para exibir a imagem em tamanho normal](uploading-files-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="e8f11-291">**Figure 14**: The File `EvolutionValley.jpg` Has Been Uploaded to the Web Server ([Click to view full-size image](uploading-files-cs/_static/image22.png))</span></span>

![EvolutionValley.jpg foi salvo na pasta ~/Brochures](uploading-files-cs/_static/image15.gif)

<span data-ttu-id="e8f11-293">**Figura 15**: `EvolutionValley.jpg` Foi salvo para o `~/Brochures` pasta</span><span class="sxs-lookup"><span data-stu-id="e8f11-293">**Figure 15**: `EvolutionValley.jpg` Was Saved to the `~/Brochures` Folder</span></span>

## <a name="subtleties-with-saving-uploaded-files-to-the-file-system"></a><span data-ttu-id="e8f11-294">Sutilezas com relação a salvar arquivos carregados para o sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="e8f11-294">Subtleties with Saving Uploaded Files to the File System</span></span>

<span data-ttu-id="e8f11-295">Há várias sutilezas que devem ser abordadas ao salvar a carregar arquivos para o sistema de arquivos do web server s.</span><span class="sxs-lookup"><span data-stu-id="e8f11-295">There are several subtleties that must be addressed when saving uploading files to the web server s file system.</span></span> <span data-ttu-id="e8f11-296">Primeiro, daí o problema de segurança.</span><span class="sxs-lookup"><span data-stu-id="e8f11-296">First, there s the issue of security.</span></span> <span data-ttu-id="e8f11-297">Para salvar um arquivo no sistema de arquivos, o contexto de segurança sob a qual a página do ASP.NET está em execução deve ter permissões de gravação.</span><span class="sxs-lookup"><span data-stu-id="e8f11-297">To save a file to the file system, the security context under which the ASP.NET page is executing must have Write permissions.</span></span> <span data-ttu-id="e8f11-298">O servidor de Web de desenvolvimento do ASP.NET é executado sob o contexto da conta do usuário atual.</span><span class="sxs-lookup"><span data-stu-id="e8f11-298">The ASP.NET Development Web Server runs under the context of your current user account.</span></span> <span data-ttu-id="e8f11-299">Se você estiver usando s Microsoft Internet Information Services (IIS) como o servidor web, o contexto de segurança depende da versão do IIS e sua configuração.</span><span class="sxs-lookup"><span data-stu-id="e8f11-299">If you are using Microsoft s Internet Information Services (IIS) as the web server, the security context depends on the version of IIS and its configuration.</span></span>

<span data-ttu-id="e8f11-300">Outro desafio de salvar arquivos no sistema de arquivos gira em torno de nomear os arquivos.</span><span class="sxs-lookup"><span data-stu-id="e8f11-300">Another challenge of saving files to the file system revolves around naming the files.</span></span> <span data-ttu-id="e8f11-301">No momento, nossa página salva todos os arquivos carregados para o `~/Brochures` diretório usando o mesmo nome que o arquivo no computador cliente s.</span><span class="sxs-lookup"><span data-stu-id="e8f11-301">Currently, our page saves all of the uploaded files to the `~/Brochures` directory using the same name as the file on the client s computer.</span></span> <span data-ttu-id="e8f11-302">Se o usuário A carrega um folheto com o nome `Brochure.pdf`, o arquivo será salvo como `~/Brochure/Brochure.pdf`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-302">If User A uploads a brochure with the name `Brochure.pdf`, the file will be saved as `~/Brochure/Brochure.pdf`.</span></span> <span data-ttu-id="e8f11-303">Mas e se o usuário B em algum momento posterior carrega um arquivo de folheto diferente que tem o mesmo nome de arquivo (`Brochure.pdf`)?</span><span class="sxs-lookup"><span data-stu-id="e8f11-303">But what if sometime later User B uploads a different brochure file that happens to have the same filename (`Brochure.pdf`)?</span></span> <span data-ttu-id="e8f11-304">Com o código agora, nós temos usuário um s de arquivo será substituído com o carregamento do usuário B s.</span><span class="sxs-lookup"><span data-stu-id="e8f11-304">With the code we have now, User A s file will be overwritten with User B s upload.</span></span>

<span data-ttu-id="e8f11-305">Há várias técnicas para resolver conflitos de nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="e8f11-305">There are a number of techniques for resolving file name conflicts.</span></span> <span data-ttu-id="e8f11-306">Uma opção é proibir o carregamento de um arquivo se já existir um com o mesmo nome.</span><span class="sxs-lookup"><span data-stu-id="e8f11-306">One option is to prohibit uploading a file if there already exists one with the same name.</span></span> <span data-ttu-id="e8f11-307">Com essa abordagem, quando o usuário B tenta carregar um arquivo chamado `Brochure.pdf`, o sistema não seria salvar seu arquivo e exibirá uma mensagem informando o usuário B para renomear o arquivo e tente novamente.</span><span class="sxs-lookup"><span data-stu-id="e8f11-307">With this approach, when User B attempts to upload a file named `Brochure.pdf`, the system would not save their file and instead display a message informing User B to rename the file and try again.</span></span> <span data-ttu-id="e8f11-308">Outra abordagem é salvar o arquivo usando um nome de arquivo exclusivo, que pode ser um [identificador global exclusivo (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) ou o valor de correspondente s registros colunas de chave primária do banco de dados (supondo que o upload está associado com um linha específica no modelo de dados).</span><span class="sxs-lookup"><span data-stu-id="e8f11-308">Another approach is to save the file using a unique file name, which could be a [globally unique identifier (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) or the value from the corresponding database record s primary key column(s) (assuming that the upload is associated with a particular row in the data model).</span></span> <span data-ttu-id="e8f11-309">No próximo tutorial vamos explorar essas opções mais detalhadamente.</span><span class="sxs-lookup"><span data-stu-id="e8f11-309">In the next tutorial we'll explore these options in more detail.</span></span>

## <a name="challenges-involved-with-very-large-amounts-of-binary-data"></a><span data-ttu-id="e8f11-310">Desafios envolvidos com grandes quantidades de dados binários</span><span class="sxs-lookup"><span data-stu-id="e8f11-310">Challenges Involved with Very Large Amounts of Binary Data</span></span>

<span data-ttu-id="e8f11-311">Estes tutoriais presumem que os dados binários capturados são modestos em tamanho.</span><span class="sxs-lookup"><span data-stu-id="e8f11-311">These tutorials assume that the binary data captured is modest in size.</span></span> <span data-ttu-id="e8f11-312">Trabalhando com grandes quantidades de arquivos de dados binários que estão vários megabytes ou maior apresenta novos desafios que estão além do escopo destes tutoriais.</span><span class="sxs-lookup"><span data-stu-id="e8f11-312">Working with very large amounts of binary data files that are several megabytes or larger introduces new challenges that are beyond the scope of these tutorials.</span></span> <span data-ttu-id="e8f11-313">Por exemplo, por padrão ASP.NET rejeitará carregamentos de mais de 4 MB, embora isso possa ser configurado por meio de [ `<httpRuntime>` elemento](https://msdn.microsoft.com/library/e1f13641.aspx) em `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="e8f11-313">For example, by default ASP.NET will reject uploads of more than 4 MB, although this can be configured through the [`<httpRuntime>` element](https://msdn.microsoft.com/library/e1f13641.aspx) in `Web.config`.</span></span> <span data-ttu-id="e8f11-314">IIS impõe limitações de tamanho de upload de seu próprio arquivo, também.</span><span class="sxs-lookup"><span data-stu-id="e8f11-314">IIS imposes its own file upload size limitations, too.</span></span> <span data-ttu-id="e8f11-315">Ver [tamanho de arquivo de carregamento de IIS](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="e8f11-315">See [IIS Upload File Size](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) for more information.</span></span> <span data-ttu-id="e8f11-316">Além disso, o tempo necessário para carregar arquivos grandes pode exceder o padrão ASP.NET irá esperar para uma solicitação de 110 segundos.</span><span class="sxs-lookup"><span data-stu-id="e8f11-316">Furthermore, the time taken to upload large files might exceed the default 110 seconds ASP.NET will wait for a request.</span></span> <span data-ttu-id="e8f11-317">Também há problemas de memória e desempenho que surgem ao trabalhar com arquivos grandes.</span><span class="sxs-lookup"><span data-stu-id="e8f11-317">There are also memory and performance issues that arise when working with large files.</span></span>

<span data-ttu-id="e8f11-318">O controle FileUpload é impraticável para transferências de arquivos grandes.</span><span class="sxs-lookup"><span data-stu-id="e8f11-318">The FileUpload control is impractical for large file uploads.</span></span> <span data-ttu-id="e8f11-319">Como o conteúdo do arquivo s é enviado ao servidor, o usuário final deve aguardará pacientemente sem nenhuma confirmação que seu upload está em andamento.</span><span class="sxs-lookup"><span data-stu-id="e8f11-319">As the file s contents are being posted to the server, the end user must patiently wait without any confirmation that their upload is progressing.</span></span> <span data-ttu-id="e8f11-320">Isso não é tanto um problema ao lidar com arquivos menores que podem ser carregados em poucos segundos, mas podem ser um problema ao lidar com arquivos maiores que podem levar minutos para carregar.</span><span class="sxs-lookup"><span data-stu-id="e8f11-320">This is not so much an issue when dealing with smaller files that can be uploaded in a few seconds, but can be an issue when dealing with larger files that may take minutes to upload.</span></span> <span data-ttu-id="e8f11-321">Há uma variedade de arquivos de terceiros upload controles que são mais adequados para lidar com grandes carregamentos e muitos desses fornecedores fornecem indicadores de progresso e ActiveX carregar gerenciadores que apresentam uma experiência de usuário muito mais refinada.</span><span class="sxs-lookup"><span data-stu-id="e8f11-321">There are a variety of third-party file upload controls that are better suited for handling large uploads and many of these vendors provide progress indicators and ActiveX upload managers that present a much more polished user experience.</span></span>

<span data-ttu-id="e8f11-322">Se seu aplicativo precisa lidar com arquivos grandes, você precisará investigar os desafios com cuidado e encontrar soluções adequadas para suas necessidades específicas.</span><span class="sxs-lookup"><span data-stu-id="e8f11-322">If your application needs to handle large files, you'll need to carefully investigate the challenges and find suitable solutions for your particular needs.</span></span>

## <a name="summary"></a><span data-ttu-id="e8f11-323">Resumo</span><span class="sxs-lookup"><span data-stu-id="e8f11-323">Summary</span></span>

<span data-ttu-id="e8f11-324">Criando um aplicativo que precisa para capturar dados binários apresenta uma série de desafios.</span><span class="sxs-lookup"><span data-stu-id="e8f11-324">Building an application that needs to capture binary data introduces a number of challenges.</span></span> <span data-ttu-id="e8f11-325">Neste tutorial, exploramos os dois primeiros: decidir onde armazenar os dados binários e que permite ao usuário carregar o conteúdo binário por meio de uma página da web.</span><span class="sxs-lookup"><span data-stu-id="e8f11-325">In this tutorial we explored the first two: deciding where to store the binary data and allowing a user to upload binary content through a web page.</span></span> <span data-ttu-id="e8f11-326">Sobre os próximos três tutoriais, vamos ver como associar os dados carregados de um registro no banco de dados, bem como exibir os dados binários juntamente com seus campos de dados de texto.</span><span class="sxs-lookup"><span data-stu-id="e8f11-326">Over the next three tutorials, we'll see how to associate the uploaded data with a record in the database as well as how to display the binary data alongside its text data fields.</span></span>

<span data-ttu-id="e8f11-327">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="e8f11-327">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="e8f11-328">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="e8f11-328">Further Reading</span></span>

<span data-ttu-id="e8f11-329">Para obter mais informações sobre os tópicos abordados neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="e8f11-329">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e8f11-330">Usando tipos de dados de valor grande</span><span class="sxs-lookup"><span data-stu-id="e8f11-330">Using Large-Value Data Types</span></span>](https://msdn.microsoft.com/library/ms178158.aspx)
- [<span data-ttu-id="e8f11-331">Inícios rápidos de Controle fileUpload</span><span class="sxs-lookup"><span data-stu-id="e8f11-331">FileUpload Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/fileupload.aspx)
- [<span data-ttu-id="e8f11-332">O controle de servidor do ASP.NET 2.0 FileUpload</span><span class="sxs-lookup"><span data-stu-id="e8f11-332">The ASP.NET 2.0 FileUpload Server Control</span></span>](http://www.wrox.com/WileyCDA/Section/id-292158.html)
- [<span data-ttu-id="e8f11-333">O lado obscuro das transferências de arquivos</span><span class="sxs-lookup"><span data-stu-id="e8f11-333">The Dark Side of File Uploads</span></span>](http://www.aspnetresources.com/articles/dark_side_of_file_uploads.aspx)

## <a name="about-the-author"></a><span data-ttu-id="e8f11-334">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="e8f11-334">About the Author</span></span>

<span data-ttu-id="e8f11-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="e8f11-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e8f11-336">Scott funciona como um consultor independente, instrutor e escritor.</span><span class="sxs-lookup"><span data-stu-id="e8f11-336">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e8f11-337">Seu livro mais recente é [ *Sams Teach por conta própria ASP.NET 2.0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e8f11-337">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e8f11-338">Ele pode ser contatado pelo [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e8f11-338">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="e8f11-339">ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="e8f11-339">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="e8f11-340">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="e8f11-340">Special Thanks To</span></span>

<span data-ttu-id="e8f11-341">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="e8f11-341">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e8f11-342">Os revisores de avanço para este tutorial foram Teresa Murphy e Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="e8f11-342">Lead reviewers for this tutorial were Teresa Murphy and Bernadette Leigh.</span></span> <span data-ttu-id="e8f11-343">Você está interessado na revisão Meus próximos artigos do MSDN?</span><span class="sxs-lookup"><span data-stu-id="e8f11-343">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e8f11-344">Nesse caso, me descartar uma linha na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e8f11-344">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="e8f11-345">Avançar</span><span class="sxs-lookup"><span data-stu-id="e8f11-345">Next</span></span>](displaying-binary-data-in-the-data-web-controls-cs.md)
