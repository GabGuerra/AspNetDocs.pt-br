---
uid: web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-production
title: 'Implantação da Web do ASP.NET usando o Visual Studio: Implantação em produção | Microsoft Docs'
author: tdykstra
description: Esta série de tutoriais mostra como implantar (publicar) um ASP.NET web de aplicativo para aplicativos de Web do serviço de aplicativo do Azure ou para um provedor de hospedagem de terceiros, usin...
ms.author: riande
ms.date: 02/15/2013
ms.assetid: 416438a1-3b2f-4d27-bf53-6b76223c33bf
msc.legacyurl: /web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-production
msc.type: authoredcontent
ms.openlocfilehash: b9c4a4d035c78b4f4c53942219ccfa3048c7a82b
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65133813"
---
# <a name="aspnet-web-deployment-using-visual-studio-deploying-to-production"></a><span data-ttu-id="6b3d8-103">Implantação da Web do ASP.NET usando o Visual Studio: Implantação para produção</span><span class="sxs-lookup"><span data-stu-id="6b3d8-103">ASP.NET Web Deployment using Visual Studio: Deploying to Production</span></span>

<span data-ttu-id="6b3d8-104">por [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="6b3d8-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="6b3d8-105">Baixe o projeto inicial</span><span class="sxs-lookup"><span data-stu-id="6b3d8-105">Download Starter Project</span></span>](http://go.microsoft.com/fwlink/p/?LinkId=282627)

> <span data-ttu-id="6b3d8-106">Esta série de tutoriais mostra como implantar (publicar) um ASP.NET web application para aplicativos de Web do serviço de aplicativo do Azure ou para um provedor de hospedagem de terceiros, usando o Visual Studio 2012 ou Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-106">This tutorial series shows you how to deploy (publish) an ASP.NET web application to Azure App Service Web Apps or to a third-party hosting provider, by using Visual Studio 2012 or Visual Studio 2010.</span></span> <span data-ttu-id="6b3d8-107">Para obter informações sobre a série, consulte [o primeiro tutorial na série](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="6b3d8-107">For information about the series, see [the first tutorial in the series](introduction.md).</span></span>

## <a name="overview"></a><span data-ttu-id="6b3d8-108">Visão geral</span><span class="sxs-lookup"><span data-stu-id="6b3d8-108">Overview</span></span>

<span data-ttu-id="6b3d8-109">Neste tutorial, você configurar uma conta do Microsoft Azure, cria ambientes de preparo e produção e implanta seu aplicativo web ASP.NET de preparo e recurso de publicação de ambientes de produção usando o Visual Studio em um único clique.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-109">In this tutorial, you set up a Microsoft Azure account, create staging and production environments, and deploy your ASP.NET web application to the staging and production environments by using the Visual Studio one-click publish feature.</span></span>

<span data-ttu-id="6b3d8-110">Se você preferir, você pode implantar em um provedor de hospedagem de terceiros.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-110">If you prefer, you can deploy to a third-party hosting provider.</span></span> <span data-ttu-id="6b3d8-111">A maioria dos procedimentos descritos neste tutorial é as mesmas para um provedor de hospedagem ou do Azure, exceto que cada provedor tem sua própria interface de usuário para o gerenciamento de conta e o site da web.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-111">Most of the procedures described in this tutorial are the same for a hosting provider or for Azure, except that each provider has its own user interface for account and web site management.</span></span> <span data-ttu-id="6b3d8-112">Você pode encontrar um provedor de hospedagem na [Galeria de provedores de](https://www.microsoft.com/web/hosting) no site da web do Microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-112">You can find a hosting provider in the [gallery of providers](https://www.microsoft.com/web/hosting) on the Microsoft.com web site.</span></span>

<span data-ttu-id="6b3d8-113">Lembrete: Se você receber uma mensagem de erro ou se algo não funciona ao percorrer o tutorial, certifique-se de verificar a página de solução de problemas nessa série de tutoriais.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-113">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the Troubleshooting page in this tutorial series.</span></span>

## <a name="get-a-microsoft-azure-account"></a><span data-ttu-id="6b3d8-114">Obtenha uma conta do Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="6b3d8-114">Get a Microsoft Azure account</span></span>

<span data-ttu-id="6b3d8-115">Se você ainda não tiver uma conta do Azure, você pode criar uma conta de avaliação gratuita em apenas alguns minutos.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-115">If you don't already have an Azure account, you can create a free trial account in just a couple of minutes.</span></span> <span data-ttu-id="6b3d8-116">Para obter detalhes, consulte [avaliação gratuita do Azure](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span><span class="sxs-lookup"><span data-stu-id="6b3d8-116">For details, see [Azure Free Trial](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span></span>

## <a name="create-a-staging-environment"></a><span data-ttu-id="6b3d8-117">Criar um ambiente de preparo</span><span class="sxs-lookup"><span data-stu-id="6b3d8-117">Create a staging environment</span></span>

> [!NOTE]
> <span data-ttu-id="6b3d8-118">Uma vez que este tutorial foi escrito, o serviço de aplicativo do Azure adicionou um novo recurso para automatizar vários processos para a criação de ambientes de preparo e produção.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-118">Since this tutorial was written, Azure App Service added a new feature to automate many of the processes for creating staging and production environments.</span></span> <span data-ttu-id="6b3d8-119">Ver [configurar ambientes de preparo para aplicativos web no serviço de aplicativo do Azure](https://azure.microsoft.com/documentation/articles/web-sites-staged-publishing/).</span><span class="sxs-lookup"><span data-stu-id="6b3d8-119">See [Set up staging environments for web apps in Azure App Service](https://azure.microsoft.com/documentation/articles/web-sites-staged-publishing/).</span></span>

<span data-ttu-id="6b3d8-120">Conforme explicado a [implantar para o tutorial do ambiente de teste](deploying-to-iis.md), a maioria dos ambiente de teste confiáveis é um site da web no provedor de hospedagem que é exatamente como o site da web de produção.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-120">As explained in the [Deploy to the Test Environment tutorial](deploying-to-iis.md), the most reliable test environment is a web site at the hosting provider that's just like the production web site.</span></span> <span data-ttu-id="6b3d8-121">Muitos provedores de hospedagem, seria necessário ponderar os benefícios deste significativo custo adicional, mas no Azure, você pode criar um aplicativo web gratuito adicionais como seu aplicativo de preparo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-121">At many hosting providers you would have to weigh the benefits of this against significant additional cost, but in Azure you can create an additional free web app as your staging app.</span></span> <span data-ttu-id="6b3d8-122">Você também precisa de um banco de dados, e a despesa adicional para fazer isso pela despesa de seu banco de dados de produção será nenhum ou mínimo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-122">You also need a database, and the additional expense for that over the expense of your production database will be either none or minimal.</span></span> <span data-ttu-id="6b3d8-123">No Azure você paga pela quantidade de armazenamento de banco de dados usado em vez de para cada banco de dados e a quantidade de armazenamento adicional, que você usará no ambiente de preparo será mínima.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-123">In Azure you pay for the amount of database storage you use rather than for each database, and the amount of additional storage you'll use in staging will be minimal.</span></span>

<span data-ttu-id="6b3d8-124">Conforme explicado a [implantar para o tutorial do ambiente de teste](deploying-to-iis.md), em preparação e produção que você pretende implantar dois bancos de dados em um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-124">As explained in the [Deploy to the Test Environment tutorial](deploying-to-iis.md), in staging and production you're going to deploy your two databases into one database.</span></span> <span data-ttu-id="6b3d8-125">Se você quiser mantê-los separados, o processo seria o mesmo, exceto que você deve criar um banco de dados adicional para cada ambiente e selecione a cadeia de caracteres de destino correto para cada banco de dados quando você cria o perfil de publicação.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-125">If you wanted to keep them separate, the process would be the same except that you'd create an additional database for each environment and you would select the correct destination string for each database when you create the publish profile.</span></span>

<span data-ttu-id="6b3d8-126">Nesta seção do tutorial, você vai criar um aplicativo web e o banco de dados a ser usado para o ambiente de preparo, e você vai implantar no preparo e teste existe antes de criar e implantar o ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-126">In this section of the tutorial you'll create a web app and database to use for the staging environment, and you'll deploy to staging and test there before creating and deploying to the production environment.</span></span>

> [!NOTE]
> <span data-ttu-id="6b3d8-127">As etapas a seguir mostram como criar um aplicativo web no serviço de aplicativo do Azure usando o portal de gerenciamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-127">The following steps show how to create a web app in Azure App Service by using the Azure management portal.</span></span> <span data-ttu-id="6b3d8-128">Na versão mais recente do SDK do Azure, você também pode fazer isso sem sair do Visual Studio, usando o Gerenciador de servidores.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-128">In the latest version of the Azure SDK, you can also do this without leaving Visual Studio, by using Server Explorer.</span></span> <span data-ttu-id="6b3d8-129">No Visual Studio 2013, você também pode criar um aplicativo web diretamente na caixa de diálogo Publicar.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-129">In Visual Studio 2013, you can also create a web app directly from the Publish dialog.</span></span> <span data-ttu-id="6b3d8-130">Para obter mais informações, consulte [criar um aplicativo web ASP.NET no serviço de aplicativo do Azure.](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet)</span><span class="sxs-lookup"><span data-stu-id="6b3d8-130">For more information, see [Create an ASP.NET web app in Azure App Service.](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet)</span></span>

1. <span data-ttu-id="6b3d8-131">No [Portal de gerenciamento](https://manage.windowsazure.com/), clique em **sites**e, em seguida, clique em **New**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-131">In the [Azure Management Portal](https://manage.windowsazure.com/), click **Websites**, and then click **New**.</span></span>
2. <span data-ttu-id="6b3d8-132">Clique em **site**e, em seguida, clique em **criação personalizada**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-132">Click **Website**, and then click **Custom Create**.</span></span>

    <span data-ttu-id="6b3d8-133">O **novo site – criação personalizada** assistente é aberto.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-133">The **New Website - Custom Create** wizard opens.</span></span> <span data-ttu-id="6b3d8-134">O **criação personalizada** assistente permite que você crie um site da web e um banco de dados ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-134">The **Custom Create** wizard enables you to create a web site and a database at the same time.</span></span>
3. <span data-ttu-id="6b3d8-135">No **criar site** etapa do assistente, insira uma cadeia de caracteres de **URL** caixa para usar como a URL exclusiva para seu aplicativo do ambiente de preparo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-135">In the **Create Website** step of the wizard, enter a string in the **URL** box to use as the unique URL for your application's staging environment.</span></span> <span data-ttu-id="6b3d8-136">Por exemplo, digite ContosoUniversity-staging123 (incluindo números aleatórios no final para torná-la exclusiva, no caso de preparo ContosoUniversity é obtido).</span><span class="sxs-lookup"><span data-stu-id="6b3d8-136">For example, enter ContosoUniversity-staging123 (including random numbers at the end to make it unique in case ContosoUniversity-staging is taken).</span></span>

    <span data-ttu-id="6b3d8-137">A URL completa consistirá em que você inserir aqui mais o sufixo que você vê ao lado da caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-137">The complete URL will consist of what you enter here plus the suffix that you see next to the text box.</span></span>
4. <span data-ttu-id="6b3d8-138">No **região** lista suspensa, escolha a região mais próxima a você.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-138">In the **Region** drop-down list, choose the region that is closest to you.</span></span>

    <span data-ttu-id="6b3d8-139">Essa configuração especifica qual data center que seu aplicativo web será executado em.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-139">This setting specifies which data center your web app will run in.</span></span>
5. <span data-ttu-id="6b3d8-140">No **banco de dados** lista suspensa, escolha **criar um novo banco de dados do SQL**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-140">In the **Database** drop-down list, choose **Create a new SQL database**.</span></span>
6. <span data-ttu-id="6b3d8-141">No **nome de cadeia de caracteres de Conexão do BD** caixa, deixe o valor padrão, *DefaultConnection*.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-141">In the **DB Connection String Name** box, leave the default value, *DefaultConnection*.</span></span>
7. <span data-ttu-id="6b3d8-142">Clique na seta que aponta para a direita na parte inferior da caixa.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-142">Click the arrow that points to the right at the bottom of the box.</span></span>

    <span data-ttu-id="6b3d8-143">A ilustração a seguir mostra a **criar site** caixa de diálogo com os valores de exemplo nele.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-143">The following illustration shows the **Create Website** dialog with sample values in it.</span></span> <span data-ttu-id="6b3d8-144">A URL e a região que você inseriu será diferente.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-144">The URL and Region that you have entered will be different.</span></span>

    ![Criar site etapa](deploying-to-production/_static/image1.png)

    <span data-ttu-id="6b3d8-146">O assistente avança para o **especificar configurações de banco de dados** etapa.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-146">The wizard advances to the **Specify database settings** step.</span></span>
8. <span data-ttu-id="6b3d8-147">No **nome** , digite *ContosoUniversity* além de um número aleatório para torná-la exclusiva, por exemplo *ContosoUniversity123*.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-147">In the **Name** box, enter *ContosoUniversity* plus a random number to make it unique, for example *ContosoUniversity123*.</span></span>
9. <span data-ttu-id="6b3d8-148">No **Server** caixa, selecione **novo servidor de banco de dados SQL**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-148">In the **Server** box, select **New SQL Database Server**.</span></span>
10. <span data-ttu-id="6b3d8-149">Insira um nome de administrador e senha.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-149">Enter an administrator name and password.</span></span>

    <span data-ttu-id="6b3d8-150">Você não inserir um nome e senha existentes aqui.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-150">You aren't entering an existing name and password here.</span></span> <span data-ttu-id="6b3d8-151">Você está inserindo um novo nome e senha que você está definindo agora para usar mais tarde ao acessar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-151">You're entering a new name and password that you're defining now to use later when you access the database.</span></span>
11. <span data-ttu-id="6b3d8-152">No **região** , escolha a mesma região que você escolheu para o aplicativo web.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-152">In the **Region** box, choose the same region that you chose for the web app.</span></span>

    <span data-ttu-id="6b3d8-153">Manter o servidor web e o servidor de banco de dados na mesma região lhe dá o melhor desempenho e minimiza as despesas.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-153">Keeping the web server and the database server in the same region gives you the best performance and minimizes expenses.</span></span>
12. <span data-ttu-id="6b3d8-154">Clique na marca de seleção na parte inferior da caixa para indicar que é concluído.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-154">Click the check mark at the bottom of the box to indicate that you're finished.</span></span>

    <span data-ttu-id="6b3d8-155">A ilustração a seguir mostra a **especificar configurações de banco de dados** caixa de diálogo com os valores de exemplo nele.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-155">The following illustration shows the **Specify database settings** dialog with sample values in it.</span></span> <span data-ttu-id="6b3d8-156">Os valores inseridos por você podem ser diferentes.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-156">The values you have entered may be different.</span></span>

    ![Etapa de configurações de banco de dados do site de New - criar com o Assistente de banco de dados](deploying-to-production/_static/image2.png)

    <span data-ttu-id="6b3d8-158">O Portal de gerenciamento retorna para a página de sites e o **Status** coluna mostra que o aplicativo web está sendo criado.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-158">The Management Portal returns to the Websites page, and the **Status** column shows that the web app is being created.</span></span> <span data-ttu-id="6b3d8-159">Depois de algum tempo (normalmente menos de um minuto), o **Status** coluna mostra o aplicativo web foi criado com êxito.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-159">After a while (typically less than a minute), the **Status** column shows that the web app was successfully created.</span></span> <span data-ttu-id="6b3d8-160">Na barra de navegação à esquerda, o número de aplicativos web que você tem em sua conta é exibido ao lado de **sites** ícone e o número de bancos de dados é exibido ao lado de **bancos de dados SQL** ícone.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-160">In the navigation bar at the left, the number of web apps you have in your account appears next to the **Websites** icon, and the number of databases appears next to the **SQL Databases** icon.</span></span>

    ![Página de Sites da Web do Portal de gerenciamento do site criado](deploying-to-production/_static/image3.png)

    <span data-ttu-id="6b3d8-162">Nome do aplicativo web será diferente do aplicativo de exemplo na ilustração.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-162">Your web app name will be different from the example app in the illustration.</span></span>

## <a name="deploy-the-application-to-staging"></a><span data-ttu-id="6b3d8-163">Implantar o aplicativo para o preparo</span><span class="sxs-lookup"><span data-stu-id="6b3d8-163">Deploy the application to staging</span></span>

<span data-ttu-id="6b3d8-164">Agora que você criou um aplicativo web e o banco de dados para o ambiente de preparo, você pode implantar o projeto.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-164">Now that you have created a web app and database for the staging environment, you can deploy the project to it.</span></span>

> [!NOTE]
> <span data-ttu-id="6b3d8-165">Estas instruções mostram como criar um perfil de publicação, baixando uma *. publishsettings* arquivo, que funciona não só para o Azure, mas também para provedores de hospedagem de terceiros.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-165">These instructions show how to create a publish profile by downloading a *.publishsettings* file, which works not only for Azure but also for third-party hosting providers.</span></span> <span data-ttu-id="6b3d8-166">A versão mais recente do SDK do Azure também permite que você se conectar diretamente no Azure do Visual Studio e escolha em uma lista de aplicativos web que você tem em sua conta do Azure.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-166">The latest Azure SDK also enables you to connect directly to Azure from Visual Studio, and choose from a list of web apps that you have in your Azure account.</span></span> <span data-ttu-id="6b3d8-167">No Visual Studio 2013, você pode entrar no Azure a partir de **Web Publish** caixa de diálogo ou do **Gerenciador de servidores** janela.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-167">In Visual Studio 2013, you can sign in to Azure from the **Web Publish** dialog or from the **Server Explorer** window.</span></span> <span data-ttu-id="6b3d8-168">Para obter mais informações, consulte [criar um aplicativo web ASP.NET no serviço de aplicativo do Azure](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span><span class="sxs-lookup"><span data-stu-id="6b3d8-168">For more information, see [Create an ASP.NET web app in Azure App Service](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span></span>

### <a name="download-the-publishsettings-file"></a><span data-ttu-id="6b3d8-169">Baixe o arquivo. publishsettings</span><span class="sxs-lookup"><span data-stu-id="6b3d8-169">Download the .publishsettings file</span></span>

1. <span data-ttu-id="6b3d8-170">Clique no nome do aplicativo web que você acabou de criar.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-170">Click the name of the web app that you just created.</span></span>

    ![Clique no site para ir para o painel](deploying-to-production/_static/image4.png)
2. <span data-ttu-id="6b3d8-172">Sob **visão geral rápida** na **Dashboard** , clique em **baixar perfil de publicação**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-172">Under **Quick glance** in the **Dashboard** tab, click **Download publish profile**.</span></span>

    ![Baixar o link do perfil de publicação](deploying-to-production/_static/image5.png)

    <span data-ttu-id="6b3d8-174">Esta etapa baixa um arquivo que contém todas as configurações que você precisa para implantar um aplicativo em seu aplicativo web.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-174">This step downloads a file that contains all of the settings that you need in order to deploy an application to your web app.</span></span> <span data-ttu-id="6b3d8-175">Você importará esse arquivo para o Visual Studio para que você não precise inserir essas informações manualmente.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-175">You'll import this file into Visual Studio so you don't have to enter this information manually.</span></span>
3. <span data-ttu-id="6b3d8-176">Salvar a *. publishsettings* arquivo em uma pasta que você pode acessar a partir do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-176">Save the *.publishsettings* file in a folder that you can access from Visual Studio.</span></span>

    ![salvando o arquivo. publishsettings](deploying-to-production/_static/image6.png)

    > [!WARNING]
    > <span data-ttu-id="6b3d8-178">Security - a *. publishsettings* arquivo contém suas credenciais (sem codificação) que são usados para administrar suas assinaturas do Azure e serviços.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-178">Security - The *.publishsettings* file contains your credentials (unencoded) that are used to administer your Azure subscriptions and services.</span></span> <span data-ttu-id="6b3d8-179">A prática recomendada de segurança para esse arquivo é armazená-lo temporariamente fora dos diretórios de origem (por exemplo, na pasta Libraries\Documents) e, em seguida, exclua-o após a importação for concluída.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-179">The security best practice for this file is to store it temporarily outside your source directories (for example in the Libraries\Documents folder), and then delete it once the import has completed.</span></span> <span data-ttu-id="6b3d8-180">Um usuário mal-intencionado que consiga acessar o *. publishsettings* arquivo pode editar, criar e excluir seus serviços do Azure.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-180">A malicious user who gains access to the *.publishsettings* file can edit, create, and delete your Azure services.</span></span>

### <a name="create-a-publish-profile"></a><span data-ttu-id="6b3d8-181">Criar um perfil de publicação</span><span class="sxs-lookup"><span data-stu-id="6b3d8-181">Create a publish profile</span></span>

1. <span data-ttu-id="6b3d8-182">No Visual Studio, clique com botão direito no projeto ContosoUniversity no **Gerenciador de soluções** e selecione **publicar** no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-182">In Visual Studio, right-click the ContosoUniversity project in **Solution Explorer** and select **Publish** from the context menu.</span></span>

    <span data-ttu-id="6b3d8-183">O **publicar na Web** assistente é aberto.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-183">The **Publish Web** wizard opens.</span></span>
2. <span data-ttu-id="6b3d8-184">Clique o **perfil** guia.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-184">Click the **Profile** tab.</span></span>
3. <span data-ttu-id="6b3d8-185">Clique em **Importar**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-185">Click **Import**.</span></span>
4. <span data-ttu-id="6b3d8-186">Navegue até a *. publishsettings* arquivo que você baixou anteriormente e, em seguida, clique em **abrir**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-186">Navigate to the *.publishsettings* file you downloaded earlier, and then click **Open**.</span></span>

    ![Caixa de diálogo Importar configurações de publicação](deploying-to-production/_static/image7.png)
5. <span data-ttu-id="6b3d8-188">No **Conexão** , clique em **validar Conexão** para certificar-se de que as configurações estão corretas.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-188">In the **Connection** tab, click **Validate Connection** to make sure that the settings are correct.</span></span>

    <span data-ttu-id="6b3d8-189">Quando a conexão tiver sido validado, uma marca de seleção verde é mostrada ao lado de **validar Conexão** botão.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-189">When the connection has been validated, a green check mark is shown next to the **Validate Connection** button.</span></span>

    <span data-ttu-id="6b3d8-190">Para alguns provedores de hospedagem, quando você clica **validar Conexão**, você poderá ver uma **erro de certificado** caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-190">For some hosting providers, when you click **Validate Connection**, you might see a **Certificate Error** dialog box.</span></span> <span data-ttu-id="6b3d8-191">Se você fizer isso, verifique se que o nome do servidor é o esperado.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-191">If you do, verify that the server name is what you expect.</span></span> <span data-ttu-id="6b3d8-192">Se o nome do servidor está correto, selecione **salvar este certificado para sessões futuras do Visual Studio** e clique em **Accept**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-192">If the server name is correct, select **Save this certificate for future sessions of Visual Studio** and click **Accept**.</span></span> <span data-ttu-id="6b3d8-193">(Esse erro significa que o provedor de hospedagem tem escolhidos para evitar a despesa de comprar um certificado SSL para a URL que você está implantando.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-193">(This error means that the hosting provider has chosen to avoid the expense of purchasing an SSL certificate for the URL that you are deploying to.</span></span> <span data-ttu-id="6b3d8-194">Se você preferir estabelecer uma conexão segura usando um certificado válido, entre em contato com seu provedor de hospedagem.)</span><span class="sxs-lookup"><span data-stu-id="6b3d8-194">If you prefer to establish a secure connection by using a valid certificate, contact your hosting provider.)</span></span>
6. <span data-ttu-id="6b3d8-195">Clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-195">Click **Next**.</span></span>

    ![ícone de conexão bem-sucedida e o botão Avançar na guia Conexão](deploying-to-production/_static/image8.png)
7. <span data-ttu-id="6b3d8-197">No **as configurações** guia, expanda **opções de publicação do arquivo**e, em seguida, selecione **excluir arquivos do aplicativo\_pasta dados**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-197">In the **Settings** tab, expand **File Publish Options**, and then select **Exclude files from the App\_Data folder**.</span></span>

    <span data-ttu-id="6b3d8-198">Para obter informações sobre as outras opções sob **opções de publicação do arquivo**, consulte o [implantando no IIS](deploying-to-iis.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-198">For information about the other options under **File Publish Options**, see the [deploying to IIS](deploying-to-iis.md) tutorial.</span></span> <span data-ttu-id="6b3d8-199">A captura de tela que mostra o resultado desta etapa e as seguintes etapas de configuração do banco de dados está no final das etapas de configuração de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-199">The screen shot that shows the result of this step and the following database configuration steps is at the end of the database configuration steps.</span></span>
8. <span data-ttu-id="6b3d8-200">Sob **DefaultConnection** na **bancos de dados** seção, configura a implantação de banco de dados para o banco de dados de associação.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-200">Under **DefaultConnection** in the **Databases** section, configure database deployment for the membership database.</span></span>
9. 1. <span data-ttu-id="6b3d8-201">Selecione **Atualizar banco de dados**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-201">Select **Update database**.</span></span>

        <span data-ttu-id="6b3d8-202">O **cadeia de caracteres de conexão remota** caixa diretamente abaixo **DefaultConnection** será preenchido com a cadeia de caracteres de conexão do arquivo. publishsettings. A cadeia de caracteres de conexão inclui as credenciais do SQL Server, que são armazenadas em texto sem formatação na *. pubxml* arquivo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-202">The **Remote connection string** box directly below **DefaultConnection** is filled in with the connection string from the .publishsettings file.The connection string includes SQL Server credentials, which are stored in plain text in the *.pubxml* file.</span></span> <span data-ttu-id="6b3d8-203">Se você preferir não armazená-las permanentemente lá, você pode removê-los do perfil de publicação depois que o banco de dados é implantado e armazená-las no Azure.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-203">If you prefer not to store them permanently there, you can remove them from the publish profile after the database is deployed and store them in Azure instead.</span></span> <span data-ttu-id="6b3d8-204">Para obter mais informações, consulte [como manter seu banco de dados do ASP.NET cadeias de caracteres de conexão segura ao implantar no Azure de origem](http://www.hanselman.com/blog/HowToKeepYourASPNETDatabaseConnectionStringsSecureWhenDeployingToAzureFromSource.aspx) no blog de hanselman.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-204">For more information, see [How to keep your ASP.NET database connection strings secure when deploying to Azure from Source](http://www.hanselman.com/blog/HowToKeepYourASPNETDatabaseConnectionStringsSecureWhenDeployingToAzureFromSource.aspx) on Scott Hanselman's blog.</span></span>
      2. <span data-ttu-id="6b3d8-205">Clique em **configurar atualizações de banco de dados**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-205">Click **Configure database updates**.</span></span>
      3. <span data-ttu-id="6b3d8-206">No **configurar atualizações de banco de dados** caixa de diálogo, clique em **Adicionar Script do SQL**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-206">In the **Configure Database Updates** dialog box, click **Add SQL Script**.</span></span>
      4. <span data-ttu-id="6b3d8-207">No **Adicionar Script do SQL** , navegue até a *aspnet-data-prod.sql* script que você salvou anteriormente na pasta da solução e, em seguida, clique em **abrir**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-207">In the **Add SQL Script** box, navigate to the *aspnet-data-prod.sql* script that you saved earlier in the solution folder, and then click **Open**.</span></span>
      5. <span data-ttu-id="6b3d8-208">Fechar o **configurar atualizações de banco de dados** caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-208">Close the **Configure Database Updates** dialog box.</span></span>
10. <span data-ttu-id="6b3d8-209">Sob **SchoolContext** na **bancos de dados** seção, selecione **executar migrações do Code First (executado na inicialização do aplicativo)**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-209">Under **SchoolContext** in the **Databases** section, select **Execute Code First Migrations (runs on application start)**.</span></span>

    <span data-ttu-id="6b3d8-210">O Visual Studio exibe **executar migrações do Code First** em vez de **Atualizar banco de dados** para `DbContext` classes.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-210">Visual Studio displays **Execute Code First Migrations** instead of **Update Database** for `DbContext` classes.</span></span> <span data-ttu-id="6b3d8-211">Se você deseja usar o provedor dbDacFx em vez de migrações para implantar um banco de dados que você acessa usando um `DbContext` classe, consulte [como implantar um banco de dados Code First sem migrações?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) nas perguntas Frequentes de implantação da Web para o Visual Studio e o ASP.NET no MSDN.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-211">If you want to use the dbDacFx provider instead of Migrations to deploy a database that you access by using a `DbContext` class, see [How do I deploy a Code First database without Migrations?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) in the Web Deployment FAQ for Visual Studio and ASP.NET on MSDN.</span></span>

    <span data-ttu-id="6b3d8-212">O **configurações** guia agora se parece com o exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="6b3d8-212">The **Settings** tab now looks like the following example:</span></span>

    ![Guia de configurações para o preparo](deploying-to-production/_static/image9.png)
11. <span data-ttu-id="6b3d8-214">Execute as seguintes etapas para salvar o perfil e renomeie-o para *preparo*:</span><span class="sxs-lookup"><span data-stu-id="6b3d8-214">Perform the following steps to save the profile and rename it to *Staging*:</span></span>

    1. <span data-ttu-id="6b3d8-215">Clique o **perfil** guia e, em seguida, clique em **gerenciar perfis**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-215">Click the **Profile** tab, and then click **Manage Profiles**.</span></span>
    2. <span data-ttu-id="6b3d8-216">A importação criados dois novos perfis, um para FTP e outro para a implantação da Web.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-216">The import created two new profiles, one for FTP and one for Web Deploy.</span></span> <span data-ttu-id="6b3d8-217">Você configurou o perfil de implantação da Web: renomear esse perfil seja *preparo*.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-217">You configured the Web Deploy profile: rename this profile to *Staging*.</span></span>

        ![Renomear perfil para o preparo](deploying-to-production/_static/image10.png)
    3. <span data-ttu-id="6b3d8-219">Fechar o **editar perfis de publicação de Web** caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-219">Close the **Edit Web Publish Profiles** dialog box.</span></span>
    4. <span data-ttu-id="6b3d8-220">Fechar o **publicar na Web** assistente.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-220">Close the **Publish Web** wizard.</span></span>

### <a name="configure-a-publish-profile-transform-for-the-environment-indicator"></a><span data-ttu-id="6b3d8-221">Configurar uma transformação de perfil de publicação para o indicador de ambiente</span><span class="sxs-lookup"><span data-stu-id="6b3d8-221">Configure a publish profile transform for the environment indicator</span></span>

> [!NOTE]
> <span data-ttu-id="6b3d8-222">Esta seção mostra como configurar uma transformação de Web. config para o indicador de ambiente.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-222">This section shows how to set up a Web.config transform for the environment indicator.</span></span> <span data-ttu-id="6b3d8-223">Como o indicador é no `<appSettings>` elemento, você tem outra alternativa para especificar a transformação quando você estiver implantando no serviço de aplicativo do Azure.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-223">Because the indicator is in the `<appSettings>` element, you have another alternative for specifying the transformation when you're deploying to Azure App Service.</span></span> <span data-ttu-id="6b3d8-224">Para obter mais informações, consulte [Web. config especificando configurações no Azure](web-config-transformations.md#watransforms).</span><span class="sxs-lookup"><span data-stu-id="6b3d8-224">For more information, see [Specifying Web.config settings in Azure](web-config-transformations.md#watransforms).</span></span>

1. <span data-ttu-id="6b3d8-225">Na **Gerenciador de soluções**, expanda **Properties**e, em seguida, expanda **PublishProfiles**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-225">In **Solution Explorer**, expand **Properties**, and then expand **PublishProfiles**.</span></span>
2. <span data-ttu-id="6b3d8-226">Clique com botão direito *Staging.pubxml*e, em seguida, clique em **adicionar Config transformar**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-226">Right-click *Staging.pubxml*, and then click **Add Config Transform**.</span></span>

    ![Adicionar transformação de Config para o preparo](deploying-to-production/_static/image11.png)

    <span data-ttu-id="6b3d8-228">O Visual Studio cria o *staging* arquivo de transformação e o abre.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-228">Visual Studio creates the *Web.Staging.config* transform file and opens it.</span></span>
3. <span data-ttu-id="6b3d8-229">No *staging* transformar o arquivo, insira o seguinte código imediatamente após a abertura `configuration` marca.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-229">In the *Web.Staging.config* transform file, insert the following code immediately after the opening `configuration` tag.</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample1.xml)]

    <span data-ttu-id="6b3d8-230">Quando você usa o perfil de publicação de preparo, essa transformação define o indicador de ambiente para "Prod".</span><span class="sxs-lookup"><span data-stu-id="6b3d8-230">When you use the Staging publish profile, this transform sets the environment indicator to "Prod".</span></span> <span data-ttu-id="6b3d8-231">No aplicativo web implantado, você não verá nenhum sufixo, como "(desenvolvimento)" ou "(teste)" após o cabeçalho H1 de "Contoso University".</span><span class="sxs-lookup"><span data-stu-id="6b3d8-231">In the deployed web app, you won't see any suffix such as "(Dev)" or "(Test)" after the "Contoso University" H1 heading.</span></span>
4. <span data-ttu-id="6b3d8-232">Clique com botão direito do *staging* de arquivo e clique em **visualização transformar** para certificar-se de que a transformação que você codificou produz as alterações esperadas.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-232">Right-click the *Web.Staging.config* file and click **Preview Transform** to make sure that the transform you coded produces the expected changes.</span></span>

    <span data-ttu-id="6b3d8-233">O **visualização da Web. config** janela mostra o resultado da aplicação de ambos os *Release* transforma e o *staging* transforma.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-233">The **Web.config Preview** window shows the result of applying both the *Web.Release.config* transforms and the *Web.Staging.config* transforms.</span></span>

### <a name="prevent-public-use-of-the-test-app"></a><span data-ttu-id="6b3d8-234">Impedir o uso público do aplicativo de teste</span><span class="sxs-lookup"><span data-stu-id="6b3d8-234">Prevent public use of the test app</span></span>

<span data-ttu-id="6b3d8-235">Uma consideração importante para o aplicativo de preparo é que ele estará em tempo real na Internet, mas você não deseja usá-lo público.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-235">An important consideration for the staging app is that it will be live on the Internet, but you don't want the public to use it.</span></span> <span data-ttu-id="6b3d8-236">Para minimizar a probabilidade de que as pessoas encontrará e usá-lo, você pode usar um ou mais dos seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="6b3d8-236">To minimize the likelihood that people will find and use it, you can use one or more of the following methods:</span></span>

- <span data-ttu-id="6b3d8-237">Definir regras de firewall que permitem o acesso apenas de endereços IP que você pode usar para testar a preparação para o aplicativo de preparo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-237">Set firewall rules that allow access to the staging app only from IP addresses that you use to test staging.</span></span>
- <span data-ttu-id="6b3d8-238">Use uma URL ofuscada que seria impossível de adivinhar.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-238">Use an obfuscated URL that would be impossible to guess.</span></span>
- <span data-ttu-id="6b3d8-239">Criar uma *robots* arquivo para garantir que os mecanismos de pesquisa serão não rastrear os links de relatório e o aplicativo de teste a ele nos resultados da pesquisa.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-239">Create a *robots.txt* file to ensure that search engines will not crawl the test app and report links to it in search results.</span></span>

<span data-ttu-id="6b3d8-240">O primeiro desses métodos é mais eficiente, mas não é abordado neste tutorial, porque ela requer que você implanta um serviço de nuvem do Azure em vez do serviço de aplicativo do Azure.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-240">The first of these methods is the most effective but is not covered in this tutorial because it would require that you deploy to an Azure Cloud Service instead of Azure App Service.</span></span> <span data-ttu-id="6b3d8-241">Para obter mais informações sobre serviços de nuvem e as restrições de IP no Azure, consulte [computação hospedando opções fornecidas pelo Azure](https://docs.microsoft.com/azure/cloud-services/cloud-services-choose-me) e [bloco de endereços IP específicos de acessar uma função Web](https://msdn.microsoft.com/library/windowsazure/jj154098.aspx).</span><span class="sxs-lookup"><span data-stu-id="6b3d8-241">For more information about Cloud Services and IP restrictions in Azure, see [Compute Hosting Options Provided by Azure](https://docs.microsoft.com/azure/cloud-services/cloud-services-choose-me) and [Block Specific IP Addresses from Accessing a Web Role](https://msdn.microsoft.com/library/windowsazure/jj154098.aspx).</span></span> <span data-ttu-id="6b3d8-242">Se você estiver implantando em um provedor de hospedagem de terceiros, contate o provedor para descobrir como implementar restrições de IP.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-242">If you are deploying to a third-party hosting provider, contact the provider to find out how to implement IP restrictions.</span></span>

<span data-ttu-id="6b3d8-243">Para este tutorial, você criará um *robots* arquivo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-243">For this tutorial, you'll create a *robots.txt* file.</span></span>

1. <span data-ttu-id="6b3d8-244">Na **Gerenciador de soluções**, clique com botão direito no projeto ContosoUniversity e clique em **Adicionar Novo Item**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-244">In **Solution Explorer**, right-click the ContosoUniversity project and click **Add New Item**.</span></span>
2. <span data-ttu-id="6b3d8-245">Criar um novo **arquivo de texto** denominado *robots*e colocar o seguinte texto nele:</span><span class="sxs-lookup"><span data-stu-id="6b3d8-245">Create a new **Text File** named *robots.txt*, and put the following text in it:</span></span>

    [!code-console[Main](deploying-to-production/samples/sample2.cmd)]

    <span data-ttu-id="6b3d8-246">O `User-agent` linha informa os mecanismos de pesquisa que se aplicam as regras no arquivo para rastreadores de web de mecanismo de pesquisa todos os (robôs), e o `Disallow` linha especifica que nenhuma página no site deve ser rastreada.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-246">The `User-agent` line tells search engines that the rules in the file apply to all search engine web crawlers (robots), and the `Disallow` line specifies that no pages on the site should be crawled.</span></span>

    <span data-ttu-id="6b3d8-247">Você deseja que os mecanismos de pesquisa do catálogo seu aplicativo de produção, portanto, você precisará excluir este arquivo de implantação de produção.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-247">You do want search engines to catalog your production app, so you need to exclude this file from production deployment.</span></span> <span data-ttu-id="6b3d8-248">Para fazer o que, você configurará uma configuração na produção perfil de publicação ao criá-lo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-248">To do that, you'll configure a setting in the Production publish profile when you create it.</span></span>

### <a name="deploy-to-staging"></a><span data-ttu-id="6b3d8-249">Implantar no preparo</span><span class="sxs-lookup"><span data-stu-id="6b3d8-249">Deploy to staging</span></span>

1. <span data-ttu-id="6b3d8-250">Abra o **Publicar Web** assistente clicando com botão direito no projeto do Contoso University e clicando em **publicar**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-250">Open the **Publish Web** wizard by right-clicking the Contoso University project and clicking **Publish**.</span></span>
2. <span data-ttu-id="6b3d8-251">Certifique-se de que o **preparo** perfil for selecionado.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-251">Make sure that the **Staging** profile is selected.</span></span>
3. <span data-ttu-id="6b3d8-252">Clique em **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-252">Click **Publish**.</span></span>

    <span data-ttu-id="6b3d8-253">O **saída** janela mostra quais ações de implantação foram executadas e relata a conclusão bem-sucedida da implantação.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-253">The **Output** window shows what deployment actions were taken and reports successful completion of the deployment.</span></span> <span data-ttu-id="6b3d8-254">O navegador padrão abre automaticamente a URL do aplicativo web implantado.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-254">The default browser automatically opens to the URL of the deployed web app.</span></span>

## <a name="test-in-the-staging-environment"></a><span data-ttu-id="6b3d8-255">Teste no ambiente de preparo</span><span class="sxs-lookup"><span data-stu-id="6b3d8-255">Test in the staging environment</span></span>

<span data-ttu-id="6b3d8-256">Observe que o indicador de ambiente esteja ausente (não há nenhum "(teste)" ou "(desenvolvimento)" após o título H1, que mostra que o *Web. config* transformação para o indicador de ambiente foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-256">Notice that the environment indicator is absent (there is no "(Test)" or "(Dev)" after the H1 heading, which shows that the *Web.config* transformation for the environment indicator was successful.</span></span>

![Home page preparo](deploying-to-production/_static/image12.png)

<span data-ttu-id="6b3d8-258">Execute o **alunos** página para verificar se o banco de dados implantado não tem nenhum aluno.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-258">Run the **Students** page to verify that the deployed database has no students.</span></span>

<span data-ttu-id="6b3d8-259">Execute o **instrutores** página para verificar se que o Code First propagado o banco de dados do instrutor:</span><span class="sxs-lookup"><span data-stu-id="6b3d8-259">Run the **Instructors** page to verify that Code First seeded the database with instructor data:</span></span>

<span data-ttu-id="6b3d8-260">Selecione **adicionar alunos** da **alunos** menu, adicionar um aluno e, em seguida, exibir o novo aluno no **alunos** página para verificar se que você pode escrever com êxito no banco de dados .</span><span class="sxs-lookup"><span data-stu-id="6b3d8-260">Select **Add Students** from the **Students** menu, add a student, and then view the new student in the **Students** page to verify that you can successfully write to the database.</span></span>

<span data-ttu-id="6b3d8-261">Dos **cursos** , clique em **atualização créditos**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-261">From the **Courses** page, click **Update Credits**.</span></span> <span data-ttu-id="6b3d8-262">O **créditos de atualização** página requer permissões de administrador, portanto, o **Log In** página é exibida.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-262">The **Update Credits** page requires administrator permissions, so the **Log In** page is displayed.</span></span> <span data-ttu-id="6b3d8-263">Insira as credenciais de conta de administrador que você criou anteriormente ("admin" e "prodpwd").</span><span class="sxs-lookup"><span data-stu-id="6b3d8-263">Enter the administrator account credentials that you created earlier ("admin" and "prodpwd").</span></span> <span data-ttu-id="6b3d8-264">O **atualização créditos** página for exibida, que verifica que a conta de administrador que você criou no tutorial anterior foi implantada corretamente no ambiente de teste.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-264">The **Update Credits** page is displayed, which verifies that the administrator account that you created in the previous tutorial was correctly deployed to the test environment.</span></span>

<span data-ttu-id="6b3d8-265">Solicite uma URL inválida para causar um erro que ELMAH rastrear e, em seguida, solicitar o relatório de erros do ELMAH.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-265">Request an invalid URL to cause an error that ELMAH will track, and then request the ELMAH error report.</span></span> <span data-ttu-id="6b3d8-266">Se você estiver implantando em um provedor de hospedagem de terceiros, você provavelmente perceberá que o relatório está vazio, pelo mesmo motivo que ele estava vazio no tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-266">If you are deploying to a third-party hosting provider, you will probably find that the report is empty for the same reason that it was empty in the previous tutorial.</span></span> <span data-ttu-id="6b3d8-267">Você precisará usar as ferramentas de gerenciamento de conta do provedor de hospedagem para configurar permissões de pasta para habilitar o ELMAH gravar na pasta de log.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-267">You will have to use the hosting provider's account management tools to configure folder permissions to enable ELMAH to write to the log folder.</span></span>

<span data-ttu-id="6b3d8-268">O aplicativo que você criou agora está em execução na nuvem em um aplicativo web que é exatamente como o que você usará para a produção.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-268">The application that you created is now running in the cloud in a web app that is just like what you will use for production.</span></span> <span data-ttu-id="6b3d8-269">Uma vez que tudo está funcionando corretamente, a próxima etapa é implantar em produção.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-269">Since everything is working correctly, the next step is to deploy to production.</span></span>

## <a name="deploy-to-production"></a><span data-ttu-id="6b3d8-270">Implantar na produção</span><span class="sxs-lookup"><span data-stu-id="6b3d8-270">Deploy to production</span></span>

<span data-ttu-id="6b3d8-271">O processo para criar um aplicativo web de produção e implantação em produção é da mesma maneira que a preparação, exceto que você precisará excluir o *robots* da implantação.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-271">The process for creating a production web app and deploying to production is the same as for staging, except that you need to exclude the *robots.txt* from deployment.</span></span> <span data-ttu-id="6b3d8-272">Para fazer isso, você editará o arquivo de perfil de publicação.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-272">To do that you'll edit the publish profile file.</span></span>

### <a name="create-the-production-environment-and-the-production-publish-profile"></a><span data-ttu-id="6b3d8-273">Crie o ambiente de produção e a produção de perfil de publicação</span><span class="sxs-lookup"><span data-stu-id="6b3d8-273">Create the production environment and the production publish profile</span></span>

1. <span data-ttu-id="6b3d8-274">Crie o aplicativo web de produção e o banco de dados no Azure, seguindo o mesmo procedimento usado para a preparação.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-274">Create the production web app and database in Azure, following the same procedure that you used for staging.</span></span>

    <span data-ttu-id="6b3d8-275">Quando você cria o banco de dados, você pode optar por colocá-lo no mesmo servidor que você criou anteriormente ou criar um novo servidor.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-275">When you create the database, you can choose to put it on the same server you created earlier, or create a new server.</span></span>
2. <span data-ttu-id="6b3d8-276">Baixe o *. publishsettings* arquivo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-276">Download the *.publishsettings* file.</span></span>
3. <span data-ttu-id="6b3d8-277">Criar o perfil de publicação com a importação de produção *. publishsettings* arquivo, seguindo o mesmo procedimento usado para a preparação.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-277">Create the publish profile by importing the production *.publishsettings* file, following the same procedure that you used for staging.</span></span>

    <span data-ttu-id="6b3d8-278">Não se esqueça de configurar o script de implantação de dados sob **DefaultConnection** na **bancos de dados** seção o **configurações** guia.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-278">Don't forget to configure the data deployment script under **DefaultConnection** in the **Databases** section of the **Settings** tab.</span></span>
4. <span data-ttu-id="6b3d8-279">Renomear perfil de publicação para *produção*.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-279">Rename the publish profile to *Production*.</span></span>
5. <span data-ttu-id="6b3d8-280">Configurar uma transformação de perfil de publicação para o indicador de ambiente, seguindo o mesmo procedimento usado para o preparo...</span><span class="sxs-lookup"><span data-stu-id="6b3d8-280">Configure a publish profile transform for the environment indicator, following the same procedure that you used for staging..</span></span>

### <a name="edit-the-pubxml-file-to-exclude-robotstxt"></a><span data-ttu-id="6b3d8-281">Edite o arquivo. pubxml para excluir robots. txt</span><span class="sxs-lookup"><span data-stu-id="6b3d8-281">Edit the .pubxml file to exclude robots.txt</span></span>

<span data-ttu-id="6b3d8-282">Os arquivos são nomeados de perfil de publicação &lt;profilename&gt;*. pubxml* e estão localizados na *PublishProfiles* pasta.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-282">Publish profile files are named &lt;profilename&gt;*.pubxml* and are located in the *PublishProfiles* folder.</span></span> <span data-ttu-id="6b3d8-283">O *PublishProfiles* pasta está sob o *propriedades* pasta em um aplicativo web c# do projeto, no *meu projeto* pasta em um projeto de aplicativo da web VB ou em um de *App\_dados* pasta em um projeto de aplicativo web.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-283">The *PublishProfiles* folder is under the *Properties* folder in a C# web application project, under the *My Project* folder in a VB web application project, or under the *App\_Data* folder in a web app project.</span></span> <span data-ttu-id="6b3d8-284">Cada *. pubxml* arquivo contém as configurações que se aplicam a um perfil de publicação.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-284">Each *.pubxml* file contains settings that apply to one publish profile.</span></span> <span data-ttu-id="6b3d8-285">Os valores inseridos no Assistente de publicação na Web são armazenados nesses arquivos, e você pode editá-los para criar ou alterar as configurações que não estão disponíveis na IU do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-285">The values you enter in the Publish Web wizard are stored in these files, and you can edit them to create or change settings that aren't made available in the Visual Studio UI.</span></span>

<span data-ttu-id="6b3d8-286">Por padrão, *. pubxml* arquivos são incluídos no projeto quando você criar um perfil de publicação, mas você pode excluí-los do projeto e Visual Studio ainda irá usá-los.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-286">By default, *.pubxml* files are included in the project when you create a publish profile, but you can exclude them from the project and Visual Studio will still use them.</span></span> <span data-ttu-id="6b3d8-287">O Visual Studio procura *PublishProfiles* pasta *. pubxml* arquivos, independentemente se eles são incluídos no projeto.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-287">Visual Studio looks in the *PublishProfiles* folder for *.pubxml* files, regardless of whether they are included in the project.</span></span>

<span data-ttu-id="6b3d8-288">Para cada *. pubxml* arquivo, existe uma *. pubxml* arquivo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-288">For each *.pubxml* file there is a *.pubxml.user* file.</span></span> <span data-ttu-id="6b3d8-289">O *. pubxml* arquivo contém a senha criptografada se você tiver selecionado o **salvar senha** opção e, por padrão, ele é excluído do projeto.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-289">The *.pubxml.user* file contains the encrypted password if you selected the **Save password** option, and by default it is excluded from the project.</span></span>

<span data-ttu-id="6b3d8-290">Um *. pubxml* arquivo contém as configurações que pertencem a um perfil de publicação específica.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-290">A *.pubxml* file contains the settings that pertain to a specific publish profile.</span></span> <span data-ttu-id="6b3d8-291">Se você quiser definir as configurações que se aplicam a todos os perfis, você pode criar uma *. wpp.targets* arquivo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-291">If you want to configure settings that apply to all profiles, you can create a *.wpp.targets* file.</span></span> <span data-ttu-id="6b3d8-292">O processo de compilação importa esses arquivos para o *. csproj* ou *. vbproj* arquivo de projeto, portanto, a maioria das configurações que você pode configurar no arquivo de projeto podem ser configuradas nesses arquivos.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-292">The build process imports these files into the *.csproj* or *.vbproj* project file, so most settings that you can configure in the project file can be configured in these files.</span></span> <span data-ttu-id="6b3d8-293">Para obter mais informações sobre *. pubxml* arquivos e *. wpp.targets* arquivos, consulte [como: Editar configurações de implantação em Publicar arquivos de perfil (. pubxml) e o. arquivo wpp.targets em projetos do Visual Studio Web](https://msdn.microsoft.com/library/ff398069.aspx).</span><span class="sxs-lookup"><span data-stu-id="6b3d8-293">For more information about *.pubxml* files and *.wpp.targets* files, see [How to: Edit Deployment Settings in Publish Profile (.pubxml) Files and the .wpp.targets File in Visual Studio Web Projects](https://msdn.microsoft.com/library/ff398069.aspx).</span></span>

1. <span data-ttu-id="6b3d8-294">Na **Gerenciador de soluções**, expanda **Properties** e expanda **PublishProfiles**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-294">In **Solution Explorer**, expand **Properties** and expand **PublishProfiles**.</span></span>
2. <span data-ttu-id="6b3d8-295">Clique com botão direito *Production.pubxml* e clique em **abrir**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-295">Right-click *Production.pubxml* and click **Open**.</span></span>

    ![Abra o arquivo. pubxml](deploying-to-production/_static/image13.png)
3. <span data-ttu-id="6b3d8-297">Clique com botão direito *Production.pubxml* e clique em **abrir**.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-297">Right-click *Production.pubxml* and click **Open**.</span></span>
4. <span data-ttu-id="6b3d8-298">Adicione as seguintes linhas imediatamente antes do fechamento `PropertyGroup` elemento:</span><span class="sxs-lookup"><span data-stu-id="6b3d8-298">Add the following lines immediately before the closing `PropertyGroup` element:</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample3.xml)]

    <span data-ttu-id="6b3d8-299">O arquivo. pubxml agora se parece com o exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="6b3d8-299">The .pubxml file now looks like the following example:</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample4.xml?highlight=18-20)]

    <span data-ttu-id="6b3d8-300">Para obter mais informações sobre como excluir arquivos e pastas, consulte [pode posso excluir arquivos ou pastas específicas da implantação?](https://msdn.microsoft.com/library/ee942158.aspx#can_i_exclude_specific_files_or_folders_from_deployment) na **perguntas frequentes sobre a implantação da Web para Visual Studio e o ASP.NET** no MSDN.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-300">For more information about how to exclude files and folders, see [Can I exclude specific files or folders from deployment?](https://msdn.microsoft.com/library/ee942158.aspx#can_i_exclude_specific_files_or_folders_from_deployment) in the **Web Deployment FAQ for Visual Studio and ASP.NET** on MSDN.</span></span>

### <a name="deploy-to-production"></a><span data-ttu-id="6b3d8-301">Implantar na produção</span><span class="sxs-lookup"><span data-stu-id="6b3d8-301">Deploy to production</span></span>

1. <span data-ttu-id="6b3d8-302">Abra o **publicar na Web** Assistente para ter certeza de que o **produção** perfil de publicação está selecionado e, em seguida, clique em **iniciar visualização** no **visualização**guia para verificar se o *robots* arquivo não será copiado para o aplicativo de produção.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-302">Open the **Publish Web** wizard make sure that the **Production** publish profile is selected, and then click **Start Preview** on the **Preview** tab to verify that the *robots.txt* file will not be copied to the production app.</span></span>

    ![Visualização de arquivos a serem publicados para a produção](deploying-to-production/_static/image14.png)

    <span data-ttu-id="6b3d8-304">Examine a lista de arquivos que serão copiados.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-304">Review the list of files that will be copied.</span></span> <span data-ttu-id="6b3d8-305">Você verá que todos os *. CS* arquivos, incluindo *. aspx.cs*, *. aspx.designer.cs*, *Master.cs*, e  *Master.Designer.CS* arquivos são omitidos.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-305">You'll see that all of the *.cs* files, including *.aspx.cs*, *.aspx.designer.cs*, *Master.cs*, and *Master.designer.cs* files are omitted.</span></span> <span data-ttu-id="6b3d8-306">Todo esse código tiver sido compilado na *contosouniversity. dll* e *ContosoUniversity.pdb* arquivos que você encontrará o *bin* pasta.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-306">All of this code has been compiled into the *ContosoUniversity.dll* and *ContosoUniversity.pdb* files that you'll find in the *bin* folder.</span></span> <span data-ttu-id="6b3d8-307">Porque somente o *. dll* é necessária para executar o aplicativo e você especificou anteriormente que devem ser implantados somente os arquivos necessários para executar o aplicativo, não *CS* arquivos foram copiados para o destino ambiente.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-307">Because only the *.dll* is needed to run the application, and you specified earlier that only files needed to run the application should be deployed, no *.cs* files were copied to the destination environment.</span></span> <span data-ttu-id="6b3d8-308">O *obj* pasta e o *Contosouniversity* e *. csproj* arquivos são omitidos pelo mesmo motivo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-308">The *obj* folder and the *ContosoUniversity.csproj* and *.csproj.user* files are omitted for the same reason.</span></span>

    <span data-ttu-id="6b3d8-309">Clique em **publicar** para implantar o ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-309">Click **Publish** to deploy to the production environment.</span></span>
2. <span data-ttu-id="6b3d8-310">Teste em produção, seguindo o mesmo procedimento usado para a preparação.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-310">Test in production, following the same procedure you used for staging.</span></span>

    <span data-ttu-id="6b3d8-311">Tudo o que é idêntico de preparo, exceto para a URL e a ausência do *robots* arquivo.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-311">Everything is identical to staging except for the URL and the absence of the *robots.txt* file.</span></span>

## <a name="summary"></a><span data-ttu-id="6b3d8-312">Resumo</span><span class="sxs-lookup"><span data-stu-id="6b3d8-312">Summary</span></span>

<span data-ttu-id="6b3d8-313">Você agora com êxito implantado e testado seu aplicativo web e ele está disponível publicamente na Internet.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-313">You have now successfully deployed and tested your web app and it is available publicly over the Internet.</span></span>

![Home page produção](deploying-to-production/_static/image15.png)

<span data-ttu-id="6b3d8-315">No próximo tutorial, você atualizar o código do aplicativo e implante a alteração para os ambientes de teste, preparação e produção.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-315">In the next tutorial, you'll update application code and deploy the change to the test, staging, and production environments.</span></span>

> [!NOTE]
> <span data-ttu-id="6b3d8-316">Enquanto seu aplicativo está em uso no ambiente de produção deve implementar um plano de recuperação.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-316">While your application is in use in the production environment you should be implementing a recovery plan.</span></span> <span data-ttu-id="6b3d8-317">Ou seja, você deve ser periodicamente fazendo backup de seus bancos de dados do aplicativo de produção para um local de armazenamento seguro, e você deve manter várias gerações de tais backups.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-317">That is, you should be periodically backing up your databases from the production app to a secure storage location, and you should be keeping several generations of such backups.</span></span> <span data-ttu-id="6b3d8-318">Quando você atualiza o banco de dados, você deve fazer uma cópia de backup de imediatamente antes da alteração.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-318">When you update the database, you should make a backup copy from immediately before the change.</span></span> <span data-ttu-id="6b3d8-319">Em seguida, se você comete um erro e não Descubra até depois que você implantou em produção, você ainda poderá recuperar o banco de dados para o estado que estava antes de ele se tornou corrompido.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-319">Then, if you make a mistake and don't discover it until after you have deployed it to production, you will still be able to recover the database to the state it was in before it became corrupted.</span></span> <span data-ttu-id="6b3d8-320">Para obter mais informações, consulte [Backup de banco de dados SQL do Azure e restauração](https://msdn.microsoft.com/library/windowsazure/jj650016.aspx).</span><span class="sxs-lookup"><span data-stu-id="6b3d8-320">For more information, see [Azure SQL Database Backup and Restore](https://msdn.microsoft.com/library/windowsazure/jj650016.aspx).</span></span>
> 
> 
> [!NOTE]
> <span data-ttu-id="6b3d8-321">Neste tutorial, o SQL Server edition que você está implantando é banco de dados SQL.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-321">In this tutorial the SQL Server edition that you are deploying to is Azure SQL Database.</span></span> <span data-ttu-id="6b3d8-322">Enquanto o processo de implantação é semelhante a outras edições do SQL Server, um aplicativo de produção real pode exigir código especial para o banco de dados SQL em alguns cenários.</span><span class="sxs-lookup"><span data-stu-id="6b3d8-322">While the deployment process is similar to other editions of SQL Server, a real production application might require special code for Azure SQL Database in some scenarios.</span></span> <span data-ttu-id="6b3d8-323">Para obter mais informações, consulte [trabalhando com o banco de dados SQL](../../../../whitepapers/aspnet-data-access-content-map.md#ssdb) e [escolhendo entre o SQL Server e banco de dados SQL](../../../../whitepapers/aspnet-data-access-content-map.md#ssdbchoosing).</span><span class="sxs-lookup"><span data-stu-id="6b3d8-323">For more information, see [Working with Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdb) and [Choosing between SQL Server and Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdbchoosing).</span></span>
> 
> [!div class="step-by-step"]
> <span data-ttu-id="6b3d8-324">[Anterior](setting-folder-permissions.md)
> [Próximo](deploying-a-code-update.md)</span><span class="sxs-lookup"><span data-stu-id="6b3d8-324">[Previous](setting-folder-permissions.md)
[Next](deploying-a-code-update.md)</span></span>
